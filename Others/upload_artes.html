<!doctype html>
<html>
    <head>
      <title>Upload Artes</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      
      <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">

      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
      <link rel="stylesheet" href="css/style.css">
      <link rel="stylesheet" href="css/table.css">
        <meta name="viewport" content="width=944">
        <meta name="robots" content="noindex, follow">
	<link rel="Shortcut icon" href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/favicon.ico" type="image/x-icon">
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon.png" rel="apple-touch-icon" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144" />
        <link rel="stylesheet" href="fonts/fontawesome-all.min.css">
        <link rel="stylesheet" href="fonts/font-awesome.min.css">
        <link rel="stylesheet" href="fonts/fontawesome5-overrides.min.css">
        <script src="js/popper.js"></script>
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
          <script src="js/jscolor.js"></script>
    
        <script src="/portal.cgi/PP_FILE_STORE/Sistema/assets/js/vendor/modernizr-2.6.2.min.js"></script>
      	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-1.8.3.min.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-ui-1.9.2.custom.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.cookie.js'></script>
    	<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.4.2/chroma.min.js'></script>
    <!-- portal.js -->
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-linedtextarea.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/codemirror.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/javascript.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.tmpl.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-regex.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/sitemapstyler.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/date.format.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.iframe-transport.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.fileupload.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.notify.min.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.event.drag-2.2.js'></script>
        <script type='text/javascript' src='/portal.cgi?api=js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/portal/js/nixps-portal-api.js'></script>
        <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.i18n.js'></script>
         <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/upload/js/upload.js'></script>
      
        <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/upload/js/upload-controller.js'></script>
       
       
    <script>
		var trans = {'nixps-cloudflow-upload.button_text_browse': "Selecionar Arquivo..."};
		$.i18n.setDictionary(trans);
		

	        var ts ='';
		var lSession=api_sync.auth.create_session('admin','Oicu812!');

	        function getUrlVars() {
    		  var vars = {};
		  var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
        	    vars[key] = value;
    		  });
		  return vars;
		}

		function init() {
	          var upload = getUrlVars()['upload'];
		  if (upload=='done') $('#info_ticket').html('Upload realizado com sucesso! fazer outro upload?');
		  $('#uploadstamp').val(ts);

		  api_sync.m_session=lSession;
		 // var lData=api_sync.file.create_folder('cloudflow://PP_FILE_STORE/','entrada');

		  $( "#logout" ).on( "click", function () {
        	$.cookie('user_id','', { expires: -1, path: '/' });
        	$.cookie('user_hash','', { expires: -1, path: '/' });
        	$.cookie('expiration_date','', { expires: -1, path: '/' });
        	$.cookie('customer_id','', { expires: -1, path: '/' });
        	$.cookie('customer_name', '', { expires: -1 , path: '/' });
       		$.cookie('username', '', { expires: -1 , path: '/' });
        	$.cookie('scope', '', { expires: -1 , path: '/' });
        	window.location = '.';
    	  });
		}

		// this handler is executed when we click on the button
		$(document).ready(function() {
			var g_files = [];
			 function checkRequiredFields() {
                    var l_result = true;
                    var l_fields = ['sku', 'articleid'];

                    for(var i in l_fields) {
                        var l_name = l_fields[i];
                        var l_inputfield = $('[customer='+l_name+']');
                        var l_value = l_inputfield.val();
                    }

					if (g_files.length == 0)
					{
						$('.xeikon_file_uploader').addClass('fillin');
					}
					else
					{
						$('.xeikon_file_uploader').removeClass('fillin');
					}
                    return l_result;
                }

			var lSession=api_sync.auth.create_session('admin','Oicu812!');
			$.cookie('session',lSession.session,{ expires:2, path:'/'});

			var l_div=$(".xeikon_file_uploader");
		        ts = ''+parseInt(new Date().getTime()/1000);
			var l_uploader=upload.setup_ui(
				l_div,
				{
					url:'/?url='+encodeURIComponent("cloudflow://PP_FILE_STORE/"),
					multiple:true,
					only_upload:true,
					got_files_cb: function(p_file, p_url) { g_files.push(p_url); },
					//*  Only PDF files:
 				    check_file_cb: function (p_filename, p_size, p_type)
    					{
							var ok = (p_filename.length > 4);
						if (!ok || (p_filename.toLowerCase().substr(p_filename.length - 4) != '.zip'))
					 {
					 l_uploader.add_failed_entry(p_filename, 'Somente é possível fazer upload de arquivos no formato .zip');
					 return false;
					}
						workButonsTimeOut = setInterval(butonsTimeOut, 6000)  
				
					return true;
					}
				});
			$('#registerButton').on('click',function ()
			{
				// log into the system, and use it to set the cookie
				var lSession=api_sync.auth.create_session('admin','Oicu812!');

				api_sync.m_session=lSession;

				gInput="register";

				var lData=api_sync.ui.convert_form_to_json($('#formularioUser'));

				lData.references={
					files: g_files
					//folder_name: gfoldername
				};

                var l_values = {
                 customer:'', articleid:''
                 };
                    $('#formularioUser').find('input').each(function (p_index, p_child)
                   {
					l_values[$(p_child).attr('name')] = $(p_child).val();
                    });
                    $('#formularioUser').find('textarea').each(function (p_index, p_child)
                    {
					l_values[$(p_child).attr('name')] = $(p_child).val();
                    });

                var dados = {}
                dados["usuario"] = usuario
                dados["upload"] = new Date

				// submit the data to Cloudflow
		    var lResult=api_sync.hub.start_from_whitepaper_with_files_and_variables("BR-TECNO_upload","upload", g_files , dados);
		    console.log(lResult);
	            // Go to Done page
	//	var l_customername = $('#sku').val();
//		var l_articleid = $('#linhaProduto').val();

		var l_url = '/portal.cgi/PP_FILE_STORE/Sistema/upload_artes.html';
    console.log(l_url)
                //window.location.href = l_url;
		window.location.href = '?upload=done';
		console.log(lResult);
			});
			});
     </script>
    

    </head>


    <body>

  		<div class="wrapper d-flex align-items-stretch">
  			<nav id="sidebar">
  				<div class="p-4 pt-5">
            <img>
  		  		<img src="./logo/logo_valgroup.png" style="width: 90%; margin-bottom: 50px;">
            <ul class="active components mb-5">
                   <li  class="active" style="list-style-type: none">
                    <a href="prepress_dash_sp1.html"><img src="./Icons/global_on.png" width="30px" style="margin-right: 10px;"><span  style="color: black; font-size: 1em">Dashboard</span></a>
                    </li>
                    <li  style="list-style-type: none">
                    <a href="lista_premeet_prepress.html"><img src="./Icons/premeet.png" width="30px" style="margin-right: 10px;"><span  style="color: black; font-size: 1em">Lista Pré Meet</span></a>
                    </li>
        <li id="mostra_upload_menu" style="display: none;">
              <a href="#homeSubmenu4" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><img src="./Icons/uploadedownload.png" width="26px" style="margin-right: 10px">Servidor de Arquivos</a>
           <li  style="list-style-type: none;">
               <ul class="collapse list-unstyled" id="homeSubmenu4">
               <li  style="list-style-type: none">
               <a href="upload_artes.html"><img src="./Icons/upload.png" width="22px" style="margin-right: 10px">Upload Artes</a>
          </li> 
          <li  style="list-style-type: none">
               <a href="download_artes.html"><img src="./Icons/download.png" width="22px" style="margin-right: 10px">Download Artes</a>
          </li> 
          <li  style="list-style-type: none">
               <a href="http://35.232.192.44:9090/portal.cgi?asset=X"><img src="./Icons/assets.png" width="22px" style="margin-right: 10px">Assets</a>
          </li> 
        </ul>
        </li>
                     
                <li>
              <a href="#homeSubmenu2" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><img src="./Icons/fornecedores.png" width="30px" style="margin-right: 10px">Fornecedores</a>
           <li  style="list-style-type: none">
               <ul class="collapse list-unstyled" id="homeSubmenu2">
               <li class="active" style="list-style-type: none">
               <a href="cadastros_fornecedores_flexo_pre.html"><img src="./Icons/flexo.png" width="20px" style="margin-right: 10px">Flexo</a>
          </li>
          <li  style="list-style-type: none">
               <a href="cadastros_fornecedores_roto_pre.html"><img src="./Icons/roto.png" width="20px" style="margin-right: 10px">Roto</a>
          </li>
          <li  style="list-style-type: none">
               <a href="cadastros_fornecedores_anilox_pre.html"><img src="./Icons/anilox.png" width="20px" style="margin-right: 10px">Anilox</a>
          </li>
          <li  style="list-style-type: none">
               <a href="cadastros_fornecedores_pc_pre.html"><img src="./Icons/porta_cliche.png" width="20px" style="margin-right: 10px">Porta Clichê</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_fornecedores_prepress_pre.html"><img src="./Icons/prepress.png" width="20px" style="margin-right: 10px">Prepress</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_fornecedores_materiaprima_pre.html"><img src="./Icons/material.png" width="20px" style="margin-right: 10px">Matéria Prima</a>
          </li>
          </ul>
          
          <li >
              <a  href="#homeSubmenu3" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><img src="./Icons/tecnicos.png" width="30px" style="margin-right: 10px">Cadastros Técnicos</a>
           <li style="list-style-type: none">
               <ul class="collapse list-unstyled" id="homeSubmenu3">
              
          <li  style="list-style-type: none">
               <a href="cadastros_tecnicos_unidades_pre.html"><img src="./Icons/unidades.png" width="20px" style="margin-right: 10px">Unidades</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_tipotrabalho_pre.html"><img src="./Icons/tipo_trabalho.png" width="20px" style="margin-right: 10px">Tipo de Trabalho</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_finalidade_pre.html"><img src="./Icons/finalidade.png" width="20px" style="margin-right: 10px">Finalidade</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_segmentos_pre.html"><img src="./Icons/segmentos.png" width="20px" style="margin-right: 10px">Segmentos</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_testform_pre.html"><img src="./Icons/testform.png" width="20px" style="margin-right: 10px">Test Form</a>
          </li>
          </ul>
          
              
                <li>
              <a href="#homeSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><img src="./Icons/sequencia.png" width="30px" style="margin-right: 10px">Sequência Padrão</a>
              <ul class="collapse list-unstyled" id="homeSubmenu">
              <li  style="list-style-type: none">
               <a href="receita_tintas_pre.html"><img src="./Icons/contagotas.png" width="20px" style="margin-right: 10px">Criar Sequência</a>
              </li>
              <li  style="list-style-type: none">
               <a href="lista_receitas_pre.html"><img src="./Icons/listasequencia.png" width="20px" style="margin-right: 10px">Lista Sequências</a>
              </li>
              <li style="list-style-type: none">
               <a href="cadastros_tintas_pre.html"><img src="./Icons/novasequencia.png" width="20px" style="margin-right: 10px">Lista de Cores</a>
              </li>
              </ul>
          </li>
              </ul>    
                    
       
   
  	        <div class="footer">
  	        	<p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0.
  						  Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib.com</a>
  						   Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
  	        </div>
  	      </div>
      	</nav>

          <!-- Page Content  -->
        <div id="content" class="p-4 p-md-5">

          <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">

              <button type="button" id="sidebarCollapse" class="btn btn-primary">
                <i class="fa fa-bars"></i>
                <span class="sr-only">Toggle Menu</span>
              </button>
              <button class="btn btn-dark d-inline-block d-lg-none ml-auto" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <i class="fa fa-bars"></i>
              </button>
              <div id="bemvindo" style="margin-left: 20px;"></div>

              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav ml-auto">
                 
                  <li class="nav-item">
                      <a class="nav-link" href="alterar_senha.html" target="_Blank">Alterar Senha</a>
                  </li>
                   <li class="nav-item">
                      <div class="nav-link" onclick="logout()" style="cursor: pointer">Logout</div>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
      
          
        <h2 style="display:inline-block;">Upload Artes SP1</h2>
        <br>
        <hr>
        <h6 style="display: inline-block;">Carregar um ou mais arquivos no formato ZIP com o nome da pasta que deseja subir. <br>Apenas enviar <strong style="color: red;">1 arquivo ZIP</strong> por arte!</strong></h6><br>
        <br>
        <br>
         
                 
                 
               
                 
                   
                  <div id="info_ticket" style="color: green"></div>
                   
                    <div class="form-group col-md-11">
                    <div class="xeikon_file_uploader" style="position: relative; width:100%; height:800px; border-width:1px; border-radius:5px; border-style:solid; border-color:#e5e5e5;">
                    </div>
                    <button class="btn btn-primary registerButton clearfix" id='registerButton' style=" display: none;" >Fazer o Upload</button>
                </div>
                
              
                
                 
                 
       
            
             
            
            
            <!-- terminar mostra locais e começa mostra registro -->
            
          
          
           
                <br>
               
              
        
        
       
  	</div>
  		
  	
  	<script>
  	    // funcoes de apoio
  	    
  	    var usuario = api.auth.get_current_user()
  	    
  	    document.getElementById("bemvindo").innerText = "Bem vindo, "+usuario.fullname
  	 //   document.getElementById("data_entrega").value = "02:00"
  	    
  	 
 
 if (usuario.scope_name != undefined){
    var nome_scope = usuario.scope_name[0].split("_")
   
}


if (usuario.active_scope_name == "prepress_sp1"){
    document.getElementById("mostra_upload_menu").style.display = "block"
    

}
      function clearTable(table) {
  var rows = table.rows;
  var i = rows.length;
  while (--i) {
    rows[i].parentNode.removeChild(rows[i]);
    // or
    // table.deleteRow(i);
  }
}

function onlyUnique(value, index, self) {
  return self.indexOf(value) === index;
}

function cmyk2rgb(c, m, y, k, normalized){
    c = (c / 100);
    m = (m / 100);
    y = (y / 100);
    k = (k / 100);
    
    c = c * (1 - k) + k;
    m = m * (1 - k) + k;
    y = y * (1 - k) + k;
    
    var r = 1 - c;
    var g = 1 - m;
    var b = 1 - y;
    
    if(!normalized){
        r = Math.round(255 * r);
        g = Math.round(255 * g);
        b = Math.round(255 * b);
    }
    
    return {
        r: r,
        g: g,
        b: b
    }
}

function rgb2cmyk(r, g, b, normalized){
    var c = 1 - (r / 255);
    var m = 1 - (g / 255);
    var y = 1 - (b / 255);
    var k = Math.min(c, Math.min(m, y));
    
    c = (c - k) / (1 - k);
    m = (m - k) / (1 - k);
    y = (y - k) / (1 - k);
    
    if(!normalized){
        c = Math.round(c * 10000) / 100;
        m = Math.round(m * 10000) / 100;
        y = Math.round(y * 10000) / 100;
        k = Math.round(k * 10000) / 100;
    }
    
    c = isNaN(c) ? 0 : c;
    m = isNaN(m) ? 0 : m;
    y = isNaN(y) ? 0 : y;
    k = isNaN(k) ? 0 : k;
    
    return {
        c: c,
        m: m,
        y: y,
        k: k
    }
}


function componentToHex(c) {
  var hex = c.toString(16);
  return hex.length == 1 ? "0" + hex : hex;
}

function rgbToHex(r, g, b) {
  return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
}

// preenche dados se existe ordem

if (usuario.scope_name != undefined){
    var nome_scope = usuario.scope_name[0].split("_")
   
}
var planta = "sp1"



// preenche Selects
var tiposTipo = []
selectTipo = document.getElementById('nome_pasta');
  //  var tiposTipo = api.custom_objects.list_with_options("BR-VALFI_TipoTrabalho",[],["tipo","ascending"]).results
    for (var i = 0; i<tiposTipo.length; i++){
        var opt = document.createElement('option');
        opt.value = tiposTipo[i].tipo;
        opt.innerHTML = tiposTipo[i].tipo;
        selectTipo.appendChild(opt);
    }
    
 
    
   
    
    // preenche Datalist
    
    
           
 
var hoje = new Date()

  	</script>
  
   <script>
  	var n_butonsTimeOut = 0;
var workButonsTimeOut
var butonsTimeOut = function ()
{   n_butonsTimeOut++;
    buttonsControls()
    console.log("Opa olha eu aqui ..."+n_butonsTimeOut)
    if (n_butonsTimeOut>300)
    {   //workButonsTimeOut = setTimeout(butonsTimeOut, 5000); // Roda apenas 1x
      clearInterval(workButonsTimeOut)
      //workButonsTimeOut = setInterval(butonsTimeOut, 6000)
    }
}

function buttonsControls(st)
    {  if (st != undefined) 
        { 
        }
        else {st=""}
        success = document.getElementsByClassName("success")
        statuses = document.getElementsByClassName("status")
        console.log(success.length)
        console.log(statuses.length)
        botaoenv = document.getElementById("registerButton")
        botaoup = document.getElementsByClassName("upload_button")
        if ((success.length>0) && (statuses.length>=0))
        { 
            console.log("estou no sucesso")
            if(success[0].innerText.indexOf("Completed")>=0)
          { 
            console.log("vou mudar os botões")  
            botaoenv.style.display = "inline-block"
            botaoup[0].style.display = "inline-block"
          }      
        }   
        if ((success.length<=1) && (statuses.length<0))
        { 
            botaoenv.style.display = "none"
            botaoup[0].style.display = "inline-block"
            botaoup[0].style.background = "none"  
        } 
    }
  
  	
 </script> 	
  






    </body>

</html>