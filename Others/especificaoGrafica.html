<!doctype html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Especificação Gráfica - Prepress Zaraplast</title>
        <meta name="description" content="Versioning">
        <meta name="viewport" content="width=944">
        <meta name="robots" content="noindex, follow">
	<link rel="Shortcut icon" href="http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/assets/img/icons/favicon.ico" type="image/x-icon">
        <link href="http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/assets/img/icons/apple-touch-icon.png" rel="apple-touch-icon" />
        <link href="http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/assets/img/icons/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" />
        <link href="http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/assets/img/icons/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72" />
        <link href="http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/assets/img/icons/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114" />
        <link href="http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/assets/img/icons/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144" />
        <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/table.css">
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/popper.js"></script>
        <script src="js/main.js"></script>

        <script src="http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/assets/js/vendor/modernizr-2.6.2.min.js"></script>
      	<script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery-1.8.3.min.js'></script>
    	<script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery-ui-1.9.2.custom.js'></script>
    	<script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery.cookie.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery.appear-1.1.1.min.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery-linedtextarea.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/codemirror.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/javascript.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery.tmpl.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery-regex.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/sitemapstyler.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/date.format.js'></script>
    <!-- portal.js -->  <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery.iframe-transport.js'></script>
    <!-- portal.js -->  <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery.fileupload.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery.notify.min.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery.event.drag-2.2.js'></script>
        <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi?api=js'></script>
    	<script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/portal/js/nixps-portal-api.js'></script>
        <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/upload/js/upload.js'></script>
      
        <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery.i18n.js'></script>
        <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/upload/js/upload-controller.js'></script>
    <script>
		var trans = {'nixps-cloudflow-upload.button_text_browse': "Selecionar Arquivo..."};
		$.i18n.setDictionary(trans);
		$.get("/cloudflow_pt.json").then(function(pTranslations) {
                  $.i18n.setDictionary(pTranslations);
                }).fail(function(pError){
                  console.log(pError);
                });

	        var ts ='';
		var lSession=api_sync.auth.create_session('admin','Oicu812!');

	        function getUrlVars() {
    		  var vars = {};
		  var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
        	    vars[key] = value;
    		  });
		  return vars;
		}

		function init() {
	          var upload = getUrlVars()['upload'];
		  if (upload=='done') $('#message').html('File uploaded! Deliver a new file...');
		  $('#uploadstamp').val(ts);

		  api_sync.m_session=lSession;
		  var lData=api_sync.file.create_folder('cloudflow://PP_FILE_STORE/','entrada');

		  $( "#logout" ).on( "click", function () {
        	$.cookie('user_id','', { expires: -1, path: '/' });
        	$.cookie('user_hash','', { expires: -1, path: '/' });
        	$.cookie('expiration_date','', { expires: -1, path: '/' });
        	$.cookie('customer_id','', { expires: -1, path: '/' });
        	$.cookie('customer_name', '', { expires: -1 , path: '/' });
       		$.cookie('username', '', { expires: -1 , path: '/' });
        	$.cookie('scope', '', { expires: -1 , path: '/' });
        	window.location = '.';
    	  });
		}

		// this handler is executed when we click on the button
		$(document).ready(function() {
			var g_files = [];
			 function checkRequiredFields() {
                    var l_result = true;
                    var l_fields = ['sku', 'articleid'];

                    for(var i in l_fields) {
                        var l_name = l_fields[i];
                        var l_inputfield = $('[customer='+l_name+']');
                        var l_value = l_inputfield.val();
                    }

					if (g_files.length == 0)
					{
						$('.xeikon_file_uploader').addClass('fillin');
					}
					else
					{
						$('.xeikon_file_uploader').removeClass('fillin');
					}
                    return l_result;
                }

			var lSession=api_sync.auth.create_session('admin','Oicu812!');
			$.cookie('session',lSession.session,{ expires:2, path:'/'});

			var l_div=$(".xeikon_file_uploader");
		        ts = ''+parseInt(new Date().getTime()/1000);
			var l_uploader=upload.setup_ui(
				l_div,
				{
					url:'/?url='+encodeURIComponent("cloudflow://PP_FILE_STORE/"),
					multiple:false,
					only_upload:true,
					got_files_cb: function(p_file, p_url) { g_files.push(p_url); },
					//*  Only PDF files:
 				    check_file_cb: function (p_filename, p_size, p_type)
    					{
							var ok = (p_filename.length > 4);
						if (!ok || (p_filename.toLowerCase().substr(p_filename.length - 4) == '.cdr'))
					 {
					 l_uploader.add_failed_entry(p_filename, 'Não é possível executar arquivos de Corel');
					 return false;
					}
					return true;
					}
				});
			$('#registerButton').on('click',function ()
			{
				// log into the system, and use it to set the cookie
				var lSession=api_sync.auth.create_session('admin','Oicu812!');

				api_sync.m_session=lSession;

				gInput="register";

				var lData=api_sync.ui.convert_form_to_json($('#formularioUser'));

				lData.references={
					files: g_files
					//folder_name: gfoldername
				};

                var l_values = {
                 customer:'', articleid:''
                 };
                    $('#formularioUser').find('input').each(function (p_index, p_child)
                   {
					l_values[$(p_child).attr('name')] = $(p_child).val();
                    });
                    $('#formularioUser').find('textarea').each(function (p_index, p_child)
                    {
					l_values[$(p_child).attr('name')] = $(p_child).val();
                    });


				// submit the data to Cloudflow
		    var lResult=api_sync.hub.start_from_whitepaper_with_files_and_variables("BR-ZARAP_workflow","especifica", g_files , lData.variables);
		    console.log(lResult);
	            // Go to Done page
		var l_customername = $('#sku').val();
		var l_articleid = $('#linhaProduto').val();

		var l_url = 'http://127.0.0.1:9090/portal.cgi?quantum=' + lResult._id + '&workable=' + lResult._id;
                //window.location.href = l_url;
		window.location.href = '?upload=done';
		console.log(lResult);
			});
			});
     </script>

    </head>


    <body>


      <div class="wrapper d-flex align-items-stretch">
  			<nav id="sidebar">
  				<div class="p-4 pt-5">
            <img>
  		  		<img src="./logo/zaraplast.jpg" style="width: 70%; margin-bottom: 50px;">
                <ul class="active components mb-5">
                <li>
                  <a href="especificacoTecnica.html">Nova Especificação</a>
                </li>
              <li>
                  <a href="listaEspecificacoes.html">Lista Especificações</a>
                </li>
            <li>
  	            <a href="#homeSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Paginas Administrativas</a>
  	            <ul class="collapse list-unstyled" id="homeSubmenu">
                  <li>
                      <a href="adminPage.html">Criar Usuarios</a>
                  </li>
                  <li>
                      <a href="#">Gerenciar Especificações</a>
                  </li>
  	            </ul>
  	          </li>
  	        </ul>
  	        

  	        <div class="footer">
  	        	<p style="font-size: 6pt; margin-top:380px">Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0.
  						  Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib.com</a>
  						  Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
  	        </div>

  	      </div>
      	</nav>

          <!-- Page Content  -->
        <div id="content" class="p-4 p-md-5">

          <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">

              <button type="button" id="sidebarCollapse" class="btn btn-primary">
                <i class="fa fa-bars"></i>
                <span class="sr-only">Toggle Menu</span>
              </button>
              <button class="btn btn-dark d-inline-block d-lg-none ml-auto" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <i class="fa fa-bars"></i>
              </button>
              <div class="col-md-5" id="bemvindo"></div>

              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav ml-auto">
                    <li class="nav-item">
                      <a class="nav-link" href="especificacaoTecnica.html">Nova Especificação</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="listaEspecificacoes.html">Lista Especificações</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="adminPage.html">Criar Usuarios</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
        <h2>Nova Especificação Técnica</h2>
        <form id="formularioUser">
            <div class="form-group col-md-2" style="display:inline-block;">
                <label for="tipoArte">Tipo de Arte</label>
                <select class="form-control" id="tipoArte" name="tipoArte">
                    <option value="novo">Novo</option>
                    <option value="alteracaoSimples">Alteração Simples</option>
                    <option value="alteracaoComplexa">Alteração Complexa</option>
                    <option value="amostra">Amostra</option>
                    </select>
             </div>
            <div class="form-group col-md-2" style="display:inline-block;">
                <label for="local">Planta</label>
                <select class="form-control" id="local" name="local">
                    <option value="Laminados">Laminados</option>
                    <option value="Matriz">Matriz</option>
                    <option value="Anhanguera">Anhanguera</option>
                    </select>
             </div>
             <div class="form-group col-md-2" style="display:inline-block;">
                <label for="tipoEntrega">Tipo Entrega</label>
                <select class="form-control" id="tipoEntrega" name="tipoEntrega">
                    <option value="Bobina">Bobina</option>
                    <option value="Pouch">Saco/Pouch</option>
                    </select>
             </div>
             <div class="form-group col-md-2" style="display:inline-block;">
            <label for="data">Emitido em</label>
            <input type="text" class="form-control" id="data" name="data" readonly>
            </div>
              <div class="form-group col-md-5" style="display:inline-block;">
                <label for="nomeCliente">Cliente</label>
                <input type="text" class="form-control" id="nomeCliente" name="nomeCliente">
              </div>
              <div class="form-group col-md-2" style="display:inline-block;">
                <label for="codCliente">Código Cliente</label>
                <input type="text" class="form-control" id="codCliente" name="codCliente">
              </div>
              <div class="form-group col-md-2" style="display:inline-block;">
                <label for="codPA">Cod. P.A.</label>
                <input type="text" class="form-control" id="codPA" name="codPA">
              </div>
              <div class="form-group col-md-5" style="display:inline-block;">
                <label for="produto">Produto</label>
                <input type="text" class="form-control" id="produto" name="produto">
              </div>
              <div class="form-group col-md-3" style="display:inline-block;">
                <label for="antigo">Antigo</label>
                <input type="text" class="form-control" id="antigo" name="antigo">
              </div>
              <div class="form-group col-md-3" style="display:inline-block;">
                <label for="pedido">Pedido</label>
                <input type="text" class="form-control" id="pedido" name="pedido">
              </div>
              <div class="form-group col-md-2" style="display:inline-block;">
                <label for="cilindro">Cilindro</label>
                <input type="number" class="form-control" id="cilindro" name="cilindro" step="0.01">
              </div>
              <div class="form-group col-md-2" style="display:inline-block;">
                <label for="passo">Passo</label>
                <input type="number" class="form-control" id="passo" name="passo" step="0.01">
              </div>
              <div class="form-group col-md-2" style="display:inline-block;">
                <label for="repeticao">Repetição</label>
                <input type="number" class="form-control" id="repeticao" name="repeticao">
              </div>
              <div class="form-group col-md-2" style="display:inline-block;">
                <label for="passoCompensado">Passo Compensado</label>
                <input type="number" class="form-control" id="passoCompensado" name="passoCompensado">
              </div>
              <div class="form-group col-md-2" style="display:inline-block;">
                <label for="ladoFotocelula">Lado Fotocélula</label>
                <select class="form-control" id="ladoFotocelula" name="ladoFotocelula">
                    <option value="esquerdo">Esquerdo</option>
                    <option value="direito">Direito</option>
                    </select>
             </div>
             <div class="form-group col-md-4" style="display:inline-block;">
                 <fieldset>
                    <legend style="font-size: 1em;">Tamanho Fotocélula</legend>
                    <label for="larguraFotocelula">Largura</label>
                    <input type="number" class="form-control col-md-4" id="larguraFotocelula" name="larguraFotocelula" style="display: inline-block;" />
                    <label for="alturaFotocelula">Altura</label>
                    <input type="number" class="form-control col-md-4" id="alturaFotocelula" name="alturaFotocelula" style="display: inline-block;" />
                </fieldset>
                 </div>
                <div class="form-group col-md-3" style="display:inline-block;">
                <label for="larguraFaixa">Largura Faixa</label>
                <input type="text" class="form-control" id="larguraFaixa" name="larguraFaixa">
              </div>
              <div class="form-group col-md-2" style="display:inline-block;">
                <label for="ladoImpressao">Lado Impressão</label>
                <select class="form-control" id="ladoImpressao" name="ladoImpressao">
                    <option value="interno">Interno</option>
                    <option value="externo">Externo</option>
                    </select>
             </div>
             <div class="form-group col-md-2" style="display:inline-block;">
                <label for="aplicarLogo">Logo</label>
                <select class="form-control" id="aplicarLogo" name="aplicarLogo">
                    <option value="zara">Zara</option>
                    <option value="zarames">Zara/Mes</option>
                    <option value="semlogo">Sem Logo</option>
                    <option value="codigo">Código</option>
                    </select>
             </div>
             <div class="form-group col-md-2" id="ocodigo" style="display:none;">
                <label for="codigo">Incluir Código</label>
                <input type="text" class="form-control" id="codigo" name="codigo">
              </div><br><br>
              
              <h2>Lista de Separações</h2>
                      <input class="form-group col-md-7" type="text" id="insereCor" name="insereCor" onfocusout="adiciona_Cor()" placeholder="Digite o nome da Cor" list="as_Cores">
                      <datalist id="as_Cores">
                      </datalist>
                      <hr style="border-width: 1px;">
                      <table id="ListaCores">
                        <tr>
                          <td style="width: 250px;text-align: center;">Cor</td>
                          <td style="width: 150px;text-align: center;">Tipo Impressao</td>
                          <td style="width: 220px;text-align: center;">Curva</td>
                          <td style="width: 120px;text-align: center;">Lineatura</td>
                          <td style="width: 50px;text-align: center;">Angulo</td>
                          <td style="width: 300px;text-align: center;">Observação</td>
                          <td style="width: 85px; text-align: center;">ALT.</td>
                          <td style="width: 85px; text-align: center;">Fotocel</td>
                          <td style="width: 85px; text-align: center;">Cameron</td>
                          <td style="width: 65px;text-align: center;">Sequencia.</td>
                        </tr>
                      </table>
                      <div id="thecolors">

              </div>
              <hr style="border-width: 1px;"><br><br>
              <h2>Especificação Zaraplast</h2>
                <div class="form-group col-md-2" style="display:inline-block;">
                <label for="codSubstrato">Código Substrato</label>
                <input type="text" class="form-control" id="codSubstrato" name="corSubstrato">
              </div>
              <div class="form-group col-md-3" style="display:inline-block;">
                <label for="descSubstrato">Descrição Substrato</label>
                <input type="text" class="form-control" id="descSubstrato" name="descSubstrato">
              </div>
              <div class="form-group col-md-2" style="display:inline-block;">
                <label for="gramSubstrato">Gramatura</label>
                <input type="text" class="form-control" id="gramSubstrato" name="gramSubstrato">
              </div>
              <div class="form-group col-md-2" style="display:inline-block;">
                <label for="largSubstrato">Largura</label>
                <input type="text" class="form-control" id="largSubstrato" name="largSubstrato">
              </div>
              <div class="form-group col-md-2" style="display:inline-block;">
                <label for="ladoLaminacao">Lado Laminação</label>
                <input type="text" class="form-control" id="ladoLaminacao" name="ladoLaminacao">
              </div>
          <div class="form-group col-md-2" style="display:inline-block;">
              <div class="form-group col-md-11" style="display:inline-block;">
                <label for="embobinamento">Bobinamento Final</label>
                <select class="form-control" id="embobinamento" onchange="trocaImagem()" name="embobinamento">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                    </select>
             </div>
             <div class="form-group col-md-11" style="display:inline-block;">
             <img id="imagembobina" src="./assets/img/winding_1.jpg" width="100%">
             </div>
              </div>
              <div class="form-group col-md-3" style="display:inline-block;">
                <label for="tipoAprovacaoCores">Tipo Aprovação de Cores</label>
                <select class="form-control" id="tipoAprovacaoCores"  name="tipoAprovacaoCores" style="height: 170px;" multiple>
                    <option value="digitalProvaExterna">Prova Digital Externa</option>
                    <option value="digitalProvaInterna">Prova Digital Interna</option>
                    <option value="gmsExterna">GMS Externa</option>
                    <option value="gmsInterna">GMS Interna</option>
                    <option value="cilindroTeste">Cilindro Teste</option>
                    <option value="provaConferencia">Prova Conferência</option>
                    </select>
             </div>
             <div class="form-group col-md-11" style="display:block;">
                 <div class="form-group col-md-11" style="display:inline-block;">
                <label for="observacoesGerais">Observacoes</label>
                <textarea form="formularioUser" class="form-control" id="observacoesGerais" name="observacoesGerais" rows="5" cols="8"></textarea>
              </div>
                 </div>
                        <br><br>
                        
                <div class="form-group col-md-2" style="display: inline-block; width: 160px;">
                    <div class="form-group col-md-11" style="display: inline-block; background-color: #CCC; text-align:center; margin-bottom: 0px;">
                        ARTE
                    </div>
                    <div class="form-group col-md-11" id="horaArte" style="display: inline-block; background-color: #EEE; text-align:center;">
                    </div>
                    </div>
                 <div class="form-group col-md-2" style="display: inline-block;width: 160px;">
                    <div class="form-group col-md-11" style="display: inline-block; background-color: #b3d0ff; text-align:center; margin-bottom: 0px;">
                        RETOQUE
                    </div>
                    <div class="form-group col-md-11" id="horaRetoque" style="display: inline-block; background-color: #d9e7ff; text-align:center;">
                    </div>
                    </div>  
                    <div class="form-group col-md-2" style="display: inline-block;width: 160px;">
                    <div class="form-group col-md-11" style="display: inline-block; background-color: #CCC; text-align:center; margin-bottom: 0px;">
                        PREPARAÇÃO
                    </div>
                    <div class="form-group col-md-11" id="horaPrepara" style="display: inline-block; background-color: #EEE; text-align:center;">
                    </div>
                    </div> 
                    
                    <div class="form-group col-md-2" style="display: inline-block;width: 160px;">
                    <div class="form-group col-md-11" style="display: inline-block; background-color: #b3d0ff; text-align:center; margin-bottom: 0px;">
                        ROLAND
                    </div>
                    <div class="form-group col-md-11" id="horaRoland" style="display: inline-block; background-color: #d9e7ff; text-align:center;">
                    </div>
                    </div> 
                    
                    <div class="form-group col-md-2" style="display: inline-block;width: 160px;">
                    <div class="form-group col-md-11" style="display: inline-block; background-color: #CCC; text-align:center; margin-bottom: 0px;">
                        REV. SMART
                    </div>
                    <div class="form-group col-md-11" id="horaSmart" style="display: inline-block; background-color: #EEE; text-align:center;">
                    </div>
                    </div> 
                    
                    <div class="form-group col-md-2" style="display: inline-block;width: 160px;">
                    <div class="form-group col-md-11" style="display: inline-block; background-color: #b3d0ff; text-align:center; margin-bottom: 0px;">
                        VER.DIG.FINAL
                    </div>
                    <div class="form-group col-md-11" id="horaFinal" style="display: inline-block; background-color: #d9e7ff; text-align:center;">
                    </div>
                    </div> 
                    <div style="display:none;">
                    <label for="totalCores">Total Cores</label>
                    <input type="text" id="totalCores" name="totalCores" readonly>
                </div>
                
                    </form>
                    <div class="form-group col-md-11">
                    <div class="xeikon_file_uploader" style="position: relative; width:100%; height:200px; border-width:1px; border-radius:5px; border-style:solid; border-color:#e5e5e5;">
                    </div>
                    <button class="button registerButton clearfix" id='registerButton' >Enviar Arquivo</button>
                </div>
                
                    
                 
                </div>
                </div>


        <div style="clear:both"></div>
     <script>
    var hoje = new Date();
    var infoHoje = hoje.toLocaleDateString()+" - "+hoje.toLocaleTimeString()
    document.getElementById("data").value = infoHoje;
    </script>
    <script>
        var as_cores = api.custom_objects.list("PantoneColor_v2").results;
        var options=''; // variable to store the options
        for(var i = 0; i < as_cores.length; i++){
            
        options += '<option value="'+as_cores[i].nome+'" />';

        }
         document.getElementById('as_Cores').innerHTML = options;
    </script>
    <script>
    function adiciona_Cor(){

        var selecionada = document.getElementById('insereCor').value;
        console.log(selecionada)
        if (selecionada !== "CMYK"){
        console.log("Não sou CMYK")
        var qualPantone = api.custom_objects.list_with_options("PantoneColor_v2",["nome","equal to",selecionada],[],[]).results[0];
        var pintarCirculo = qualPantone.cor;
        var table = document.getElementById("ListaCores");
        
         var qtasrow = table.rows.length
        var row =  table.insertRow(qtasrow);
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);
        var cell5 = row.insertCell(4);
        var cell6 = row.insertCell(5);
        var cell7 = row.insertCell(6);
        var cell8 = row.insertCell(7);
        var cell9 = row.insertCell(8);
        var cell10 = row.insertCell(9);
        
        cell1.innerHTML = '<span style="height:20px;width:20px;background-color:'+pintarCirculo+';display:inline-block"></span><input type="text" class="form-group col-md-11" id="separacao'+table.rows.length+'" name="separacao'+table.rows.length+'" value="'+qualPantone.nome+'" readonly>'
        cell2.innerHTML = '<select class="form-group col-md-11" id="tipoImpressao'+table.rows.length+'" name="tipoImpressao'+table.rows.length+'"><option>Chapado</option><option>Reticula</option><option>Chapado/Reticula</option></select>'
        cell3.innerHTML = '<input type="text" class="form-group col-md-11" onfocusout="preencheCurvas()" id="curva'+table.rows.length+'" name="curva'+table.rows.length+'" placeholder="nome da curva">'
        cell4.innerHTML = '<input type="text" class="form-group col-md-11" onfocusout="preencheLineatura()" id="lineatura'+table.rows.length+'" name="lineatura'+table.rows.length+'" placeholder="000 lpi">'
        cell5.innerHTML = '<input type="text" class="form-group col-md-11" id="angulo'+table.rows.length+'" name="angulo'+table.rows.length+'" placeholder="0">'
        cell6.innerHTML = '<input type="text" class="form-group col-md-11" id="obaservacao'+table.rows.length+'" name="observacao'+table.rows.length+'" placeholder="observação">'
        cell7.innerHTML = '<select class="form-group col-md-11"" id="altera'+table.rows.length+'" name="altera'+table.rows.length+'"><option>Não</option><option>Sim</option></select>'
        cell8.innerHTML = '<select class="form-group col-md-11" id="fotocelula'+table.rows.length+'" name="fotocelula'+table.rows.length+'"><option>Não</option><option>Sim</option></select>'
        cell9.innerHTML = '<select class="form-group col-md-11" id="cameron'+table.rows.length+'" name="cameron'+table.rows.length+'"><option>Não</option><option>Sim</option></select>'
        cell10.innerHTML = '<select class="form-group col-md-11" id="sequencia'+table.rows.length+'" name="sequencia'+table.rows.length+'"><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option></select>'
        
}
    if (selecionada == "CMYK"){
        console.log("Sou CMYK")
        var colorsCMYK = []
        colorsCMYK.push("Cyan")
         colorsCMYK.push("Magenta")
          colorsCMYK.push("Yellow")
           colorsCMYK.push("Black")
        for (i=0;i<colorsCMYK.length;i++){
            console.log("Criando "+colorsCMYK[i])
            var acorCMYK = colorsCMYK[i]
        var qualPantone = api.custom_objects.list_with_options("PantoneColor_v2",["nome","equal to",acorCMYK],[],[]).results[0];
        var pintarCirculo = qualPantone.cor;
        var table = document.getElementById("ListaCores");
        
         var qtasrow = table.rows.length
        var row =  table.insertRow(qtasrow);
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);
        var cell5 = row.insertCell(4);
        var cell6 = row.insertCell(5);
        var cell7 = row.insertCell(6);
        var cell8 = row.insertCell(7);
        var cell9 = row.insertCell(8);
        var cell10 = row.insertCell(9);
        
        cell1.innerHTML = '<span style="height:20px;width:20px;background-color:'+pintarCirculo+';display:inline-block"></span><input type="text" class="form-group col-md-11" id="separacao'+table.rows.length+'" name="separacao'+table.rows.length+'" value="'+qualPantone.nome+'" readonly>'
        cell2.innerHTML = '<select class="form-group col-md-11" id="tipoImpressao'+table.rows.length+'" name="tipoImpressao'+table.rows.length+'"><option>Chapado</option><option>Reticula</option><option>Chapado/Reticula</option></select>'
        cell3.innerHTML = '<input type="text" class="form-group col-md-11" onfocusout="preencheCurvas()" id="curva'+table.rows.length+'" name="curva'+table.rows.length+'" placeholder="nome da curva">'
        cell4.innerHTML = '<input type="text" class="form-group col-md-11" onfocusout="preencheLineatura()" id="lineatura'+table.rows.length+'" name="lineatura'+table.rows.length+'" placeholder="000 lpi">'
        cell5.innerHTML = '<input type="text" class="form-group col-md-11" id="angulo'+table.rows.length+'" name="angulo'+table.rows.length+'" placeholder="0">'
        cell6.innerHTML = '<input type="text" class="form-group col-md-11" id="obaservacao'+table.rows.length+'" name="observacao'+table.rows.length+'" placeholder="observação">'
        cell7.innerHTML = '<select class="form-group col-md-11"" id="altera'+table.rows.length+'" name="altera'+table.rows.length+'"><option>Não</option><option>Sim</option></select>'
        cell8.innerHTML = '<select class="form-group col-md-11" id="fotocelula'+table.rows.length+'" name="fotocelula'+table.rows.length+'"><option>Não</option><option>Sim</option></select>'
        cell9.innerHTML = '<select class="form-group col-md-11" id="cameron'+table.rows.length+'" name="cameron'+table.rows.length+'"><option>Não</option><option>Sim</option></select>'
        cell10.innerHTML = '<select class="form-group col-md-11" id="sequencia'+table.rows.length+'" name="sequencia'+table.rows.length+'"><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option></select>'
        }
    }
    
    var table2 = document.getElementById("ListaCores");
    var totalCores = table2.rows.length-1
    var adicionaTotal = document.getElementById("totalCores")
    adicionaTotal.value = totalCores
}
   

</script>
<script>
    function trocaImagem(){
       var imagem = document.getElementById("imagembobina")
       var valor = document.getElementById("embobinamento")
       var imagemdaBobina = "http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Zaraplast/assets/img/winding_"+valor.value+".jpg"
       imagem.src = imagemdaBobina
    }
</script>

<script> 
    
    function addWorkDays(startDate, days) {
    if(isNaN(days)) {
        console.log("Value provided for \"days\" was not a number");
        return
    }
    if(!(startDate instanceof Date)) {
        console.log("Value provided for \"startDate\" was not a Date object");
        return
    }
    // Get the day of the week as a number (0 = Sunday, 1 = Monday, .... 6 = Saturday)
    var dow = startDate.getDay();
    var daysToAdd = parseInt(days);
    // If the current day is Sunday add one day
    if (dow == 0)
        daysToAdd++;
    // If the start date plus the additional days falls on or after the closest Saturday calculate weekends
    if (dow + daysToAdd >= 6) {
        //Subtract days in current working week from work days
        var remainingWorkDays = daysToAdd - (5 - dow);
        //Add current working week's weekend
        daysToAdd += 2;
        if (remainingWorkDays > 5) {
            //Add two days for each working week by calculating how many weeks are included
            daysToAdd += 2 * Math.floor(remainingWorkDays / 5);
            //Exclude final weekend if remainingWorkDays resolves to an exact number of weeks
            if (remainingWorkDays % 5 == 0)
                daysToAdd -= 2;
        }
    }
    startDate.setDate(startDate.getDate() + daysToAdd);
    return startDate;
}

console.log(hoje)
var dataArte = document.getElementById("horaArte")
var ano = hoje.getFullYear()
var mes = hoje.getMonth()+1
var dia = hoje.getDay()

var ETD_Arte = addWorkDays(hoje,2)

console.log("Data da Arte "+ETD_Arte)

var dia = ETD_Arte.getDate()
var mes = ETD_Arte.getMonth()+1
var ano = ETD_Arte.getFullYear()

if (dia < 10){
    dia = "0"+dia
}
if (mes < 10){
    mes = "0"+mes
}

var dataOK = dia+"/"+mes+"/"+ano

dataArte.innerHTML = dataOK

var dataRetoque = document.getElementById("horaRetoque")

var ETD_Retoque = addWorkDays(hoje,2)

console.log("Data da Arte "+ETD_Arte)

var dia = ETD_Retoque.getDate()
var mes = ETD_Retoque.getMonth()+1
var ano = ETD_Retoque.getFullYear()

if (dia < 10){
    dia = "0"+dia
}
if (mes < 10){
    mes = "0"+mes
}

var dataOK = dia+"/"+mes+"/"+ano

dataRetoque.innerHTML = dataOK

var dataPrepara = document.getElementById("horaPrepara")

var ETD_Retoque = addWorkDays(hoje,2)

console.log("Data da Arte "+ETD_Arte)

var dia = ETD_Retoque.getDate()
var mes = ETD_Retoque.getMonth()+1
var ano = ETD_Retoque.getFullYear()

if (dia < 10){
    dia = "0"+dia
}
if (mes < 10){
    mes = "0"+mes
}

var dataOK = dia+"/"+mes+"/"+ano

dataPrepara.innerHTML = dataOK


var dataRoland = document.getElementById("horaRoland")

var ETD_Retoque = addWorkDays(hoje,2)

console.log("Data da Arte "+ETD_Arte)

var dia = ETD_Retoque.getDate()
var mes = ETD_Retoque.getMonth()+1
var ano = ETD_Retoque.getFullYear()

if (dia < 10){
    dia = "0"+dia
}
if (mes < 10){
    mes = "0"+mes
}

var dataOK = dia+"/"+mes+"/"+ano

dataRoland.innerHTML = dataOK

var dataSmart = document.getElementById("horaSmart")

var ETD_Retoque = addWorkDays(hoje,1)

console.log("Data da Arte "+ETD_Arte)

var dia = ETD_Retoque.getDate()
var mes = ETD_Retoque.getMonth()+1
var ano = ETD_Retoque.getFullYear()

if (dia < 10){
    dia = "0"+dia
}
if (mes < 10){
    mes = "0"+mes
}

var dataOK = dia+"/"+mes+"/"+ano

dataSmart.innerHTML = dataOK

var dataFinal = document.getElementById("horaFinal")

var ETD_Retoque = addWorkDays(hoje,1)

console.log("Data da Arte "+ETD_Arte)

var dia = ETD_Retoque.getDate()
var mes = ETD_Retoque.getMonth()+1
var ano = ETD_Retoque.getFullYear()

if (dia < 10){
    dia = "0"+dia
}
if (mes < 10){
    mes = "0"+mes
}

var dataOK = dia+"/"+mes+"/"+ano

dataFinal.innerHTML = dataOK



</script>
<script>
    function preencheCurvas(){
        var tabela = document.getElementById("ListaCores")
        for (i=3;i<tabela.rows.length+1;i++){
var curva = document.getElementById("curva"+i)
curva.value = document.getElementById("curva2").value
}
    
    }
    
    function preencheLineatura(){
        var tabela = document.getElementById("ListaCores")
        for (i=3;i<tabela.rows.length+1;i++){
var lineatura = document.getElementById("lineatura"+i)
lineatura.value = document.getElementById("lineatura2").value
}
    
    }
    
    
</script>
<script>
    var usuario = api.auth.get_current_user()
    var texto = "Bem vindo, "+usuario.fullname
    document.getElementById("bemvindo").innerText = texto
</script>
    </body>
   

</html>
