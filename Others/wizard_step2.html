<!doctype html>
<html>
    <head>
      <title>Solicitação Desenho 2/4</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      
      <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">

      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
      <link rel="stylesheet" href="css/style.css">
      <link rel="stylesheet" href="css/table.css">
        <meta name="viewport" content="width=944">
        <meta name="robots" content="noindex, follow">
	<link rel="Shortcut icon" href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/favicon.ico" type="image/x-icon">
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon.png" rel="apple-touch-icon" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144" />
        <link rel="stylesheet" href="fonts/fontawesome-all.min.css">
        <link rel="stylesheet" href="fonts/font-awesome.min.css">
        <link rel="stylesheet" href="fonts/fontawesome5-overrides.min.css">
        <script src="js/popper.js"></script>
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
          <script src="js/jscolor.js"></script>
    
        <script src="/portal.cgi/PP_FILE_STORE/Sistema/assets/js/vendor/modernizr-2.6.2.min.js"></script>
      	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-1.8.3.min.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-ui-1.9.2.custom.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.cookie.js'></script>
    	<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.4.2/chroma.min.js'></script>
    <!-- portal.js -->
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-linedtextarea.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/codemirror.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/javascript.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.tmpl.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-regex.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/sitemapstyler.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/date.format.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.iframe-transport.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.fileupload.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.notify.min.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.event.drag-2.2.js'></script>
        <script type='text/javascript' src='/portal.cgi?api=js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/portal/js/nixps-portal-api.js'></script>
        <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.i18n.js'></script>
       
       
    

    </head>


    <body>

  		<div class="wrapper d-flex align-items-stretch">
  			<nav id="sidebar">
  				<div class="p-4 pt-5">
            <img>
  		  		<img src="./logo/logo_valgroup.png" style="width: 90%; margin-bottom: 50px;">
             <ul class="active components mb-5">
                  <li  style="color: #004b93; list-style-type: none">Cadastros
                  <ul>
                       <li style="list-style-type: none">
                     <a href="cadastros_clientes.html"><i class="fas fa-user-tie" style="margin-right: 5px"></i>Clientes</a>
                    </li>
                 <li  style="list-style-type: none">
                     <a href="cadastros_fornecedores.html"><i class="fas fa-receipt" style="margin-right: 5px"></i>Fornecedores</a>
                    </li>
                     <li  style="list-style-type: none">
                     <a href="cadastros_tecnicos.html"><i class="fas fa-cogs" style="margin-right: 5px"></i>Técnicos</a>
                    </li>
                     <li style="list-style-type: none">
                     <a href="cadastros_tintas.html"><i class="fas fa-receipt" style="margin-right: 5px"></i>Cores</a>
                    </li>
                    <li style="list-style-type: none">
                     <a href="receita_tintas.html"><i class="fas fa-swatchbook" style="margin-right: 5px"></i>Receitas Tintas</a>
                    </li>
                    <li  style="list-style-type: none">
                     <a href="fluxos_aprovacao.html"><i class="fas fa-user-check" style="margin-right: 5px"></i>Fluxos Aprovação</a>
                    </li>
                    </ul>
                </ul>
                <ul class="components mb-5">
                   <li style="color: #004b93; list-style-type: none">Anilox
                  <ul>
                     <li style="list-style-type: none">
                     <a href="cadastros_anilox.html"><i class="fas fa-cog" style="margin-right: 5px"></i>Novo</a>
                    </li>
                    <li  style="list-style-type: none">
                     <a href="alteracao_bcm_anilox.html"><i class="fas fa-wrench" style="margin-right: 5px"></i>Alteração BCM</a>
                    </li>
                    <li class="active" style="list-style-type: none">
                     <a href="lavagem_anilox.html"><i class="fas fa-biohazard" style="margin-right: 5px"></i>Registrar Lavagem</a>
                    </li>
                    </ul>
                </ul>
                
                    
       
   
  	        <div class="footer">
  	        	<p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0.
  						  Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib.com</a>
  						   Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
  	        </div>
  	      </div>
      	</nav>

          <!-- Page Content  -->
        <div id="content" class="p-4 p-md-5">

          <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">

              <button type="button" id="sidebarCollapse" class="btn btn-primary">
                <i class="fa fa-bars"></i>
                <span class="sr-only">Toggle Menu</span>
              </button>
              <button class="btn btn-dark d-inline-block d-lg-none ml-auto" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <i class="fa fa-bars"></i>
              </button>
              <div id="bemvindo" style="margin-left: 20px;"></div>

              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav ml-auto">
                 <!--<li class="nav-item">
                      <a class="nav-link" href="solicitacaoArtes.html">Nova Solicitação</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="DashBoard_aprovacoes.html">Dashboard</a>
                  </li>-->
                </ul>
              </div>
            </div>
          </nav>
          <div>
        <h2 style="display:inline-block;">Ficha Técnica</h2>
      
       <br>
        
       
        
        <div  class="form-group col-md-11" style="display:inline-block;">
        <h4>Cores</h4>
        <br>
            <div  class="form-group col-md-3" style="display:inline-block;">
                
                   <input type="checkbox" class="form-group" id="usar_receita" onchange="usar_receita()" name="usar_receita">
                     <label for="a_unidade">Usar Receita</label> 
                 </div>
                <div id="div_receita" class="form-group col-md-2" style="display:none;">
                <label for="receita">Receitas</label>
                   <input type="text" class="form-control" id="receita"  name="receita" list="as_receitas">
                   <datalist id="as_receitas"></datalist>
                      
                 </div>
                 <button id="div_button_receita" onclick="carregar_receita()" style="display: none">Carregar Receita</button>
           <br>
            
       
       

            
                 
                 
                   
               
               <section class="form-group col-md-6" style="display:inline-block;"></section>
                  <div id="button_salva" class="form-group" style="display:inline-block;">
                      <div id="msg_salvar_anilox"></div>
                      <button id="save_button" class="btn btn-primary" onclick="salva_pedido()">Salvar Pedido</button>
                      <button id="save_button2" class="btn btn-primary" onclick="proxima_etapa()">Próximo --></button>
                  </div>
                 <hr>
                
                 
                 
       
            
             
            </div>
            
            <!-- terminar mostra locais e começa mostra registro -->
            
          
          
           
                <br>
                  <div id="info_update" style="color: green"></div>
              
            </div>
        
       
  	
  		
  	
  	<script>
  	    // funcoes de apoio
  	    
  	    var usuario = api.auth.get_current_user()
  	    
      function clearTable(table) {
  var rows = table.rows;
  var i = rows.length;
  while (--i) {
    rows[i].parentNode.removeChild(rows[i]);
    // or
    // table.deleteRow(i);
  }
}

function onlyUnique(value, index, self) {
  return self.indexOf(value) === index;
}

function cmyk2rgb(c, m, y, k, normalized){
    c = (c / 100);
    m = (m / 100);
    y = (y / 100);
    k = (k / 100);
    
    c = c * (1 - k) + k;
    m = m * (1 - k) + k;
    y = y * (1 - k) + k;
    
    var r = 1 - c;
    var g = 1 - m;
    var b = 1 - y;
    
    if(!normalized){
        r = Math.round(255 * r);
        g = Math.round(255 * g);
        b = Math.round(255 * b);
    }
    
    return {
        r: r,
        g: g,
        b: b
    }
}

function rgb2cmyk(r, g, b, normalized){
    var c = 1 - (r / 255);
    var m = 1 - (g / 255);
    var y = 1 - (b / 255);
    var k = Math.min(c, Math.min(m, y));
    
    c = (c - k) / (1 - k);
    m = (m - k) / (1 - k);
    y = (y - k) / (1 - k);
    
    if(!normalized){
        c = Math.round(c * 10000) / 100;
        m = Math.round(m * 10000) / 100;
        y = Math.round(y * 10000) / 100;
        k = Math.round(k * 10000) / 100;
    }
    
    c = isNaN(c) ? 0 : c;
    m = isNaN(m) ? 0 : m;
    y = isNaN(y) ? 0 : y;
    k = isNaN(k) ? 0 : k;
    
    return {
        c: c,
        m: m,
        y: y,
        k: k
    }
}


function componentToHex(c) {
  var hex = c.toString(16);
  return hex.length == 1 ? "0" + hex : hex;
}

function rgbToHex(r, g, b) {
  return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
}

// preenche Selects

selectTipo = document.getElementById('tipo_trabalho');
    var tiposTipo = api.custom_objects.list_with_options("BR-VALFI_TipoTrabalho",[],["tipo","ascending"]).results
    for (var i = 0; i<tiposTipo.length; i++){
        var opt = document.createElement('option');
        opt.value = tiposTipo[i].tipo;
        opt.innerHTML = tiposTipo[i].tipo;
        selectTipo.appendChild(opt);
    }
    
    selectPlantas= document.getElementById('a_unidade');
    var tiposTipo2 = api.custom_objects.list_with_options("BR-VALFI_plantas",[],["tipo","ascending"]).results
    for (var i = 0; i<tiposTipo2.length; i++){
        var opt = document.createElement('option');
        opt.value = tiposTipo2[i].nome;
        opt.innerHTML = tiposTipo2[i].nome;
        selectPlantas.appendChild(opt);
    }
    
    // preenche Datalist
    
     var listaCodigo2 = api.custom_objects.list_with_options("BR-VALFI_clientes",[],["fantasia","ascending"],["fantasia"]).results;
          var options=''; // variable to store the options
          for(var i = 0; i < listaCodigo2.length; i++){
              
          options += '<option value="'+listaCodigo2[i].fantasia+'" />';
  
          }
           document.getElementById('os_clientes').innerHTML = options;
// preenche data de hoje

var hoje = new Date()
document.getElementById("data_inicio").value = dateFormat(hoje,"yyyy-mm-dd")

  	</script>
   <script>
       function salva_pedido(){
           var data = {}
           data["unidade"] = document.getElementById("a_unidade").value
           data["tipo_trabalho"] = document.getElementById("tipo_trabalho").value
            data["criado_em"] = new Date()
            data["ospg"] = document.getElementById("ospg_numero").value
            var info_arte = {}
            info_arte["codigo"] = document.getElementById("codigo_arte").value
            info_arte["revisao"] = document.getElementById("arte_revisao").value
            info_arte["evolucao"] = document.getElementById("arte_evolucao").value
            data["info_arte"] = info_arte
            data["cliente"] = document.getElementById("cliente").value
            data["item"] = document.getElementById("item").value
            data["descricao"] = document.getElementById("descricao").value
            console.log(data)
           
       }
       
       function proxima_etapa(){
           
          if (data_pagina != undefined){
              var data = data_pagina
              var info_step1 = {}
          } else {
              var data = {}
              var info_step1 = {}
          }
          info_step1["unidade"] = document.getElementById("a_unidade").value
           info_step1["tipo_trabalho"] = document.getElementById("tipo_trabalho").value
            info_step1["criado_em"] = new Date()
            info_step1["criado_por"] = usuario.fullname
            info_step1["ospg"] = document.getElementById("ospg_numero").value
            var info_arte = {}
            info_arte["codigo"] = document.getElementById("codigo_arte").value
            info_arte["revisao"] = document.getElementById("arte_revisao").value
            info_arte["evolucao"] = document.getElementById("arte_evolucao").value
            info_step1["info_arte"] = info_arte
            info_step1["cliente"] = document.getElementById("cliente").value
            info_step1["item"] = document.getElementById("item").value
            info_step1["descricao"] = document.getElementById("descricao").value
            data["info_step1"] = info_step1
            
            var inicia_wizard = api_sync.hub.start_from_whitepaper_with_files_and_variables("WIZARD_SOLICITACAO","wizard_passo_1", [] ,{"data":data,"usuario":usuario});
       
       
        var workable_id = inicia_wizard.workable_id
        var workableConsoleLog = function ()  // a cada 30s roda isso e atualiza a variavel form...
          {
            var variaveis = api.workable.get_merged_variables(workable_id)
           if (variaveis.variables.state.value == "finalizado"){
                console.log("Achei! "+workable_id)
                
                  myStopFunction(workable_id);
              }
        }
	   var workflowTimeout = setInterval(workableConsoleLog, 500);
        function myStopFunction(theID) {
                    clearInterval(workflowTimeout);
                    
                    window.open("wizard_step2.html?ordem="+theID,"_self")
                    }
           
       }
   </script>
  	
  
  
  	
  






    </body>

</html>