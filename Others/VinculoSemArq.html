<!doctype html>
<html class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Criar Vinculo - Finepack</title>
        <meta name="description" content="Versioning">
        <meta name="viewport" content="width=944">
        <meta name="robots" content="noindex, follow">
	<link rel="Shortcut icon" href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/favicon.ico" type="image/x-icon">
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon.png" rel="apple-touch-icon" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144" />
        <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/table.css">
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/popper.js"></script>
        <script src="js/main.js"></script>

        <script src="/portal.cgi/PP_FILE_STORE/Sistema/assets/js/vendor/modernizr-2.6.2.min.js"></script>
      	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-1.8.3.min.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-ui-1.9.2.custom.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.cookie.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.appear-1.1.1.min.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-linedtextarea.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/codemirror.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/javascript.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.tmpl.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-regex.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/sitemapstyler.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/date.format.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.iframe-transport.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.fileupload.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.notify.min.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.event.drag-2.2.js'></script>
      <script src="js/jscolor.js"></script>
        <script type='text/javascript' src='/portal.cgi?api=js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/portal/js/nixps-portal-api.js'></script>
        <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.i18n.js'></script>
        <script>
            var queryString = window.location.search;
            //console.log(queryString);
            //var ordem2 = queryString.substring(7)
            var ordem = decodeURI(queryString.substring(7,queryString.length))
            console.log(ordem)
        </script>
    
         <script>
          function logout() {
               $.cookie('user_id', '', { expires: -1, path: '/' });
               $.cookie('user_hash', '', { expires: -1, path: '/' });
               $.cookie('expiration_date', '', { expires: -1, path: '/' });
               $.cookie('customer_id', '', { expires: -1, path: '/' });
               $.cookie('customer_name', '', { expires: -1, path: '/' });
               $.cookie('username', '', { expires: -1, path: '/' });
               $.cookie('scope', '', { expires: -1, path: '/' });
               var lSession = api_sync.auth.create_session('', ''); // fecha sessao do CloudFlow
               var l_url = '/portal.cgi/PP_FILE_STORE/Public/Login/login.html'
               window.location.href = l_url;
               //window.location.href = '?upload=done';
          }
             
           
       </script>

    </head>


    <body>


      <div class="wrapper d-flex align-items-stretch">
  			<nav id="sidebar">
  				<div class="p-4 pt-5">
            <img>
  		  	<img src="./logo/finepack.png" style="width: 70%; margin-bottom: 50px;">
  	        
  	        <div style="width: 100%"><a id="link_proofscope" href="#" target="_blank"><img id="preview" width="100%"></a></div>

  	        <div class="footer">
  	        	<p style="font-size: 6pt; margin-top:380px">Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0.
  						  Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib.com</a>
  						  Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
  	        </div>

  	      </div>
      	</nav>

          <!-- Page Content  -->
        <div id="content" class="p-4 p-md-5">

          <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">

              <button type="button" id="sidebarCollapse" class="btn btn-primary">
                <i class="fa fa-bars"></i>
                <span class="sr-only">Toggle Menu</span>
              </button>
              <button class="btn btn-dark d-inline-block d-lg-none ml-auto" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <i class="fa fa-bars"></i>
              </button>
               <div class="col-md-5" id="bemvindo"></div>

              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav ml-auto">
                  <li class="nav-item">
                      <a class="nav-link" onclick="logout()">Logout</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
        <div class="col-md-7" style="display: inline-block;">  
        <h2>Criação Vinculo</h2>
        </div>
        
          
          <div class="form-group col-md-4" style="display:inline-block; padding-right: 8px;">
            <label for="dataVinculo">Data Vinculo</label>
            <input type="text" class="form-control" id="dataVinculo" name="dataVinculo" readonly>
          </div>
          <div class="form-group col-md-2" style="display:inline-block;">
            <label for="codigoCliente">Codigo Cliente</label>
            <input type="text" onfocusout="criaVinculo()" class="form-control" id="codigoCliente" name="codigoCliente" list="os_clientes">
            <datalist id="os_clientes">
          </div>
          <div class="form-group col-md-4" style="display:inline-block;">
            <label for="nomeCliente">Nome Cliente</label>
            <input type="text" class="form-control" id="nomeCliente" name="nomeCliente" readonly>
          </div>
          <div id="info_antiga" class="form-group col-md-2" style="display:inline-block;">
            <input type="checkbox"  onchange="selecionaVinculos()" class="form-group" id="arqAntigo" name="arqAntigo">
            <label for=:arqAntigo">Selecionar Versao Anterior</label>
          </div>
          <div class="form-group col-md-3" id="vincSconde" style="display:none;">
            <label for="vincAnterior">Vinculo Anterior</label>
            <input type="text" onchange="preencheDadosVinc()" class="form-control" id="vincAnterior" name="vincAnterior" list="osvinculos">
            <datalist id="osvinculos"></datalist>
          </div>
          <div id="vinculo_novo" class="form-group col-md-3" style="display:inline-block;">
            <label for="codVinc_Novo">Código Vinculo</label>
            <input type="text" class="form-control" id="codVinc_Novo" name="codVinc_Novo" readonly>
          </div>
            <div class="form-group col-md-7" style="display:inline-block;">
              <label for="descricao">Descricao</label>
              <input type="text" class="form-control"  id="descricao" name="descricao">
            </div>
            <div class="form-group col-md-4" style="display:inline-block;">
              <label for="sku">SKU</label>
              <input type="text" class="form-control" id="sku" name="sku">
            </div>
            
          <div class="form-group col-md-4" style="display:inline-block;">
            <label for="codBarras">Codigo Barras</label>
            <input type="text" class="form-control" id="codBarras" name="codBarras">
          </div>
          <div class="form-group col-md-2" style="display:inline-block;">
            <label for="passo">Passo</label>
            <input type="text" class="form-control" id="passo" name="passo">
          </div>
          <div class="form-group col-md-2" style="display:inline-block;">
            <label for="largura">Largura</label>
            <input type="text" class="form-control" id="largura" name="largura">
          </div>
          <div class="form-group col-md-3" style="display:inline-block;">
            <label for="fluxoAprova">Grupo Aprovacao</label>
            <select class="form-control" id="fluxoAprova" name="fluxoAprova">
              <option>Selecionar...</option>
              <option>Nenhum</option>
              </select>
          </div>
          <div class="form-group col-md-11">
            <label for="observa">Observações</label>
            <textarea class="form-group col-md-12" id="observa" name="observa" rows="5" cols="180"></textarea>
          </div>
          
          <div class="form-group col-md-3" style="display:inline-block;">
            <label for="responsavel">Responsavel</label>
            <input type="text" class="form-control" id="responsavel" name="responsavel" readonly>
          </div>
          <!--<div class="form-group col-md-1" style="display:inline-block;">
            <a  id="openfolder" href="#" target="_blank"><img src="./assets/img/openFolder.png"  height="40px"></a>
          </div>-->
          <hr>
          <div class="form-group col-md-11">
          <div class="form-group" style="display:inline-block;width: 100%">
          <h4>Cores do arquivo</h4>
          <div class="form-group" style="vertical-align: top; display:inline-block;width: 32%">
            <h5>Cores Impressão</h5>
          <table id="tabelaCores1">
                <tr>
                <td class="form-group" style="width: 5%"></td>
                <td class="form-group" style="width:70%;"></td>
                <td class="form-group" style="width:10%;"></td>
                <td class="form-group" style="width:10%;"></td>
                </tr>
          </table>
    </div>
    <div class="form-group" style="vertical-align: top; display:inline-block;width: 32%">
      <h5>Canais Tecnicos</h5>
    <table id="tabelaCores2">
          <tr>
          <td class="form-group" style="width: 5%"></td>
          <td class="form-group" style="width:70%;"></td>
          <td class="form-group" style="width:10%;"></td>
          <td class="form-group" style="width:10%;"></td>
          </tr>
    </table>
</div>
<div class="form-group" id="check_Cores" style="vertical-align: top; display:inline-block;width: 32%">
  <h5>Cores de Processo</h5>
  <input type="checkbox" class="form-group" id="CT_branco" value="Branco" style="margin-top: 20px; margin-left: 15px;"><span style="margin-left: 5px;">Branco</span><br>
  <input type="checkbox" class="form-group" id="CT_vernizmatte" value="Verniz Matte" style="margin-top: 10px;margin-left: 15px;"><span style="margin-left: 5px;">Verniz Matte</span><br>
  <input type="checkbox" class="form-group" id="CT_vernizbrilho" value="Verniz Brilho" style="margin-top: 10px;margin-left: 15px;"><span style="margin-left: 5px;">Verniz Brilho</span><br>
  <input type="checkbox" class="form-group" id="CT_vernizprotecao" value="Verniz Protecao" style="margin-top: 10px;margin-left: 15px;"><span style="margin-left: 5px;">Verniz Protecao</span><br>
  <input type="checkbox" class="form-group" id="CT_primer" value="Primer" style="margin-top: 10px;margin-left: 15px;"><span style="margin-left: 5px;">Primer</span><br>
  <input type="checkbox" class="form-group" id="CT_primer2" value="Primer 2" style="margin-top: 10px;margin-left: 15px;"><span style="margin-left: 5px;">Primer 2</span><br>
  <input type="checkbox" class="form-group" id="CT_coldseal" value="Cold Seal" style="margin-top: 10px;margin-left: 15px;"><span style="margin-left: 5px;">Cold Seal</span><br>
  <input type="checkbox" class="form-group" id="CT_lacaover" value="Laca Over" style="margin-top: 10px;margin-left: 15px;"><span style="margin-left: 5px;">Laca Over</span>
</div>
<hr>

  Adicionar Tinta: <input onfocusout="existeTinta()" type="text" class="form-group" style="display:inline-block;" id="ascores" list="as_Cores">
  <datalist id="as_Cores">
  </datalist>
  <div  id="botaoCores" style="display:none;">
  <button data-jscolor="{valueElement:'#val3'}"></button>
  <input id="val3" value="rgba(255,160,0,0.5)" onchange="adicionaTinta2()" name="color3" type="hidden">
  Selecione a cor desejada
  <input style="margin-left: 10px;" type="checkbox" id="adicionarabase">Adicionar a base de dados
  </div>
  
<button class="btn btn-primary" onclick="adicionaTinta()">Gravar Tinta</button>
<hr>
    </div>
    
</div>
<section class="form-group col-md-4" style="display:inline-block;"></section>
<div style="display: inline-block;"class="form-group col-md-4">
  
  </div>
  
    
                    
                    <hr>
                    <button class="btn-primary" id='iniciaAcao' onclick="salvaMudanca()" style="display: inline-block;">Criar Vinculo</button><div id="statusAcao" class="col-md-5" style="display:inline-block;">
                      <button class="btn-primary" id='cancelaAcao' onclick="cancelaMudanca()" style="display: inline-block; margin-left:10px;">Cancelar</button><div id="statusAcao" class="col-md-5" style="display:inline-block;">
                      </div>
                </div>
                
                </div>


        <div style="clear:both"></div>
        <script>
      var codigos = api.custom_objects.list("BR-FINEPACK_Clientes").results
      var options=''; // variable to store the options
      for(var i = 0; i < codigos.length; i++){
          
      options += '<option value="'+codigos[i].codigo+'" />';

      }
       document.getElementById('os_clientes').innerHTML = options;

        </script>
        <script>
          function cancelaMudanca(){
            window.close()
          }
        </script>
        <script>
          function componentToHex(c) {
  var hex = c.toString(16);
  return hex.length == 1 ? "0" + hex : hex;
}

function rgbToHex(r, g, b) {
  return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
}
          function hexToRgb(hex) {
  var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
  return result ? {
    r: parseInt(result[1], 16),
    g: parseInt(result[2], 16),
    b: parseInt(result[3], 16)
  } : null;
}
          function existeTinta(){
            var qualtinta = document.getElementById("ascores").value
            var existenaBase = api.custom_objects.list_with_options("PantoneColor",["nome","equal to",qualtinta]).results
            if (existenaBase.length == 0){
              document.getElementById("botaoCores").style = "display:inline-block;"
            }
            }
          
          function adicionaTinta(){
            var qualtinta = document.getElementById("ascores").value
            var a_baseAtual = api.custom_objects.list_with_options("Finepack_DummyUpload",["_id","equal to",novo_id]).results[0]
            var existenaBase = api.custom_objects.list_with_options("PantoneColor",["nome","equal to",qualtinta]).results
            if (existenaBase.length > 0){
              var corNova = {}
              corNova["nome"] = qualtinta
              corNova["tipo"] = "normal"
              var corHex = existenaBase[0].cor 
              var corRGB = hexToRgb(corHex)
              corNova["rgb"] = corRGB.r+","+corRGB.g+","+corRGB.b
              var coresAtuais = a_baseAtual.Cores_Arquivo
              coresAtuais.push(corNova)
              api.custom_objects.set_keys("Finepack_DummyUpload",novo_id,{Cores_Arquivo:coresAtuais})
              setTimeout(() => { preencheCores() }, 1000);
                      

            } else {

              var qualtinta = document.getElementById("ascores").value
              var corNova = {}
              corNova["nome"] = qualtinta
              corNova["tipo"] = "normal"
              var valores = (document.getElementById("val3").value).substring((document.getElementById("val3").value).indexOf("(")+1,(document.getElementById("val3").value).lastIndexOf(","))
              corNova["rgb"] = valores
              var coresAtuais = a_baseAtual.Cores_Arquivo
              coresAtuais.push(corNova)
              api.custom_objects.set_keys("Finepack_DummyUpload",novo_id,{Cores_Arquivo:coresAtuais})
              //if(document.getElementById("adicionarabase").checked === true){
                //console.log("vou criar a tinta")
                //var atinapra = document.getElementById("val3").value.substring(5,10)
                //var valores_atina = atinapra.split(",")
                //console.log(parseInt(valores_atina[0]))
                
                //console.log(parseInt(valores_atina[1]))
                
                //console.log(parseInt(valores_atina[2]))
                //var valorHex = rgbToHex(parseInt(valores_atina[0])+","+parseInt(valores_atina[1])+","+parseInt(valores_atina[2]))
                //var corBase = {}
                //corBase["nome"] = qualtinta
                //corBase["cor"] = valorHex
              //  api.custom_objects.create("PantoneColor",corBase) 
              //}

              setTimeout(() => { preencheCores() }, 1000);
              
            }
              

          }
        </script>
        <script>
          //Preenche tabela de coresEscala
          
            var as_cores = api.custom_objects.list("PantoneColor").results;
          
            var options=''; // variable to store the options
            for(var i = 0; i < as_cores.length; i++){
              //console.log(as_cores[i].Color)
             
              options += '<option value="'+as_cores[i].nome+'" />';
            
          
          
             }
              // console.log(options)
               //console.log(document.getElementById("osClientes"))
               document.getElementById('as_Cores').innerHTML = options;
               //console.log(document.getElementById('osClientes'));
          
          
          </script>
          <script>
          function corrigeData(serial) {
   
   var criaData = new Date(serial)
   var ano = criaData.getFullYear()
   var mes = criaData.getMonth()+1
   var dia = criaData.getDate()
   if (mes<10){
     mes = "0"+mes
   }
   if (dia < 10){
     dia = "0"
   }
   var datafinal = dia+"/"+mes+"/"+ano
    return datafinal 
   }
   function removeDiacritics (str) {
 
 var defaultDiacriticsRemovalMap = [
   {'base':'A', 'letters':/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},
   {'base':'AA','letters':/[\uA732]/g},
   {'base':'AE','letters':/[\u00C6\u01FC\u01E2]/g},
   {'base':'AO','letters':/[\uA734]/g},
   {'base':'AU','letters':/[\uA736]/g},
   {'base':'AV','letters':/[\uA738\uA73A]/g},
   {'base':'AY','letters':/[\uA73C]/g},
   {'base':'B', 'letters':/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},
   {'base':'C', 'letters':/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},
   {'base':'D', 'letters':/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},
   {'base':'DZ','letters':/[\u01F1\u01C4]/g},
   {'base':'Dz','letters':/[\u01F2\u01C5]/g},
   {'base':'E', 'letters':/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},
   {'base':'F', 'letters':/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},
   {'base':'G', 'letters':/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},
   {'base':'H', 'letters':/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},
   {'base':'I', 'letters':/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},
   {'base':'J', 'letters':/[\u004A\u24BF\uFF2A\u0134\u0248]/g},
   {'base':'K', 'letters':/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},
   {'base':'L', 'letters':/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},
   {'base':'LJ','letters':/[\u01C7]/g},
   {'base':'Lj','letters':/[\u01C8]/g},
   {'base':'M', 'letters':/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},
   {'base':'N', 'letters':/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},
   {'base':'NJ','letters':/[\u01CA]/g},
   {'base':'Nj','letters':/[\u01CB]/g},
   {'base':'O', 'letters':/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},
   {'base':'OI','letters':/[\u01A2]/g},
   {'base':'OO','letters':/[\uA74E]/g},
   {'base':'OU','letters':/[\u0222]/g},
   {'base':'P', 'letters':/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},
   {'base':'Q', 'letters':/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},
   {'base':'R', 'letters':/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},
   {'base':'S', 'letters':/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},
   {'base':'T', 'letters':/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},
   {'base':'TZ','letters':/[\uA728]/g},
   {'base':'U', 'letters':/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},
   {'base':'V', 'letters':/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},
   {'base':'VY','letters':/[\uA760]/g},
   {'base':'W', 'letters':/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},
   {'base':'X', 'letters':/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},
   {'base':'Y', 'letters':/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},
   {'base':'Z', 'letters':/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},
   {'base':'a', 'letters':/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},
   {'base':'aa','letters':/[\uA733]/g},
   {'base':'ae','letters':/[\u00E6\u01FD\u01E3]/g},
   {'base':'ao','letters':/[\uA735]/g},
   {'base':'au','letters':/[\uA737]/g},
   {'base':'av','letters':/[\uA739\uA73B]/g},
   {'base':'ay','letters':/[\uA73D]/g},
   {'base':'b', 'letters':/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},
   {'base':'c', 'letters':/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},
   {'base':'d', 'letters':/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},
   {'base':'dz','letters':/[\u01F3\u01C6]/g},
   {'base':'e', 'letters':/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},
   {'base':'f', 'letters':/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},
   {'base':'g', 'letters':/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},
   {'base':'h', 'letters':/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},
   {'base':'hv','letters':/[\u0195]/g},
   {'base':'i', 'letters':/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},
   {'base':'j', 'letters':/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},
   {'base':'k', 'letters':/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},
   {'base':'l', 'letters':/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},
   {'base':'lj','letters':/[\u01C9]/g},
   {'base':'m', 'letters':/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},
   {'base':'n', 'letters':/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},
   {'base':'nj','letters':/[\u01CC]/g},
   {'base':'o', 'letters':/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},
   {'base':'oi','letters':/[\u01A3]/g},
   {'base':'ou','letters':/[\u0223]/g},
   {'base':'oo','letters':/[\uA74F]/g},
   {'base':'p','letters':/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},
   {'base':'q','letters':/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},
   {'base':'r','letters':/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},
   {'base':'s','letters':/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},
   {'base':'t','letters':/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},
   {'base':'tz','letters':/[\uA729]/g},
   {'base':'u','letters':/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},
   {'base':'v','letters':/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},
   {'base':'vy','letters':/[\uA761]/g},
   {'base':'w','letters':/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},
   {'base':'x','letters':/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},
   {'base':'y','letters':/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},
   {'base':'z','letters':/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}
 ];
 
 
 for(var i=0; i<defaultDiacriticsRemovalMap.length; i++) {
   str = str.replace(defaultDiacriticsRemovalMap[i].letters, defaultDiacriticsRemovalMap[i].base);
 }
 
 return str;
 
 }
 
     </script>   
  

    <script>
      var novo_id = ""
      function criaVinculo(){
        var codigo_selecionado = document.getElementById("codigoCliente").value
        var busca_o_cliente = api.custom_objects.list_with_options("BR-FINEPACK_Clientes",["codigo","equal to",codigo_selecionado]).results[0]
        document.getElementById("nomeCliente").value = busca_o_cliente.nome
    //Preenche os dados da Ordem

    var fluxosAprovacao = api.custom_objects.list_with_options("BR-FINEP_Fluxos",["dados_cliente.codigo_cliente","equal to",codigo_selecionado]).results
     // var fluxosAprovacao =[]
    var nomes_fluxo = []
    var sel_fluxos = document.getElementById("fluxoAprova")
    for (i=0;i<fluxosAprovacao.length;i++){
     
// create new option element
var opt = document.createElement('option');

// create text node to add to option element (opt)
opt.appendChild( document.createTextNode(fluxosAprovacao[i].nome_fluxo) );

// set value property of opt
opt.value = fluxosAprovacao[i].nome_fluxo; 

// add opt to end of select box (sel)
sel_fluxos.appendChild(opt); 
         }

        
     //var codigo = infoOS.Codigo_Cliente
    //      var nomeCliente = infoOS.Cliente
      //    var nomeCliente_semespaco = nomeCliente.split(" ").join("")
       //   var nomeCliente_semponto = nomeCliente_semespaco.split(".").join("")
        //  var nomeOK = removeDiacritics(nomeCliente_semponto)
        //  var nomeALLCAPS = nomeOK.toUpperCase()
        //  var nomeBase = "BR-FINEP_SKU_"+nomeALLCAPS
  var osSKUs = api.custom_objects.list_with_options("BR-FINEP_SKU",["codigo_cliente","equal to",codigo_selecionado],["concat","ascending"]).results
  if (osSKUs.length > 0){
  var ultima = osSKUs[osSKUs.length-1].concat
  var codigo_split = ultima.split(".")
  var numeroNovo = parseInt(codigo_split[1])+1
  var numeroAgoraVai = pad (numeroNovo,3)
  var codigoNovaSKU = codigo_selecionado+"-"+numeroAgoraVai+"-01"
  //console.log("Codigo Novo "+codigoNovaSKU)
  } else {
    var codigoNovaSKU = codigo_selecionado.substring(3,6)+".001.01"
  }

document.getElementById("codVinc_Novo").value = codigoNovaSKU
novo_id = api.custom_objects.create("Finepack_DummyUpload",{"Cliente":busca_o_cliente.nome,"Codigo_Cliente":codigo_selecionado,"Produto":"","Observacao":"","data_upload":"","metadata":"","preview":"","Cores_Arquivo":[],"preflight_info":"","erros_preflight":"","codigos_barra":[],"responsavel":api.auth.get_current_user().fullname,"proofscope":"","fileInfo":"","approval":"approved","dimensoes_embalagem":""})._id
   
    
    document.getElementById("responsavel").value = api.auth.get_current_user().fullname

}

      
       

</script>


<script>

  //busca SKUs desse cliente

  function pad(n, width, z) {
  z = z || '0';
  n = n + '';
  return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;
}


 

  
  </script>
  
  
  <script>
    function reply_click2()
    {
      var a_baseAtual = api.custom_objects.list_with_options("Finepack_DummyUpload",["_id","equal to",novo_id]).results[0]
    
        var linha = event.srcElement.id
        //console.log(linha)
        var linha_2 = linha.split("/")
        var linha_3 = linha_2[0].split("_")

        var coresAtuais = a_baseAtual.Cores_Arquivo

        for (i=0;i<coresAtuais.length;i++){
          console.log("Cores Atuais "+coresAtuais[i].nome)
          console.log("Cor da Linha "+linha_2[1])
          if (coresAtuais[i].nome == linha_2[1]){
            var tira = coresAtuais.splice(i,1)
          }
        }
        console.log(coresAtuais)
        //console.log("A Linha 2 "+linha_2[1])
        //console.log(linha_2[1])
        api.custom_objects.set_keys("Finepack_DummyUpload",linha_3[1],{Cores_Arquivo:coresAtuais})
    
       //$('#acaoUpload').text('O upload esta sendo eliminado da base de dados e os arquivos sendo apagados da pasta')
        setTimeout(() => { preencheCores() }, 1000);
    
    }
    </script>
    <script>
      function reply_click()
      {
        var a_baseAtual = api.custom_objects.list_with_options("Finepack_DummyUpload",["_id","equal to",novo_id]).results[0]
    
          var linha = event.srcElement.id
          //console.log(linha)
          var linha_2 = linha.split("/")
          var linha_3 = linha_2[0].split("_")
  
          var coresAtuais = a_baseAtual.Cores_Arquivo
  
          for (i=0;i<coresAtuais.length;i++){
            console.log("Cores Atuais "+coresAtuais[i].nome)
            console.log("Cor da Linha "+linha_2[1])
            if (coresAtuais[i].nome == linha_2[1]){
              coresAtuais[i].tipo = "tecnica"            }
          }
          console.log(coresAtuais)
          //console.log("A Linha 2 "+linha_2[1])
          //console.log(linha_2[1])
          api.custom_objects.set_keys("Finepack_DummyUpload",linha_3[1],{Cores_Arquivo:coresAtuais})
      
         //$('#acaoUpload').text('O upload esta sendo eliminado da base de dados e os arquivos sendo apagados da pasta')
          setTimeout(() => { preencheCores() }, 1000);
      
      }
      </script>
      <script>
        function reply_click3()
        {
          
            var linha = event.srcElement.id
            //console.log(linha)
            var linha_2 = linha.split("/")
            var linha_3 = linha_2[0].split("_")
            var a_baseAtual = api.custom_objects.list_with_options("Finepack_DummyUpload",["_id","equal to",novo_id]).results[0]
    
            var coresAtuais = a_baseAtual.Cores_Arquivo
    
            for (i=0;i<coresAtuais.length;i++){
              console.log("Cores Atuais "+coresAtuais[i].nome)
              console.log("Cor da Linha "+linha_2[1])
              if (coresAtuais[i].nome == linha_2[1]){
              coresAtuais[i]["tipo"] = "normal"
              console.log("cores "+coresAtuais[i]["tipo"])
              api.custom_objects.set_keys("Finepack_DummyUpload",linha_3[1],{Cores_Arquivo:coresAtuais})
        
                        }
            }
            console.log(coresAtuais)
            //console.log("A Linha 2 "+linha_2[1])
            //console.log(linha_2[1])
            
           //$('#acaoUpload').text('O upload esta sendo eliminado da base de dados e os arquivos sendo apagados da pasta')
            setTimeout(() => { preencheCores() }, 1000);
        
        }
        </script>
    
    <script>
      function salvaMudanca(){
        var descricao = document.getElementById("descricao").value
        var sku = document.getElementById("sku").value
        var cod_barra = document.getElementById("codBarras").value
        var passo = document.getElementById("passo").value
        var largura = document.getElementById("largura").value
        var grupo_aprova = document.getElementById("fluxoAprova").value
        if (grupo_aprova != "Nenhum"){
        var qualAprova = api.custom_objects.list_with_options("BR-FINEP_Fluxos",["nome_fluxo","equal to",grupo_aprova,"and","dados_cliente.codigo_cliente","equal to",document.getElementById("codigoCliente").value]).results[0]
        } else {
        var qualAprova = []
        }
        var observac = document.getElementById("observa").value
        var user = api.auth.get_current_user()
        var responsavel = user.fullname
        var branco = document.getElementById("CT_branco").checked
        var verniz1 = document.getElementById("CT_vernizmatte").checked
        var verniz2 = document.getElementById("CT_vernizbrilho").checked
        var coldseal = document.getElementById("CT_coldseal").checked
        var primer = document.getElementById("CT_primer").checked
        var cilindros_tecnicos = []
        if (verniz1 === true){
          cilindros_tecnicos.push("Verniz Matte")
        }
        if (verniz2 === true){
          cilindros_tecnicos.push("Verniz Brilho")
        }
        if (coldseal === true){
          cilindros_tecnicos.push("Cold Seal")
        }
        if (primer === true){
          cilindros_tecnicos.push("Primer")
        }
        if (branco === true){
          cilindros_tecnicos.push("Branco")
        }
        var a_baseAtual = api.custom_objects.list_with_options("Finepack_DummyUpload",["_id","equal to",novo_id]).results[0]
    
        var data2 = {}
        data2["codigo_barra"] = cod_barra
        data2["id"] = novo_id
        data2["SKU"] = sku
        data2["codigo_vinculo"] = document.getElementById("codVinc_Novo").value
        data2["descricao"] = descricao
        data2["cliente"] = a_baseAtual.Cliente
        data2["codigo_cliente"] =a_baseAtual.Codigo_Cliente
        data2["observacoes"] = [observac]
        var info_embalagem2 = {}
        info_embalagem2["passo"] = passo
        info_embalagem2["largura"] = largura
        data2["info_embalagem"] = info_embalagem2
        data2["grupo_aprova"] = qualAprova
        data2["responsavel"] = responsavel
        data2["cilindros_tecnicos"] = cilindros_tecnicos
        if (grupo_aprova == "Selecionar..."){
          alert("Selecionar grupo de aprovação")
        } else {
        api.hub.start_from_whitepaper_with_files_and_variables("BR-FINEP_Vinculo","vinculo_semArq",[],data2)
        window.close()
        }
      }
    </script>
<script>
  document.querySelector('#check_Cores').onclick = function(ev) {
  if(ev.target.value) {
    if (ev.target.checked === true){
      var qualcor = api.custom_objects.list_with_options("PantoneColor",["nome","equal to",ev.target.value]).results[0]
    var valorRGB = hexToRgb(qualcor.cor)
    var a_baseAtual = api.custom_objects.list_with_options("Finepack_DummyUpload",["_id","equal to",novo_id]).results[0]
          
      var corNova = {}
              corNova["nome"] = qualcor.nome
              corNova["tipo"] = "normal"
              corNova["rgb"] = valorRGB.r+","+valorRGB.g+","+valorRGB.b
              var coresAtuais = a_baseAtual.Cores_Arquivo
              coresAtuais.push(corNova)
              api.custom_objects.set_keys("Finepack_DummyUpload",novo_id,{Cores_Arquivo:coresAtuais})
              setTimeout(() => { preencheCores() }, 1000);
              
    } else {
      var coresAtuais = a_baseAtual.Cores_Arquivo
      for (i=0;i<coresAtuais.length;i++){
        if (coresAtuais[i].nome == ev.target.value){
          var tira = coresAtuais.splice(i,1)
          api.custom_objects.set_keys("Finepack_DummyUpload",novo_id,{Cores_Arquivo:coresAtuais})
          setTimeout(() => { preencheCores() }, 1000);
          
          }
               }
    }
    console.log(ev.target.checked, ev.target.value);
  }
}
</script>
<script>
  function preencheCores(){
$("#tabelaCores1").find("tr:gt(0)").remove();
$("#tabelaCores2").find("tr:gt(0)").remove();      

var a_baseAtual = api.custom_objects.list_with_options("Finepack_DummyUpload",["_id","equal to",novo_id]).results[0]
          
var cores = a_baseAtual.Cores_Arquivo

for(i=0;i<cores.length;i++){
        var nomeCor = cores[i].nome
        var rgbCor = cores[i].rgb
        var rgb_split = rgbCor.split(",")
        var cor_R = parseInt(rgb_split[0])
        var cor_G = parseInt(rgb_split[1])
        var cor_B = parseInt(rgb_split[2])
        var stringRGB = "rgb("+cor_R+","+cor_G+","+cor_B+")"
   if (cores[i].tipo == "normal"){
        var table = document.getElementById("tabelaCores1");
        var qtasrow = table.rows.length
        var row =  table.insertRow(qtasrow);
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);
        
        
  cell1.innerHTML = '<span style="margin-top:5px;height:20px;width:20px;background-color:'+stringRGB+';border-radius:50%;display:inline-block"></span>';
  cell2.innerHTML = '<span style="width: 100%;">'+nomeCor+'</span>';
  cell4.innerHTML = '<div><img onclick="reply_click()" id="movetecnica_'+novo_id+'/'+nomeCor+'" src="./Icons/setadireita.png" width="20px"></div>';
  cell3.innerHTML = '<div><img onclick="reply_click2()" id="apagaCor_'+novo_id+'/'+nomeCor+'" src="./Icons/delete.png" width="40px"></div>';
              }
              else {
                var table = document.getElementById("tabelaCores2");
        var qtasrow = table.rows.length
        var row =  table.insertRow(qtasrow);
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);
        
        
  cell1.innerHTML = '<span style="margin-top:5px;height:20px;width:20px;background-color:'+stringRGB+';border-radius:50%;display:inline-block"></span>';
  cell2.innerHTML = '<span style="width: 100%;">'+nomeCor+'</span>';
  cell4.innerHTML = '<div><img onclick="reply_click3()" id="movetecnica_'+novo_id+'/'+nomeCor+'" src="./Icons/setaesquerda.png" width="20px"></div>';
  cell3.innerHTML = '<div><img onclick="reply_click2()" id="apagaCor_'+novo_id+'/'+nomeCor+'" src="./Icons/delete.png" width="40px"></div>';
        
                
              }
            }
        
            }  
</script>
<script>
  function selecionaVinculos(){
    var estaChecado = document.getElementById("arqAntigo").checked
    if (estaChecado === true){
    document.getElementById("vincSconde").style="display:inline-block;"
    document.getElementById("codVinc_Novo").value = ""
    var cliente_Cod = document.getElementById("codigoCliente").value
    var buscaSKU = api.custom_objects.list_with_options("BR-FINEP_SKU",["codigo_cliente","equal to",cliente_Cod]).results
    
          
            var options2=''; // variable to store the options
            for(var i = 0; i < buscaSKU.length; i++){
              //console.log(as_cores[i].Color)
             
              options2 += '<option value="'+buscaSKU[i].cod_finepack+'" />';
            
          
          
             }
              // console.log(options)
               //console.log(document.getElementById("osClientes"))
               document.getElementById('osvinculos').innerHTML = options2;
               //console.log(document.getElementById('osClientes'));
          
    } else {
      document.getElementById("vincSconde").style="display:none;"
      document.getElementById("descricao").value = ""
document.getElementById("sku").value = ""
document.getElementById("codBarras").value = ""
      criaVinculo()

    }


  }
</script>
<script>
  function  preencheDadosVinc(){
    var ocliente = document.getElementById("codigoCliente").value
    var id_fine = document.getElementById("vincAnterior").value
    var ver1 = id_fine.split(".")
    var ver2 = parseInt(ver1[1])+1
    if (ver2 < 10){
ver2 = "0"+ver2
}
document.getElementById("codVinc_Novo").value = ocliente+"-"+ver1[0]+"-"+ver2
var qualVinc = api.custom_objects.list_with_options("BR-FINEP_SKU",["codigo_cliente","equal to",ocliente,"and","cod_finepack","equal to",id_fine]).results[0]

var id2 = id_fine.split(".")
var pasta = api.folder.list_with_options(["cloudflow.enclosing_folder","contains","ServidorRoto","and","cloudflow.enclosing_folder","contains",ocliente+"-"+id2[0]]).results

 var pastaServidor = (pasta[0].path[3])
var descricaoPasta = pastaServidor.substr(pastaServidor.indexOf(' ')+1)       

document.getElementById("descricao").value = descricaoPasta
document.getElementById("sku").value = qualVinc.sku
document.getElementById("codBarras").value = qualVinc.cod_barras

document.getElementById("descricao").readOnly = true



  }
</script>
</body>

</html>
