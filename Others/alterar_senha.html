<!doctype html>
<html>
    <head>
      <title>Alterar Senha</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      
      <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">

      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
      <link rel="stylesheet" href="css/style.css">
      <link rel="stylesheet" href="css/table.css">
        <meta name="viewport" content="width=944">
        <meta name="robots" content="noindex, follow">
	<link rel="Shortcut icon" href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/favicon.ico" type="image/x-icon">
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon.png" rel="apple-touch-icon" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144" />
        <link rel="stylesheet" href="fonts/fontawesome-all.min.css">
        <link rel="stylesheet" href="fonts/font-awesome.min.css">
        <link rel="stylesheet" href="fonts/fontawesome5-overrides.min.css">
        <script src="js/popper.js"></script>
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
          <script src="js/jscolor.js"></script>
    
        <script src="/portal.cgi/PP_FILE_STORE/Sistema/assets/js/vendor/modernizr-2.6.2.min.js"></script>
      	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-1.8.3.min.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-ui-1.9.2.custom.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.cookie.js'></script>
    	<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.4.2/chroma.min.js'></script>
    <!-- portal.js -->
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-linedtextarea.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/codemirror.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/javascript.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.tmpl.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-regex.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/sitemapstyler.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/date.format.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.iframe-transport.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.fileupload.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.notify.min.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.event.drag-2.2.js'></script>
        <script type='text/javascript' src='/portal.cgi?api=js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/portal/js/nixps-portal-api.js'></script>
        <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.i18n.js'></script>
       
        <script>
            var queryString = window.location.search;
            var ordem = decodeURI(queryString.substring(7,queryString.length))
        </script>
    

    </head>


    <body>

  		<div class="wrapper d-flex align-items-stretch">
  			<nav id="sidebar">
  				<div class="p-4 pt-5">
            <img>
  		  		<img src="./logo/logo_valgroup.png" style="width: 90%; margin-bottom: 50px;">
             
                    
       
   
  	        <div class="footer">
  	        	<p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0.
  						  Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib.com</a>
  						   Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
  	        </div>
  	      </div>
      	</nav>

          <!-- Page Content  -->
        <div id="content" class="p-4 p-md-5">

          <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">

              <button type="button" id="sidebarCollapse" class="btn btn-primary">
                <i class="fa fa-bars"></i>
                <span class="sr-only">Toggle Menu</span>
              </button>
              <button class="btn btn-dark d-inline-block d-lg-none ml-auto" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <i class="fa fa-bars"></i>
              </button>
              <div id="bemvindo" style="margin-left: 20px;"></div>

              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav ml-auto">
                 <li class="nav-item">
                      <a class="nav-link" href="cadastros_clientes.html">Cadastros</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="solicitacao_desenho.html">Tickets</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
          <div>
        
       <h3>Alterar Senha</h3>
      
        <br>
       <div class="form-group col-md-4" style="display:inline-block;vertical-align: top;">
            <label for="senha_atual">Senha Atual</label>
            <input type="password" class="form-control" id="senha_atual" style="width: 90%; display: inline-block; margin-right: 5px;" name="senha_atual"><i class="far fa-eye" style="display: inline-block;" id="togglePassword_1"></i>
          <span class="error" id="error_senha_atual"></span>
          </div>
<br>
   <div class="form-group col-md-4" style="display:inline-block;vertical-align: top;">
            <label for="senha_nova">Nova Senha</label>
            <input type="password" class="form-control" onchange="verifica_senha()" id="senha_nova" style="width: 90%; display: inline-block; margin-right: 5px;" name="senha_nova"><i class="far fa-eye" style="display: inline-block;" id="togglePassword_2"></i>
            <span class="error" id="error_senha_nova"></span>
          </div>
<br>
   <div class="form-group col-md-4" style="display:inline-block;vertical-align: top;">
            <label for="confirmar_senha">Confirmar Senha</label>
            <input type="password" class="form-control" onchange="verifica_senha()" id="confirmar_senha" style="width: 90%; display: inline-block; margin-right: 5px;" name="confirmar_senha"><i class="far fa-eye" style="display: inline-block;" id="togglePassword_3"></i>
         <span class="error" id="error_confirma_senha"></span>
          </div>
<br>
<button class="btn btn-primary" onclick="salvar_senha()">Alterar Senha</button>  
       
        
      
            
            <!-- terminar mostra locais e começa mostra registro -->
            
          
          
           
                <br>
               
              
            </div>
        
       
  	
  		
  	
  	<script>



var usuario = api.auth.get_current_user()


document.getElementById("bemvindo").innerText = "Bem vindo, "+usuario.fullname


</script>
<script>
  const togglePassword = document.querySelector('#togglePassword_1');
  const password = document.querySelector('#senha_atual');
 
  togglePassword.addEventListener('click', function (e) {
    // toggle the type attribute
    const type = password.getAttribute('type') === 'password' ? 'text' : 'password';
    password.setAttribute('type', type);
    // toggle the eye slash icon
    this.classList.toggle('fa-eye-slash');
});

const togglePassword2 = document.querySelector('#togglePassword_2');
  const password2 = document.querySelector('#senha_nova');
 
  togglePassword2.addEventListener('click', function (e) {
    // toggle the type attribute
    const type = password2.getAttribute('type') === 'password' ? 'text' : 'password';
    password2.setAttribute('type', type);
    // toggle the eye slash icon
    this.classList.toggle('fa-eye-slash');
});

const togglePassword3 = document.querySelector('#togglePassword_3');
  const password3 = document.querySelector('#confirmar_senha');
 
  togglePassword3.addEventListener('click', function (e) {
    // toggle the type attribute
    const type = password3.getAttribute('type') === 'password' ? 'text' : 'password';
    password3.setAttribute('type', type);
    // toggle the eye slash icon
    this.classList.toggle('fa-eye-slash');
});
</script>
<script>
    function verifica_senha(){
        var senha_1 = document.getElementById("senha_nova").value
        var senha_2 = document.getElementById("confirmar_senha").value
        
        if (senha_1 != "" && senha_2 != ""){
            if (senha_1 != senha_2){
                document.getElementById("error_senha_nova").innerText = "As senhas não são iguais!"
                document.getElementById("error_confirma_senha").innerText = "As senhas não são iguais!"
            } else {
                document.getElementById("error_senha_nova").innerText = ""
                document.getElementById("error_confirma_senha").innerText = ""
            }
        }
        
    }
</script>
<script>
    function salvar_senha(){
        var senha_atual = document.getElementById("senha_atual").value
        var senha_1 = document.getElementById("senha_nova").value
        var senha_2 = document.getElementById("confirmar_senha").value
        if (senha_1 != "" && senha_2 != ""){
            if (senha_1 != senha_2){
                document.getElementById("error_senha_nova").innerText = "As senhas não são iguais!"
                document.getElementById("error_confirma_senha").innerText = "As senhas não são iguais!"
            } else {
                document.getElementById("error_senha_nova").innerText = ""
                document.getElementById("error_confirma_senha").innerText = ""
                if (senha_atual != ""){
                    var troca_senha = api.users.change_password(usuario._id,senha_atual,senha_1)
                    if (troca_senha.error != undefined){
                        document.getElementById("error_nova_senha").innerText = "Verifique a senha"
                    } else {
                       document.getElementById("error_nova_senha").innerText = "A senha foi alterada com sucesso!" 
                       document.getElementById("senha_atual").value = ""
                       document.getElementById("senha_nova").value = ""
                       document.getElementById("confirmar_senha").value = ""

                    }
                }
            }
        }
        
        
    }
</script>
  
  
  	
  






    </body>

</html>