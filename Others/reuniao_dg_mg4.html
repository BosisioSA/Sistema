<!doctype html>
<html>
    <head>
      <title>Reunião DG</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      
      <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">

      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
      <link rel="stylesheet" href="css/style.css">
      <link rel="stylesheet" href="css/table.css">
        <meta name="viewport" content="width=944">
        <meta name="robots" content="noindex, follow">
	<link rel="Shortcut icon" href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/favicon.ico" type="image/x-icon">
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon.png" rel="apple-touch-icon" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144" />
        <link rel="stylesheet" href="fonts/fontawesome-all.min.css">
        <link rel="stylesheet" href="fonts/font-awesome.min.css">
        <link rel="stylesheet" href="fonts/fontawesome5-overrides.min.css">
        <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
     
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/jscolor.js"></script>
        <script src="js/html-duration-picker.min.js"></script>
          
    
        <script src="/portal.cgi/PP_FILE_STORE/Sistema/assets/js/vendor/modernizr-2.6.2.min.js"></script>
      	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-1.8.3.min.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-ui-1.9.2.custom.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.cookie.js'></script>
    	<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.4.2/chroma.min.js'></script>
    <!-- portal.js -->
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-linedtextarea.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/codemirror.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/javascript.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.tmpl.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-regex.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/sitemapstyler.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/date.format.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.iframe-transport.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.fileupload.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.notify.min.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.event.drag-2.2.js'></script>
        <script type='text/javascript' src='/portal.cgi?api=js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/portal/js/nixps-portal-api.js'></script>
        <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.i18n.js'></script>
         <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/upload/js/upload.js'></script>
      
        <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/upload/js/upload-controller.js'></script>
           <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
        
       
       
     
    </head>


    <body>

  		<div class="wrapper d-flex align-items-stretch">
  			<nav id="sidebar">
  				<div class="p-4 pt-5">
            <img>
  		  		<img src="./logo/logo_valgroup.png" style="width: 90%; margin-bottom: 50px;">
            <ul class="active components mb-5">
              <li  class="active" style="list-style-type: none">
               <a href="ticket_dashboard_mg4.html"><img src="./Icons/ticket_dg.png" width="30px" style="margin-right: 5px;">Dashboard Ticket</a>
              </li>
                   <li  style="list-style-type: none">
               <a href="aberturaticket_mg4.html"><img src="./Icons/entrada_ticket.png" width="30px" style="margin-right: 5px;">Novo Ticket</a>
              </li>
             
            
            <li>
           <a href="#homeSubmenu2" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><img src="./Icons/fornecedores.png" width="30px" style="margin-right: 10px">Reunião DG</a>
           <li class="active" style="list-style-type: none">
               <ul class="collapse list-unstyled" id="homeSubmenu2">
               <li style="list-style-type: none">
               <a href="reuniao_dg_mg4.html"><img src="./Icons/liberado_reuniao.png" width="20px" style="margin-right: 5px;">Pauta</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastro_email_reuniaoDG.html"><img src="./Icons/cadastroemailreuniao.png" width="20px" style="margin-right: 5px;">Cadastro de E-mails</a>
          </li>
          
        </ul>
        </li>
        
                </ul>
                    
       
   
  	        <div class="footer">
  	        	<p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0.
  						  Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib.com</a>
  						   Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
  	        </div>
  	      </div>
      	</nav>

          <!-- Page Content  -->
        <div id="content" class="p-4 p-md-5">

          <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">

              <button type="button" id="sidebarCollapse" class="btn btn-primary">
                <i class="fa fa-bars"></i>
                <span class="sr-only">Toggle Menu</span>
              </button>
              <button class="btn btn-dark d-inline-block d-lg-none ml-auto" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <i class="fa fa-bars"></i>
              </button>
              <div id="bemvindo" style="margin-left: 20px;"></div>

              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav ml-auto">
                 
                  <li class="nav-item">
                      <a class="nav-link" href="alterar_senha.html" target="_Blank">Alterar Senha</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" onclick="logout()">Logout</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
          <div>
     <div  class="form-group" style="display:inline-block; width: 100%;"> 

    
  
 
</div>
    </div>
    <div id="mostra_tabela_prioridade" style="display: inline-block; width: 100%;">         
    <div  style="display: inline-block; width: 100%;">
       <h5 style="display: inline-block;">Pauta da Reunião</h5>
       </div>
       <section style="display: inline-block; width: 8%;"></section>
       <div id="mostra_grupo_reuniao" style="display: none; width: 12%;">
           <label for="o_grupo">Grupo</label>
          <select  class="form-control" id="o_grupo" name="o_grupo">
              <option value="undefined">Selecionar...</option>
              </select>
          </div>
       
       <div id="mostra_data_reuniao" style="display: none; width: 12%;">
           <label for="data_reuniao">Data Reunião</label>
          <input type="date" class="form-control" id="data_reuniao" name="data_reuniao">
          </div>
       <div id="mostra_horainicio_reuniao" style="display: none; width: 12%; margin-left: 2%">
           <label for="hora_reuniao_inicio">Hora Inicio Reunião</label>
          <input type="time" class="form-control" id="hora_reuniao_inicio" name="hora_reuniao_inicio">
          </div>
          <div id="mostra_horafinal_reuniao" style="display: none; width: 12%; margin-left: 2%">
           <label for="hora_reuniao_final">Hora Final Reunião</label>
          <input type="time" class="form-control" id="hora_reuniao_final" name="hora_reuniao_final">
          </div>
          <div id="mostra_local_reuniao" style="display: none; width: 20%; margin-left: 2%">
           <label for="local_reuniao">Local Reunião</label>
          <input type="text" class="form-control" id="local_reuniao" onkeyup="this.value=this.value.toUpperCase()" name="local_reuniao">
          </div>
          
          <div id="mostra_enviar_email" style="display: none; width: 9%;margin-left: 2%;">
           <button id="enviar_email_pauta" onclick="enviar_pauta()" class="btn btn-primary">Enviar Pauta</button>
          </div>
       <div class="input-icons" style="display: none; width: 26%; margin-left: 3%;">
                <i class="fa fa-search icon"></i>
                <input id="filtrarTabelaPrioridade" class="input-field form-control" onkeyup="filtro_tabela_prioridade()" style="width: 100%;border-top-left-radius: 40px;border-top-right-radius: 40px;border-bottom-left-radius: 40px;border-bottom-right-radius: 40px;" type="text"> 
                </div>
        <hr>
        <table id="tabela_prioridades" class="table custom-table" style="display: inline-block">
          <thead>
            <tr>
             
             
              <th class="th-sm" style="width:3%;vertical-align: top;">
              </th>
              <th class="th-sm" style="width:6%;vertical-align: top;">
              </th>
              <th class="th-sm" style="width:15%;vertical-align: top;">Cliente
              </th>
              <th class="th-sm" style="width:25%;vertical-align: top;">Descrição
              </th>
              <th class="th-sm" style="width:6%;vertical-align: top;">Tipo
              </th>
              <th class="th-sm" style="width:16%;vertical-align: top;">Comercial
              </th>
              <th class="th-sm" style="width:13%;vertical-align: top;">Data Liberação
              </th>
              
              
              
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
        <section class="form-group col-md-10" style="display:inline-block; text-align: right;"><span id="texto_sequencia"></span></section>
        
        
        
        <br>
        
       
        <br>
       </div>
         <div id="mostra_tabela_liberado" style="display: inline-block; width: 100%;">  
       <div  style="display: inline-block; width: 70%;">
       <h5 style="display: inline-block;">Tickets Liberados para Reunião</h5>
       </div>
         <div class="input-icons" style="display: inline-block; width: 26%; margin-left: 3%;">
                <i class="fa fa-search icon"></i>
                <input id="filtrarTabelaLiberados" class="input-field form-control" onkeyup="filtro_tabela_liberados()" style="width: 100%;border-top-left-radius: 40px;border-top-right-radius: 40px;border-bottom-left-radius: 40px;border-bottom-right-radius: 40px;" type="text"> 
                </div>
     
       <hr>
        <table id="tabela_liberados" class="table custom-table" style="display: inline-block">
          <thead>
            <tr>
             
             
             
             
              <th class="th-sm" style="width:3%;vertical-align: top;">
              </th>
              <th class="th-sm" style="width:15%;vertical-align: top;">Cliente
              </th>
              <th class="th-sm" style="width:30%;vertical-align: top;">Descrição
              </th>
              <th class="th-sm" style="width:11%;vertical-align: top;">Tipo
              </th>
              <th class="th-sm" style="width:16%;vertical-align: top;">Comercial
              </th>
              <th class="th-sm" style="width:10%;vertical-align: top;">Data Criação
              </th>
              <th class="th-sm" style="width:15%;vertical-align: top;">Colocar em Pauta
              </th>
              
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
         <section class="form-group col-md-10" style="display:inline-block;"></section>
        <button id="botao_priorizar2" style="display: none;" class="btn btn-primary" onclick="fazer_pauta()">Colocar em Pauta</button>
        <button id="botao_priorizar3" style="display: none;" class="btn btn-primary" onclick="despriorizar()">Colocar em Aguardando</button>
       
        
        
        
        
        
       </div>
       <div id="mostra_tabela_aguardando" style="display: inline-block; width: 100%;">  
       <div  style="display: inline-block; width: 70%;">
       <h5 style="display: inline-block;">Tickets Aguardando Reunião</h5>
       </div>
         <div class="input-icons" style="display: inline-block; width: 26%; margin-left: 3%;">
                <i class="fa fa-search icon"></i>
                <input id="filtrarTabelaAguardando" class="input-field form-control" onkeyup="filtro_tabela_aguardando()" style="width: 100%;border-top-left-radius: 40px;border-top-right-radius: 40px;border-bottom-left-radius: 40px;border-bottom-right-radius: 40px;" type="text"> 
                </div>
     
       <hr>
        <table id="tabela_aguardando" class="table custom-table" style="display: inline-block">
          <thead>
            <tr>
             
             
             
             
              <th class="th-sm" style="width:3%;vertical-align: top;">
              </th>
              <th class="th-sm" style="width:15%;vertical-align: top;">Cliente
              </th>
              <th class="th-sm" style="width:30%;vertical-align: top;">Descrição
              </th>
              <th class="th-sm" style="width:11%;vertical-align: top;">Tipo
              </th>
              <th class="th-sm" style="width:16%;vertical-align: top;">Comercial
              </th>
              <th class="th-sm" style="width:10%;vertical-align: top;">Data Criação
              </th>
              <th class="th-sm" style="width:15%;vertical-align: top;">Liberar para Reunião
              </th>
              
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
         <section class="form-group col-md-10" style="display:inline-block;"></section>
        <button id="botao_liberar" style="display: none;" class="btn btn-primary" onclick="fazer_priorizacao()">Liberar para Reunião</button>
       
        
        
        
        
        
       </div>
              
            </div>
        
       
  	
  		
   <script src="js/popper.js"></script>
  <script src="js/main.js"></script>	
  		
  	<script>
  	    // funcoes de apoio
  	    
  	    var usuario = api.auth.get_current_user()
  	    
  	    document.getElementById("bemvindo").innerText = "Bem vindo, "+usuario.fullname
  	 //   document.getElementById("data_entrega").value = "02:00"
  	    
      function clearTable(table) {
  var rows = table.rows;
  var i = rows.length;
  while (--i) {
    rows[i].parentNode.removeChild(rows[i]);
    // or
    // table.deleteRow(i);
  }
}

function onlyUnique(value, index, self) {
  return self.indexOf(value) === index;
}

function cmyk2rgb(c, m, y, k, normalized){
    c = (c / 100);
    m = (m / 100);
    y = (y / 100);
    k = (k / 100);
    
    c = c * (1 - k) + k;
    m = m * (1 - k) + k;
    y = y * (1 - k) + k;
    
    var r = 1 - c;
    var g = 1 - m;
    var b = 1 - y;
    
    if(!normalized){
        r = Math.round(255 * r);
        g = Math.round(255 * g);
        b = Math.round(255 * b);
    }
    
    return {
        r: r,
        g: g,
        b: b
    }
}

function rgb2cmyk(r, g, b, normalized){
    var c = 1 - (r / 255);
    var m = 1 - (g / 255);
    var y = 1 - (b / 255);
    var k = Math.min(c, Math.min(m, y));
    
    c = (c - k) / (1 - k);
    m = (m - k) / (1 - k);
    y = (y - k) / (1 - k);
    
    if(!normalized){
        c = Math.round(c * 10000) / 100;
        m = Math.round(m * 10000) / 100;
        y = Math.round(y * 10000) / 100;
        k = Math.round(k * 10000) / 100;
    }
    
    c = isNaN(c) ? 0 : c;
    m = isNaN(m) ? 0 : m;
    y = isNaN(y) ? 0 : y;
    k = isNaN(k) ? 0 : k;
    
    return {
        c: c,
        m: m,
        y: y,
        k: k
    }
}



function msToTime(s) {
  var ms = s % 1000;
  s = (s - ms) / 1000;
  var secs = s % 60;
  s = (s - secs) / 60;
  var mins = s % 60;
  var hrs = (s - mins) / 60;

  return hrs + ':' + mins + ':' + secs + '.' + ms;
}

function componentToHex(c) {
  var hex = c.toString(16);
  return hex.length == 1 ? "0" + hex : hex;
}

function rgbToHex(r, g, b) {
  return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
}



 function array_move(arr, old_index, new_index) {
    if (new_index >= arr.length) {
        var k = new_index - arr.length + 1;
        while (k--) {
            arr.push(undefined);
        }
    }
    arr.splice(new_index, 0, arr.splice(old_index, 1)[0]);
    return arr; // for testing
};


// preenche dados se existe ordem

if (usuario.scope_name != undefined){
    var nome_scope = usuario.scope_name[0].split("_")
   
}

// preenche selects

selectFornecedor = document.getElementById('o_grupo');
    var tiposFornecedor = api.custom_objects.list_with_options("BR-VALFI_emails_reuniaoDG",[],["grupo","ascending"],[]).results
   for (var i = 0; i<tiposFornecedor.length; i++){
      var opt = document.createElement('option');
       opt.value = tiposFornecedor[i].grupo;
        opt.innerHTML = tiposFornecedor[i].grupo;
       selectFornecedor.appendChild(opt);
    }
   
         
// preenche data de hoje

var hoje = new Date()

  	</script>
  	
  	<script>
  	    
  	   // captura todos os tickets de uma vez
  	   
  	    var busca_todos_tickets = api.custom_objects.list_with_options("BR-VALFI_Tickets",["reuniaodg_finalizado","equal to",false]).results
  	   
  	  
        
  	    var lista_prioridades = []
  	    var lista_aguardando = []
  	    var lista_liberados = []
  	     for (i=0;i<busca_todos_tickets.length;i++){
  	         if (busca_todos_tickets[i].info_reuniao === undefined){
  	         if (busca_todos_tickets[i].pauta_reuniao === true){
        lista_prioridades.push(busca_todos_tickets[i])
  	         }
  	      if (busca_todos_tickets[i].liberado_reuniao === false){
        lista_aguardando.push(busca_todos_tickets[i])
  	         }
  	      if (busca_todos_tickets[i].pauta_reuniao === false && busca_todos_tickets[i].liberado_reuniao === true ){
        lista_liberados.push(busca_todos_tickets[i])
  	         }
  	         }
  	      
    }
    
  if (lista_prioridades.length > 0){
      document.getElementById("mostra_data_reuniao").style.display = "inline-block"
      document.getElementById("mostra_horainicio_reuniao").style.display = "inline-block"
      document.getElementById("mostra_horafinal_reuniao").style.display = "inline-block"
      document.getElementById("mostra_local_reuniao").style.display = "inline-block"
      document.getElementById("mostra_grupo_reuniao").style.display = "inline-block"
      
      document.getElementById("mostra_enviar_email").style.display = "inline-block"
      if (lista_prioridades[0].data_reuniao != undefined){
          for (i=1;i<lista_prioridades.length;i++){
              if (lista_prioridades[i].data_reuniao === undefined){
                  api.custom_objects.set_keys("BR-VALFI_Tickets",lista_prioridades[i]._id,{"data_reuniao":lista_prioridades[0].data_reuniao})
                  lista_prioridades[i]["data_reuniao"] = lista_prioridades[0].data_reuniao
              }
          }
          var data_reuniao_base = new Date(lista_prioridades[0].data_reuniao.data_reuniao)
          document.getElementById("data_reuniao").value = dateFormat(data_reuniao_base,"yyyy-mm-dd")
          document.getElementById("hora_reuniao_inicio").value = lista_prioridades[0].data_reuniao.hora_inicio_reuniao
          document.getElementById("hora_reuniao_final").value = lista_prioridades[0].data_reuniao.hora_final_reuniao
          document.getElementById("local_reuniao").value = lista_prioridades[0].data_reuniao.local_reuniao
          if (lista_prioridades[0].data_reuniao.grupo != undefined){
          document.getElementById("o_grupo").value = lista_prioridades[0].data_reuniao.grupo
          }
          
      }
  }
        
  	</script>
  	
  	
  	
  	
  	
   <script>
       function salva_ticket(){
           var data = {}
            data["tipo_trabalho"] = document.getElementById("tipo_trabalho").value
            data["criado_em"] = new Date()
            data["criado_por"] = usuario
            var info_arte = {}
            info_arte["codigo"] = document.getElementById("codigo_arte").value
            info_arte["revisao"] = document.getElementById("arte_revisao").value
            info_arte["evolucao"] = document.getElementById("arte_evolucao").value
            data["info_arte"] = info_arte
            data["cliente"] = document.getElementById("cliente").value
            data["responsavel_comercial"] = document.getElementById("responsavel_comercial").value
            data["descricao"] = document.getElementById("descricao").value
            data["item"] = document.getElementById("item").value
            data["item_referencia"] = document.getElementById("item_referencia").value
            data["priorizado"] = false
            data["arte_iniciado"] = false
            data["arte_finalizado"] = false
            data["ticket_dg"] = document.getElementById("numero_ticket").value
            var info_checklist = {}
            info_checklist["Arte OK"] = document.getElementById("Arte OK").checked
            info_checklist["Referencia de Cor"] = document.getElementById("Referencia de Cor").checked
            info_checklist["Especificacao"] = document.getElementById("Especificacao").checked
            data["checklist_entrada"] = info_checklist
            console.log(data)
            var info_observa = {}
            info_observa["quem"] = usuario
            info_observa["quando"] = new Date()
            info_observa["texto"] = document.getElementById("observacoes").value
            var as_observacoes = []
            as_observacoes.push(info_observa)
            data["observacoes"] = as_observacoes
            
            
            //api.custom_objects.create("BR-VALFI_Tickets",data)
           
           // document.getElementById("info_ticket").innerText = "Ticket criado com sucesso!"
            
           setTimeout(function(){document.getElementById("info_ticket").innerText = ""}, 3000);
       }
       
      
   </script>

<script>
    //<------- AQUI COMECAM AS FUNCOES DAS TABELAS --------->
    
       function preenche_aguardando(){
  	        
  	     clearTable(document.getElementById("tabela_aguardando"))
  	     
  	    
         
       //  var busca_tickets = api.custom_objects.list_with_options("BR-VALFI_Tickets",["priorizado","equal to",false,"and","liberado_priorizar","equal to",true],listar_por).results
          
         var table = document.getElementById("tabela_aguardando")
        var qtasrow = table.rows.length
      
            
            for (i=0;i<lista_aguardando.length;i++){
            var row =  table.insertRow(qtasrow);
            
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
            var cell6 = row.insertCell(5);
            var cell7 = row.insertCell(6);
               
          
           var a_data = dateFormat(lista_aguardando[i].criado_em,"dd/mm/yyyy")
            
            var cor_arte = "red"
            
            
            var complex = lista_aguardando[i].complexidade
            if (complex.indexOf(":") > -1){
                var complex_array = complex.split(":")
                if (complex_array[1] === "00"){
                  var numero_horas = parseInt(complex_array[0])  
                } else {
                    var minutos = (parseInt(complex_array[1]))/60
                    var horas = parseInt(complex_array[0]) 
                    var numero_horas = horas+minutos
                }
                
            } else {
                var numero_horas = parseInt(lista_aguardando[i].complexidade)
            }
            if (numero_horas <= 5){
                cor_arte = "orange"
            }
            if (numero_horas <= 3){
                cor_arte = "#00FF00"
            }
            if (numero_horas > 24){
                cor_arte = "violet"
            }
            
            console.log("numero_horas")
            console.log(numero_horas)
            console.log(cor_arte)
           
            
            cell1.innerHTML = '<div style="font-size:1em;"><span style="margin-top:5px;height:10px;width:10px;background-color:'+cor_arte+';border-radius:50%;display:inline-block"></span></div>'
           
            cell2.innerHTML = '<div style="font-size:1em;">'+lista_aguardando[i].cliente+'</div>'
            cell3.innerHTML = '<div style="font-size:1em;">'+lista_aguardando[i].descricao+'</div>'
            cell4.innerHTML = '<div style="font-size:1em;">'+lista_aguardando[i].tipo_trabalho+'</div>'
            cell5.innerHTML = '<div style="font-size:1em;">'+lista_aguardando[i].responsavel_comercial+'</div>'
            cell6.innerHTML = '<div style="font-size:1em;">'+a_data+'hs</div>'
            cell7.innerHTML = '<div style="font-size:1em; cursor: pointer"><img src="./Icons/prioriza_off.png" width="20px" id="'+lista_aguardando[i]._id+'" onclick="priorizar()"></div>'
            
            qtasrow = qtasrow +1
            
        //       var table = document.getElementById("tabela_aguardando")
         //    var qtasrow = table.rows.length
         //   var link_proofscope = ""
         //   var icone_ospg = "./Icons/ospg.png"
            
         //   var preview_icon = "./Icons/aguardando_arquivos.png"
            
         //   if (lista_aguardando[i].pacote_grafico != undefined){
          //      preview_icon = lista_aguardando[i].pacote_grafico.preview
        //        link_proofscope = lista_aguardando[i].pacote_grafico.proofscope
         //          }
            
         
            
          
            
          
          //  var row2 =  table.insertRow(qtasrow);
    //        var cell1_2 = row2.insertCell(0);
      //      cell1_2.colSpan = 9
    //        cell1_2.style = "background-color: lightgray"
      //      cell1_2.style = "display: none;"
    //        var string_div = '<div style="width: 100%; display:inline-block; vertical-align: top; padding-top: 5px;">'
            // primeira coluna
            
      //      string_div = string_div+'<div style="width: 15%; display: inline-block; vertical-align: top;">'
    //        string_div = string_div+'<a style="cursor:pointer;" href='+link_proofscope+' target="_Blank"><img src="'+preview_icon+'" width="70%" style="margin: auto;"></a></div>'
            
            // segunda coluna
      //      string_div = string_div+'<div style="width:82%; margin-left: 2%; display: inline-block;">'
    //        string_div = string_div+'<div style="width: 40%; display: inline-block; vertical-align: top">'
      //      string_div = string_div+'<div style="width: 48%; display: inline-block; vertical-align: top">'
    //        string_div = string_div+'<p style="text-align: left; font-size: 1em">Código de arte: <strong>'+lista_aguardando[i].codigo_arte+'</strong><br>'
     //       string_div = string_div+'<p style="text-align: left; font-size: 1em">Item Referencia: <strong>'+lista_aguardando[i].item_referencia+'</strong><br></div>'
      //      string_div = string_div+'<div style="width: 48%; display: inline-block; vertical-align: top">'
    //        string_div = string_div+'<p style="text-align: left; font-size: 1em">Item: <strong>'+lista_aguardando[i].item+'</strong><br>'
     //       string_div = string_div+'<p style="text-align: left; font-size: 1em">Ticket DG: <strong>'+lista_aguardando[i].ticket_DG+'</strong><br></div></div>'
            
     //       string_div = string_div+'<div style="width: 55%; display: inline-block; vertical-align: top">'
      //      string_div = string_div+'<div style="width: 30%; display: inline-block; vertical-align: center">'
    //        string_div = string_div+'<p style="text-align: left; font-size: 1em"><br></div>'
     //       string_div = string_div+'<div style="width: 30%; display: inline-block; vertical-align: center; margin-left: 2%; padding-left: 9%">'
      //      string_div = string_div+'<p style="text-align: left; font-size: 1em"></div>'
    //        string_div = string_div+'<div style="width: 30%; display: inline-block; vertical-align: center; margin-left: 2%">'
     //       string_div = string_div+'</div></div>'
      //      string_div = string_div+'<div style="width: 100%; display: inline-block; margin-left: 2%; vertical-align: top">'
            
    //        var theobserva = lista_aguardando[i].observacoes
            
     //       string_div = string_div+'<div style="width: 10%;display: inline-block; border-bottom: 1px solid black; text-align: center">Data</div>'
     //       string_div = string_div+'<div style="width: 20%;display: inline-block; border-bottom: 1px solid black; text-align: center">Usuário</div>'
     //       string_div = string_div+'<div style="width: 70%;display: inline-block; border-bottom: 1px solid black; text-align: center">Observação</div>'
           
           
       //     for (y=0;y<theobserva.length;y++){
    //        string_div = string_div+'<div style="width: 10%;display: inline-block; text-align: center">'+dateFormat(new Date(theobserva[y].quando),"dd/mm/yyyy")+'</div>'
     //       string_div = string_div+'<div style="width: 20%;display: inline-block; text-align: center">'+theobserva[y].quem.fullname+'</div>'
      //      string_div = string_div+'<div style="width: 70%;display: inline-block; text-align: center">'+theobserva[y].texto+'</div>'
           
                
                
                
        //    }
           
            
          //  string_div = string_div+'</div></div>'
        //    cell1_2.innerHTML = string_div
            
          //  qtasrow = qtasrow +1
      
      
        
        
    }
  	   
  	  preenche_liberados()
  	    }
  	    
  	    var array_prioriza = []
  	    
  	 	 function priorizar(){
  	     var linha = event.srcElement.id
  	     console.log(linha)
  	     if (array_prioriza.indexOf(linha) === -1){
  	    // console.log("vou alterar")
  	     document.getElementById(linha).src = "./Icons/prioriza_on.png"
  	     array_prioriza.push(linha)
  	     } else {
  	        for (i=0;i<array_prioriza.length;i++){
  	            if (array_prioriza[i] === linha){
  	                var tira = array_prioriza.splice(i,1)
  	            }
  	        }
  	       document.getElementById(linha).src = "./Icons/prioriza_off.png"  
  	     }
  	     if (array_prioriza.length > 0){
  	         document.getElementById("botao_liberar").style = "display: inline-block;cursor: pointer; margin-left: 9%;" 
  	     } else {
  	        document.getElementById("botao_liberar").style  = "display: none;" 
  	     }
  	     
  	 	 }
  	 	 
  	function fazer_priorizacao(){
  	    
  	    for (i=0;i<array_prioriza.length;i++){
  	    api.custom_objects.set_keys("BR-VALFI_Tickets",array_prioriza[i],{"liberado_reuniao": true})
  	    for (j=0;j<lista_aguardando.length;j++){
  	    if (lista_aguardando[j]._id == array_prioriza[i]){
  	        lista_liberados.push(lista_aguardando[j])
  	        var tira = lista_aguardando.splice(j,1)
  	        
  	    }
  	}
  	  	}
  	
  	setTimeout(function(){document.getElementById("botao_liberar").style  = "display: none;"}, 2000);
  
  	 array_prioriza = []  
  	 preenche_liberados()
  	}        
  	     
  	  function preenche_liberados(){
  	        
  	     clearTable(document.getElementById("tabela_liberados"))
  	     
  	    
         
       //  var busca_tickets = api.custom_objects.list_with_options("BR-VALFI_Tickets",["priorizado","equal to",false,"and","liberado_priorizar","equal to",true],listar_por).results
          
         var table = document.getElementById("tabela_liberados")
        var qtasrow = table.rows.length
      
            
            for (i=0;i<lista_liberados.length;i++){
            var row =  table.insertRow(qtasrow);
            
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
            var cell6 = row.insertCell(5);
            var cell7 = row.insertCell(6);
            
          
           var a_data = dateFormat(lista_liberados[i].criado_em,"dd/mm/yyyy")
            
            var cor_arte = "red"
            
            
            var complex = lista_liberados[i].complexidade
            if (complex.indexOf(":") > -1){
                var complex_array = complex.split(":")
                if (complex_array[1] === "00"){
                  var numero_horas = parseInt(complex_array[0])  
                } else {
                    var minutos = (parseInt(complex_array[1]))/60
                    var horas = parseInt(complex_array[0]) 
                    var numero_horas = horas+minutos
                }
                
            } else {
                var numero_horas = parseInt(lista_liberados[i].complexidade)
            }
            if (numero_horas <= 5){
                cor_arte = "orange"
            }
            if (numero_horas <= 3){
                cor_arte = "#00FF00"
            }
            if (numero_horas > 24){
                cor_arte = "violet"
            }
            
            console.log("numero_horas")
            console.log(numero_horas)
            console.log(cor_arte)
           
            
            cell1.innerHTML = '<div style="font-size:1em;"><span style="margin-top:5px;height:10px;width:10px;background-color:'+cor_arte+';border-radius:50%;display:inline-block"></span></div>'
           
            cell2.innerHTML = '<div style="font-size:1em;">'+lista_liberados[i].cliente+'</div>'
            cell3.innerHTML = '<div style="font-size:1em;">'+lista_liberados[i].descricao+'</div>'
            cell4.innerHTML = '<div style="font-size:1em;">'+lista_liberados[i].tipo_trabalho+'</div>'
            cell5.innerHTML = '<div style="font-size:1em;">'+lista_liberados[i].responsavel_comercial+'</div>'
            cell6.innerHTML = '<div style="font-size:1em;">'+a_data+'hs</div>'
            cell7.innerHTML = '<div style="font-size:1em; cursor: pointer"><img src="./Icons/prioriza_off.png" width="20px" id="'+lista_liberados[i]._id+'" onclick="priorizar2()"></div>'
            
            qtasrow = qtasrow +1
            
        //       var table = document.getElementById("tabela_aguardando")
         //    var qtasrow = table.rows.length
         //   var link_proofscope = ""
         //   var icone_ospg = "./Icons/ospg.png"
            
         //   var preview_icon = "./Icons/aguardando_arquivos.png"
            
         //   if (lista_aguardando[i].pacote_grafico != undefined){
          //      preview_icon = lista_aguardando[i].pacote_grafico.preview
        //        link_proofscope = lista_aguardando[i].pacote_grafico.proofscope
         //          }
            
         
            
          
            
          
          //  var row2 =  table.insertRow(qtasrow);
    //        var cell1_2 = row2.insertCell(0);
      //      cell1_2.colSpan = 9
    //        cell1_2.style = "background-color: lightgray"
      //      cell1_2.style = "display: none;"
    //        var string_div = '<div style="width: 100%; display:inline-block; vertical-align: top; padding-top: 5px;">'
            // primeira coluna
            
      //      string_div = string_div+'<div style="width: 15%; display: inline-block; vertical-align: top;">'
    //        string_div = string_div+'<a style="cursor:pointer;" href='+link_proofscope+' target="_Blank"><img src="'+preview_icon+'" width="70%" style="margin: auto;"></a></div>'
            
            // segunda coluna
      //      string_div = string_div+'<div style="width:82%; margin-left: 2%; display: inline-block;">'
    //        string_div = string_div+'<div style="width: 40%; display: inline-block; vertical-align: top">'
      //      string_div = string_div+'<div style="width: 48%; display: inline-block; vertical-align: top">'
    //        string_div = string_div+'<p style="text-align: left; font-size: 1em">Código de arte: <strong>'+lista_aguardando[i].codigo_arte+'</strong><br>'
     //       string_div = string_div+'<p style="text-align: left; font-size: 1em">Item Referencia: <strong>'+lista_aguardando[i].item_referencia+'</strong><br></div>'
      //      string_div = string_div+'<div style="width: 48%; display: inline-block; vertical-align: top">'
    //        string_div = string_div+'<p style="text-align: left; font-size: 1em">Item: <strong>'+lista_aguardando[i].item+'</strong><br>'
     //       string_div = string_div+'<p style="text-align: left; font-size: 1em">Ticket DG: <strong>'+lista_aguardando[i].ticket_DG+'</strong><br></div></div>'
            
     //       string_div = string_div+'<div style="width: 55%; display: inline-block; vertical-align: top">'
      //      string_div = string_div+'<div style="width: 30%; display: inline-block; vertical-align: center">'
    //        string_div = string_div+'<p style="text-align: left; font-size: 1em"><br></div>'
     //       string_div = string_div+'<div style="width: 30%; display: inline-block; vertical-align: center; margin-left: 2%; padding-left: 9%">'
      //      string_div = string_div+'<p style="text-align: left; font-size: 1em"></div>'
    //        string_div = string_div+'<div style="width: 30%; display: inline-block; vertical-align: center; margin-left: 2%">'
     //       string_div = string_div+'</div></div>'
      //      string_div = string_div+'<div style="width: 100%; display: inline-block; margin-left: 2%; vertical-align: top">'
            
    //        var theobserva = lista_aguardando[i].observacoes
            
     //       string_div = string_div+'<div style="width: 10%;display: inline-block; border-bottom: 1px solid black; text-align: center">Data</div>'
     //       string_div = string_div+'<div style="width: 20%;display: inline-block; border-bottom: 1px solid black; text-align: center">Usuário</div>'
     //       string_div = string_div+'<div style="width: 70%;display: inline-block; border-bottom: 1px solid black; text-align: center">Observação</div>'
           
           
       //     for (y=0;y<theobserva.length;y++){
    //        string_div = string_div+'<div style="width: 10%;display: inline-block; text-align: center">'+dateFormat(new Date(theobserva[y].quando),"dd/mm/yyyy")+'</div>'
     //       string_div = string_div+'<div style="width: 20%;display: inline-block; text-align: center">'+theobserva[y].quem.fullname+'</div>'
      //      string_div = string_div+'<div style="width: 70%;display: inline-block; text-align: center">'+theobserva[y].texto+'</div>'
           
                
                
                
        //    }
           
            
          //  string_div = string_div+'</div></div>'
        //    cell1_2.innerHTML = string_div
            
          //  qtasrow = qtasrow +1
      
      
        
        
    }
  	   
  	  preenche_prioridades()
  	    }
  	    
  	    
  	var array_prioriza2 = []
  	    
  	 	 function priorizar2(){
  	     var linha = event.srcElement.id
  	     console.log(linha)
  	     if (array_prioriza2.indexOf(linha) === -1){
  	    // console.log("vou alterar")
  	     document.getElementById(linha).src = "./Icons/prioriza_on.png"
  	     array_prioriza2.push(linha)
  	     } else {
  	        for (i=0;i<array_prioriza2.length;i++){
  	            if (array_prioriza2[i] === linha){
  	                var tira = array_prioriza2.splice(i,1)
  	            }
  	        }
  	       document.getElementById(linha).src = "./Icons/prioriza_off.png"  
  	     }
  	     if (array_prioriza2.length > 0){
  	         document.getElementById("botao_priorizar2").style = "display: inline-block;cursor: pointer; margin-left: 9%;"
  	         document.getElementById("botao_priorizar3").style = "display: inline-block;cursor: pointer; margin-left: 9%;"
  	     } else {
  	        document.getElementById("botao_priorizar2").style  = "display: none;" 
  	     document.getElementById("botao_priorizar3").style  = "display: none;" 
  	     }
  	     
  	 	 }
  	 	 
  	function fazer_pauta(){
  	    
  	    for (i=0;i<array_prioriza2.length;i++){
  	    api.custom_objects.set_keys("BR-VALFI_Tickets",array_prioriza2[i],{"pauta_reuniao": true})
  	    for (j=0;j<lista_liberados.length;j++){
  	    if (lista_liberados[j]._id == array_prioriza2[i]){
  	        lista_prioridades.push(lista_aguardando[j])
  	        var tira = lista_liberados.splice(j,1)
  	       
  	    }
  	}
  	  
  	}
  	document.getElementById("mostra_data_reuniao").style.display = "inline-block"
  	document.getElementById("mostra_enviar_email").style.display = "inline-block"
  	
  		setTimeout(function(){document.getElementById("botao_priorizar2").style  = "display: none;";
  		                    document.getElementById("botao_priorizar3").style  = "display: none;";
  		                    }, 2000);
  
  	 array_prioriza2 = []  
  	 preenche_liberados()
  	}  
  	
  		 
  	function despriorizar(){
  	    
  	    for (i=0;i<array_prioriza2.length;i++){
  	    api.custom_objects.set_keys("BR-VALFI_Tickets",array_prioriza2[i],{"liberado_reuniao": false})
  	    for (j=0;j<lista_liberados.length;j++){
  	    if (lista_liberados[j]._id == array_prioriza2[i]){
  	        lista_aguardando.push(lista_liberados[j])
  	        var tira = lista_liberados.splice(j,1)
  	       
  	    }
  	}
  	  
  	}
  			setTimeout(function(){document.getElementById("botao_priorizar2").style  = "display: none;";
  		                    document.getElementById("botao_priorizar3").style  = "display: none;";
  		                    }, 2000);
  	
  	 array_prioriza2 = []  
  	 preenche_aguardando()
  	}  
  	 
  	 function enviar_pauta(){
  	     
  	     var campos_ok = true
  	     
  	     if (document.getElementById("data_reuniao").value == ""){
  	         document.getElementById('data_reuniao').style.borderColor = "red"
  	         campos_ok = false
  	     }
  	     if (document.getElementById("hora_reuniao_inicio").value == ""){
  	         document.getElementById('hora_reuniao_inicio').style.borderColor = "red"
  	         campos_ok = false
  	     }
  	     if (document.getElementById("hora_reuniao_final").value == ""){
  	         document.getElementById('hora_reuniao_final').style.borderColor = "red"
  	         campos_ok = false
  	     }
  	     if (document.getElementById("local_reuniao").value == ""){
  	         document.getElementById('local_reuniao').style.borderColor = "red"
  	         campos_ok = false
  	     }
  	      if (document.getElementById("o_grupo").value == "undefined"){
  	         document.getElementById('o_grupo').style.borderColor = "red"
  	         campos_ok = false
  	     }
  	     
  	     if (campos_ok === false){
  	         alert("Verificar Campos antes de enviar a pauta")
  	     } else {
  	         var data = {}
  	         data["data_reuniao"] = new Date(document.getElementById('data_reuniao').value)
  	         data["hora_inicio_reuniao"] = document.getElementById('hora_reuniao_inicio').value
  	         data["hora_final_reuniao"] = document.getElementById('hora_reuniao_final').value
  	         data["local_reuniao"] = document.getElementById('local_reuniao').value
  	         data["grupo"] = document.getElementById("o_grupo").value
  	         console.log(data)
  	          document.getElementById('data_reuniao').style.borderColor = "#236423"
  	          document.getElementById('hora_reuniao_inicio').style.borderColor = "#236423"
  	            document.getElementById('hora_reuniao_final').style.borderColor = "#236423"
  	            document.getElementById('local_reuniao').style.borderColor = "#236423"
  	            document.getElementById('o_grupo').style.borderColor = "#236423"
  	            
  	            for (i=0;i<lista_prioridades.length;i++){
            lista_prioridades[i].data_reuniao = data
        }
  	            
  	              var cria_cliente = api.hub.start_from_whitepaper_with_variables("BR-VALFI_tickets","email_reuniaodg",{"info":lista_prioridades,"usuario":usuario,"data_reuniao": data,"grupo":document.getElementById("o_grupo").value})
        console.log(cria_cliente)
        
        
  	        
  	     }
  	     
  	 }

</script>



<script>
    
    // preenche Counts 
    
    
    
    
     function preenche_prioridades(){
  	        
  	     clearTable(document.getElementById("tabela_prioridades"))
  	     
  	     
  	     
         var table = document.getElementById("tabela_prioridades")
        var qtasrow = table.rows.length
      
            
            for (i=0;i<lista_prioridades.length;i++){
            var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
            var cell6 = row.insertCell(5);
            var cell7 = row.insertCell(6);
           
           
          
           var a_data = dateFormat(lista_prioridades[i].criado_em,"dd/mm/yyyy")
           
           
                var complex = lista_prioridades[i].complexidade
           // console.log(complex)
            if (complex.indexOf(":") > -1){
                var complex_array = complex.split(":")
                console.log(complex_array[0])
                console.log(complex_array[1])
                if (complex_array[1] === "00"){
                  var numero_horas = parseInt(complex_array[0])  
                } else {
                    var minutos = (parseInt(complex_array[1]))/60
                    var horas = parseInt(complex_array[0]) 
                    var numero_horas = horas+minutos
                }
                
            } else {
                var numero_horas = parseInt(lista_prioridades[i].complexidade)
            }
           
           
           
            var cor_arte = "#00FF00"
            if (numero_horas > 3 ){
                cor_arte = "orange"
            }
            if (numero_horas > 6){
                cor_arte = "red"
            }
            
           
            
            cell1.innerHTML = '<div style="font-size:1em;"><span style="margin-top:5px;height:10px;width:10px;background-color:'+cor_arte+';border-radius:50%;display:inline-block"></span></div>'
            cell2.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: left;"><span style="display:inline-block; margin-right: 5px;"><img id="'+qtasrow+'" src="./Icons/showinfo.png" height="20px" id="showinfo_'+lista_prioridades[i]._id+'" onclick="mostraDisclosure()" ></span></div>'
           
            cell3.innerHTML = '<div style="font-size:1em;">'+lista_prioridades[i].cliente+'</div>'
            cell4.innerHTML = '<div style="font-size:1em; text-align: left;">'+lista_prioridades[i].descricao+'</div>'
            cell5.innerHTML = '<div style="font-size:1em;">'+lista_prioridades[i].tipo_trabalho+'</div>'
            cell6.innerHTML = '<div style="font-size:1em;">'+lista_prioridades[i].responsavel_comercial+'</div>'
            
            cell7.innerHTML = '<div style="font-size:1em;">'+a_data+'</div>'
            
            qtasrow = qtasrow +1
      
      
             var table = document.getElementById("tabela_prioridades")
             var qtasrow = table.rows.length
            var link_proofscope = ""
            var icone_ospg = "./Icons/ospg.png"
            
            var preview_icon = "./Icons/aguardando_arquivos.png"
            
            if (lista_prioridades[i].pacote_grafico != undefined){
                console.log("estou na lista!")
                preview_icon = lista_prioridades[i].pacote_grafico.preview
                link_proofscope = lista_prioridades[i].pacote_grafico.proofscope
                
            }
            
            
          
             var row2 =  table.insertRow(qtasrow);
            var cell1_2 = row2.insertCell(0);
            cell1_2.colSpan = 9
            cell1_2.style = "background-color: lightgray"
            cell1_2.style = "display: none;"
            var string_div = '<div style="width: 100%; display:inline-block; vertical-align: top; padding-top: 5px;">'
            // primeira coluna
            
            string_div = string_div+'<div style="width: 15%; display: inline-block; vertical-align: top;"><br>'
            string_div = string_div+'<a style="cursor:pointer;" href='+link_proofscope+' target="_Blank"><img src="'+preview_icon+'" width="70%" style="margin: auto;"></a></div>'
            
            // segunda coluna
            string_div = string_div+'<div style="width:82%; margin-left: 2%; display: inline-block;">'
            string_div = string_div+'<div style="width: 40%; display: inline-block; vertical-align: top">'
            string_div = string_div+'<div style="width: 48%; display: inline-block; vertical-align: top">'
            string_div = string_div+'<p style="text-align: left; font-size: 1em">Código de arte: <strong>'+lista_prioridades[i].codigo_arte+'</strong><br>'
            string_div = string_div+'<p style="text-align: left; font-size: 1em">Item Referncia: <strong>'+lista_prioridades[i].item_referencia+'</strong><br></div>'
            string_div = string_div+'<div style="width: 48%; display: inline-block; vertical-align: top">'
            string_div = string_div+'<p style="text-align: left; font-size: 1em">Item: <strong>'+lista_prioridades[i].item+'</strong><br>'
            string_div = string_div+'<p style="text-align: left; font-size: 1em">Ticket DG: <strong>'+lista_prioridades[i].ticket_DG+'</strong><br></div></div>'
            
            string_div = string_div+'<div style="width: 55%; display: inline-block; vertical-align: top">'
            string_div = string_div+'<div style="width: 30%; display: inline-block; vertical-align: center">'
            string_div = string_div+'</div>'
            string_div = string_div+'<div style="width: 30%; display: inline-block; vertical-align: center; margin-left: 2%; padding-left: 9%">'
            string_div = string_div+'<p style="text-align: left; font-size: 1em"><a href="editar_ospg_reuniao.html?ordem='+lista_prioridades[i]._id+'"><img src="'+icone_ospg+'" width="25px"></a><span><strong> OSPG</strong></span></div>'
            string_div = string_div+'<div style="width: 30%; display: inline-block; vertical-align: center; margin-left: 2%">'
            string_div = string_div+'</div></div>'
            string_div = string_div+'<div style="width: 100%; display: inline-block; margin-left: 2%; vertical-align: top">'
            
            var theobserva = lista_prioridades[i].observacoes
            
            string_div = string_div+'<div style="width: 10%;display: inline-block; border-bottom: 1px solid black; text-align: center">Data</div>'
            string_div = string_div+'<div style="width: 20%;display: inline-block; border-bottom: 1px solid black; text-align: center">Usuário</div>'
            string_div = string_div+'<div style="width: 70%;display: inline-block; border-bottom: 1px solid black; text-align: center">Observação</div>'
           
           
            for (y=0;y<theobserva.length;y++){
            string_div = string_div+'<div style="width: 10%;display: inline-block; text-align: center">'+dateFormat(new Date(theobserva[y].quando),"dd/mm/yyyy")+'</div>'
            string_div = string_div+'<div style="width: 20%;display: inline-block; text-align: center">'+theobserva[y].quem.fullname+'</div>'
            string_div = string_div+'<div style="width: 70%;display: inline-block; text-align: center">'+theobserva[y].texto+'</div>'
           
                
                
                
            }
           
            
            string_div = string_div+'</div></div>'
            cell1_2.innerHTML = string_div
            
            qtasrow = qtasrow +1
      
        
        
    }
    
   
    
    
  
  	    }
  	    
  	  function move_acima2(){
      var linha = event.srcElement.id
    console.log(linha)
    var linha_array = linha.split("_")
    var numero = parseInt(linha_array[1])
   console.log(numero) 
    
   //  document.getElementById("botao_alterar_sequencia").style.display = "inline-block"
    if (numero > 0){
        
        var hora1 = new Date(lista_prioridades[numero-1].hora_estimada.inicio)
        
        var agoramemo = new Date()
        console.log("HORA 1")
        console.log(hora1.getTime())
        console.log("AGORA MEMO")
        console.log(agoramemo.getTime())
        if (lista_prioridades[numero-1].arte_finalizado === true){
            alert("A arte "+lista_prioridades[i].descricao+" está em execução e não pode ser alterada na ordem")
        } else {
        if (hora1.getTime() < agoramemo.getTime()){
            alert("Não é possível priorizar depois da hora de inicio")
        } else {
           lista_prioridades[numero].hora_estimada.inicio =  lista_prioridades[numero-1].hora_estimada.inicio
           console.log("Nova Hora de INICIO")
            console.log(new Date(lista_prioridades[numero].hora_estimada.inicio))
            
             var hora_de_inicio = new Date(lista_prioridades[numero].hora_estimada.inicio)
  	        console.log("INICIO")
  	        console.log(hora_de_inicio)
  	        
  	            var complex = lista_prioridades[numero].complexidade
            if (complex.indexOf(":") > -1){
                var complex_array = complex.split(":")
                if (complex_array[1] === "00"){
                  var numero_horas = parseInt(complex_array[0])  
                } else {
                    var minutos = (parseInt(complex_array[1]))/60
                    var horas = parseInt(complex_array[0]) 
                    var numero_horas = horas+minutos
                }
                
            } else {
                var numero_horas = parseInt(lista_prioridades[numero].complexidade)
            }
            
            
            var hora_do_almoco = 0
            if (numero_horas < 8){
            if (hora_de_inicio.getHours() < 12 && hora_de_inicio.getHours()+numero_horas > 12){
                hora_do_almoco = 1
            } else if (hora_de_inicio.getHours() > 12){
                if (numero_horas <= 4){
                    hora_do_almoco = 0
                } else {
                if ((numero_horas-4)-(17-hora_de_inicio.getHours()) < 0){
                    hora_do_almoco = 1
                }
            }
            
            }
            } else {
               hora_do_almoco = parseInt((numero_horas - hora_de_inicio.getHours())/8)
                
            } 
            
            
            numero_horas = numero_horas+hora_do_almoco
            
            var horas_que_sobram = 17-hora_de_inicio.getHours()
            if (horas_que_sobram > numero_horas){
                hora_de_inicio.setHours(hora_de_inicio.getHours()+numero_horas)
            } else {
                var dias_somar = 1
                var dias_de_trabalho = parseInt(numero_horas/8)
                dias_somar = dias_somar+dias_de_trabalho
                hora_de_inicio.setDate(hora_de_inicio.getDate()+dias_somar)
                console.log("NUMERO HORAS")
                console.log(numero_horas)
                var pct_de_horas = ((numero_horas-horas_que_sobram)/8)%1
                console.log("PCT HORAS")
                console.log(pct_de_horas)
                var horas_adicionar = parseInt(pct_de_horas*8)
                
                hora_de_inicio.setHours(8+horas_adicionar,0,0,0)
                
            }
  	      
  	      
  	     
  	        lista_prioridades[numero].hora_estimada.final = new Date(hora_de_inicio)
            console.log(lista_prioridades[numero].hora_estimada.final)
            array_move(lista_prioridades,numero,numero-1)
            if (numero == 1){
                numero = numero+1
            }
            for (i=numero;i<lista_prioridades.length;i++){
                var anteriores = []
                anteriores.push(lista_prioridades[i-1].hora_estimada.final)
                anteriores.push(lista_prioridades[i-2].hora_estimada.final)
                console.log(lista_prioridades[i-1].hora_estimada.final)
                console.log(lista_prioridades[i-2].hora_estimada.final)
                anteriores.sort(function(a, b) {
                return new Date(b).getTime() - new Date(b).getTime();
                })
                
            lista_prioridades[i].hora_estimada.inicio = new Date(anteriores[1])
            
            
             var hora_de_inicio = new Date(lista_prioridades[i].hora_estimada.inicio)
  	        console.log("INICIO")
  	        console.log(hora_de_inicio)
  	        
  	            var complex = lista_prioridades[i].complexidade
            if (complex.indexOf(":") > -1){
                var complex_array = complex.split(":")
                if (complex_array[1] === "00"){
                  var numero_horas = parseInt(complex_array[0])  
                } else {
                    var minutos = (parseInt(complex_array[1]))/60
                    var horas = parseInt(complex_array[0]) 
                    var numero_horas = horas+minutos
                }
                
            } else {
                var numero_horas = parseInt(lista_prioridades[i].complexidade)
            }
            
            
            var hora_do_almoco = 0
            if (numero_horas < 8){
            if (hora_de_inicio.getHours() < 12 && hora_de_inicio.getHours()+numero_horas > 12){
                hora_do_almoco = 1
            } else if (hora_de_inicio.getHours() > 12){
                if (numero_horas <= 4){
                    hora_do_almoco = 0
                } else {
                if ((numero_horas-4)-(17-hora_de_inicio.getHours()) < 0){
                    hora_do_almoco = 1
                }
            }
            
            }
            } else {
               hora_do_almoco = parseInt((numero_horas - hora_de_inicio.getHours())/8)
                
            } 
            
            
            numero_horas = numero_horas+hora_do_almoco
            
            var horas_que_sobram = 17-hora_de_inicio.getHours()
            if (horas_que_sobram > numero_horas){
                hora_de_inicio.setHours(hora_de_inicio.getHours()+numero_horas)
            } else {
                var dias_somar = 1
                var dias_de_trabalho = parseInt(numero_horas/8)
                dias_somar = dias_somar+dias_de_trabalho
                hora_de_inicio.setDate(hora_de_inicio.getDate()+dias_somar)
                console.log("NUMERO HORAS")
                console.log(numero_horas)
                var pct_de_horas = ((numero_horas-horas_que_sobram)/8)%1
                console.log("PCT HORAS")
                console.log(pct_de_horas)
                var horas_adicionar = parseInt(pct_de_horas*8)
                
                hora_de_inicio.setHours(8+horas_adicionar,0,0,0)
                
            }
  	      
  	        if (hora_de_inicio.getDay() === 6){
  	            hora_de_inicio.setDate(hora_de_inicio.getDate()+2)
  	        }
  	        if (hora_de_inicio.getDay() === 0){
  	            hora_de_inicio.setDate(hora_de_inicio.getDate()+1)
  	        }
  	     
  	        lista_prioridades[i].hora_estimada.final = new Date(hora_de_inicio)
            
            
                
            }
            
            
           
           }
            
        }
        
            
        }
       preenche_prioridades() 
    }
    
    
  	  
  	    
  
  // ------- FUNCAO MOVE ABAIXO -------///
    
    function move_abaixo2(){
       var linha = event.srcElement.id
    console.log(linha)
     var linha_array = linha.split("_")
     
      if (numero < lista_prioridades.length-1){
        
        var hora1 = new Date(lista_prioridades[numero].hora_estimada.inicio)
        
        var agoramemo = new Date()
        console.log("HORA 1")
        console.log(hora1.getTime())
        console.log("AGORA MEMO")
        console.log(agoramemo.getTime())
        if (lista_prioridades[numero].arte_finalizado === true){
            alert("A arte "+lista_prioridades[i].descricao+" está em execução e não pode ser alterada na ordem")
        } else {
           lista_prioridades[numero+1].hora_estimada.inicio =  lista_prioridades[numero].hora_estimada.inicio
           console.log("Nova Hora de INICIO")
            console.log(new Date(lista_prioridades[numero].hora_estimada.inicio))
            
             var hora_de_inicio = new Date(lista_prioridades[numero+1].hora_estimada.inicio)
  	        console.log("INICIO")
  	        console.log(hora_de_inicio)
  	        
  	            var complex = lista_prioridades[numero+1].complexidade
            if (complex.indexOf(":") > -1){
                var complex_array = complex.split(":")
                if (complex_array[1] === "00"){
                  var numero_horas = parseInt(complex_array[0])  
                } else {
                    var minutos = (parseInt(complex_array[1]))/60
                    var horas = parseInt(complex_array[0]) 
                    var numero_horas = horas+minutos
                }
                
            } else {
                var numero_horas = parseInt(lista_prioridades[numero+1].complexidade)
            }
            
            
            var hora_do_almoco = 0
            if (numero_horas < 8){
            if (hora_de_inicio.getHours() < 12 && hora_de_inicio.getHours()+numero_horas > 12){
                hora_do_almoco = 1
            } else if (hora_de_inicio.getHours() > 12){
                if (numero_horas <= 4){
                    hora_do_almoco = 0
                } else {
                if ((numero_horas-4)-(17-hora_de_inicio.getHours()) < 0){
                    hora_do_almoco = 1
                }
            }
            
            }
            } else {
               hora_do_almoco = parseInt((numero_horas - hora_de_inicio.getHours())/8)
                
            } 
            
            
            numero_horas = numero_horas+hora_do_almoco
            
            var horas_que_sobram = 17-hora_de_inicio.getHours()
            if (horas_que_sobram > numero_horas){
                hora_de_inicio.setHours(hora_de_inicio.getHours()+numero_horas)
            } else {
                var dias_somar = 1
                var dias_de_trabalho = parseInt(numero_horas/8)
                dias_somar = dias_somar+dias_de_trabalho
                hora_de_inicio.setDate(hora_de_inicio.getDate()+dias_somar)
                console.log("NUMERO HORAS")
                console.log(numero_horas)
                var pct_de_horas = ((numero_horas-horas_que_sobram)/8)%1
                console.log("PCT HORAS")
                console.log(pct_de_horas)
                var horas_adicionar = parseInt(pct_de_horas*8)
                
                hora_de_inicio.setHours(8+horas_adicionar,0,0,0)
                
            }
  	      
  	      
  	     
  	        lista_prioridades[numero+1].hora_estimada.final = new Date(hora_de_inicio)
            console.log(lista_prioridades[numero+1].hora_estimada.final)
            array_move(lista_prioridades,numero,numero+1)
            if (numero == 1){
                numero = numero+1
            }
            for (i=numero+1;i<lista_prioridades.length;i++){
                var anteriores = []
                anteriores.push(lista_prioridades[i-1].hora_estimada.final)
                anteriores.push(lista_prioridades[i-2].hora_estimada.final)
                console.log(lista_prioridades[i-1].hora_estimada.final)
                console.log(lista_prioridades[i-2].hora_estimada.final)
                anteriores.sort(function(a, b) {
                return new Date(b).getTime() - new Date(b).getTime();
                })
                
            lista_prioridades[i].hora_estimada.inicio = new Date(anteriores[1])
            
            
             var hora_de_inicio = new Date(lista_prioridades[i].hora_estimada.inicio)
  	        console.log("INICIO")
  	        console.log(hora_de_inicio)
  	        
  	            var complex = lista_prioridades[i].complexidade
            if (complex.indexOf(":") > -1){
                var complex_array = complex.split(":")
                if (complex_array[1] === "00"){
                  var numero_horas = parseInt(complex_array[0])  
                } else {
                    var minutos = (parseInt(complex_array[1]))/60
                    var horas = parseInt(complex_array[0]) 
                    var numero_horas = horas+minutos
                }
                
            } else {
                var numero_horas = parseInt(lista_prioridades[i].complexidade)
            }
            
            
            var hora_do_almoco = 0
            if (numero_horas < 8){
            if (hora_de_inicio.getHours() < 12 && hora_de_inicio.getHours()+numero_horas > 12){
                hora_do_almoco = 1
            } else if (hora_de_inicio.getHours() > 12){
                if (numero_horas <= 4){
                    hora_do_almoco = 0
                } else {
                if ((numero_horas-4)-(17-hora_de_inicio.getHours()) < 0){
                    hora_do_almoco = 1
                }
            }
            
            }
            } else {
               hora_do_almoco = parseInt((numero_horas - hora_de_inicio.getHours())/8)
                
            } 
            
            
            numero_horas = numero_horas+hora_do_almoco
            
            var horas_que_sobram = 17-hora_de_inicio.getHours()
            if (horas_que_sobram > numero_horas){
                hora_de_inicio.setHours(hora_de_inicio.getHours()+numero_horas)
            } else {
                var dias_somar = 1
                var dias_de_trabalho = parseInt(numero_horas/8)
                dias_somar = dias_somar+dias_de_trabalho
                hora_de_inicio.setDate(hora_de_inicio.getDate()+dias_somar)
                console.log("NUMERO HORAS")
                console.log(numero_horas)
                var pct_de_horas = ((numero_horas-horas_que_sobram)/8)%1
                console.log("PCT HORAS")
                console.log(pct_de_horas)
                var horas_adicionar = parseInt(pct_de_horas*8)
                
                hora_de_inicio.setHours(8+horas_adicionar,0,0,0)
                
            }
  	      
  	        if (hora_de_inicio.getDay() === 6){
  	            hora_de_inicio.setDate(hora_de_inicio.getDate()+2)
  	        }
  	        if (hora_de_inicio.getDay() === 0){
  	            hora_de_inicio.setDate(hora_de_inicio.getDate()+1)
  	        }
  	     
  	        lista_prioridades[i].hora_estimada.final = new Date(hora_de_inicio)
            
            
                
            }
            
            
           
           }
            
        }
        
            
        
       preenche_prioridades() 
    
  
    } 
         
   
   
    
     
     
    function salva_sequencia(){
        document.getElementById("texto_sequencia").innerText = "Aguarde enquando a base é atualizada"
        for (i=0;i<lista_prioridades.length;i++){
            var temposalterados = lista_prioridades[i].hora_estimada
            api.custom_objects.set_keys("BR-VALFI_Tickets",lista_prioridades[i]._id,{"hora_estimada":temposalterado})
        }
         
         document.getElementById("botao_alterar_sequencia").style.display = "none"
        preenche_prioridades()
    }
    
     
  preenche_aguardando()  
  
  
   function mostraDisclosure(){
  	 console.log(event.srcElement.id)
        var linha = parseInt(event.srcElement.id)+1
        var table = document.getElementById("tabela_prioridades")
  
        if (table.rows[linha].children[0].style.display == "none"){
            table.rows[linha].children[0].style = "background-color: #EEE;"
            table.rows[linha].children[0].colSpan = 9
        } else {
            table.rows[linha].children[0].style = "display: none;" 
        }
      }
      
      
     function mostraDisclosure2(){
  	 console.log(event.srcElement.id)
        var linha = parseInt(event.srcElement.id)+1
        var table = document.getElementById("tabela_aguardando")
  
        if (table.rows[linha].children[0].style.display == "none"){
            table.rows[linha].children[0].style = "background-color: #EEE;"
            table.rows[linha].children[0].colSpan = 9
        } else {
            table.rows[linha].children[0].style = "display: none;" 
        }
      }
      
      function mostraDisclosure3(){
  	 console.log(event.srcElement.id)
        var linha = parseInt(event.srcElement.id)+1
        var table = document.getElementById("tabela_pendente")
  
        if (table.rows[linha].children[0].style.display == "none"){
            table.rows[linha].children[0].style = "background-color: #EEE;"
            table.rows[linha].children[0].colSpan = 9
        } else {
            table.rows[linha].children[0].style = "display: none;" 
        }
      }
    
    	    
</script>
<script>
     function filtro_tabela_prioridade() {
      var input, filter, table, tr, td, td2, td3, td4, i, txtValue;
      input = document.getElementById("filtrarTabelaPrioridade");
      filter = input.value.toUpperCase();
      table = document.getElementById("tabela_prioridades");
      tr = table.getElementsByTagName("tr");
      for (i = 1; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[1];
        td2 = tr[i].getElementsByTagName("td")[2];
        td3 = tr[i].getElementsByTagName("td")[3];
        td4 = tr[i].getElementsByTagName("td")[4];
        if (td || td2 || td3 || td4) {
          txtValue = td.textContent || td.innerText;
          txtValue2 = td2.textContent || td2.innerText;
          txtValue3 = td3.textContent || td3.innerText;
          txtValue4 = td4.textContent || td4.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1 || txtValue2.toUpperCase().indexOf(filter) > -1 || txtValue3.toUpperCase().indexOf(filter) > -1 || txtValue4.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
          } else {
            tr[i].style.display = "none";
          }
        }       
      }
    }
    
    function filtro_tabela_aguardando() {
      var input, filter, table, tr, td, td2, td3, td4, i, txtValue;
      input = document.getElementById("filtrarTabelaAguardando");
      filter = input.value.toUpperCase();
      table = document.getElementById("tabela_aguardando");
      tr = table.getElementsByTagName("tr");
      for (i = 1; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[1];
        td2 = tr[i].getElementsByTagName("td")[2];
        td3 = tr[i].getElementsByTagName("td")[3];
        td4 = tr[i].getElementsByTagName("td")[4];
        if (td || td2 || td3 || td4) {
          txtValue = td.textContent || td.innerText;
          txtValue2 = td2.textContent || td2.innerText;
          txtValue3 = td3.textContent || td3.innerText;
          txtValue4 = td4.textContent || td4.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1 || txtValue2.toUpperCase().indexOf(filter) > -1 || txtValue3.toUpperCase().indexOf(filter) > -1 || txtValue4.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
          } else {
            tr[i].style.display = "none";
          }
        }       
      }
    }
    
    function filtro_tabela_pendente() {
      var input, filter, table, tr, td, td2, td3, td4, i, txtValue;
      input = document.getElementById("filtrarTabelaPendente");
      filter = input.value.toUpperCase();
      table = document.getElementById("tabela_pendente");
      tr = table.getElementsByTagName("tr");
      for (i = 1; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[1];
        td2 = tr[i].getElementsByTagName("td")[2];
        td3 = tr[i].getElementsByTagName("td")[3];
        td4 = tr[i].getElementsByTagName("td")[4];
        if (td || td2 || td3 || td4) {
          txtValue = td.textContent || td.innerText;
          txtValue2 = td2.textContent || td2.innerText;
          txtValue3 = td3.textContent || td3.innerText;
          txtValue4 = td4.textContent || td4.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1 || txtValue2.toUpperCase().indexOf(filter) > -1 || txtValue3.toUpperCase().indexOf(filter) > -1 || txtValue4.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
          } else {
            tr[i].style.display = "none";
          }
        }       
      }
    }
</script>
<script>
    function filtra_icones(){
      var linha = event.srcElement.id
      console.log(linha)
      var linha_array = linha.split("_")
      var cards = ["pendente","priorizar","prioridade","desenvolvendo","revisar","aprovacao","aprovacaogmg","aprovado"]
      var div_img = "imagem_"+linha_array[1]
      var icone = document.getElementById(div_img).src
      for (i=0;i<cards.length;i++){
          if (cards[i] == linha_array[1]){
              var tira = cards.splice(i,1)
          }
      }
      
      if (icone.indexOf("_off") > -1){
          document.getElementById(div_img).src = icone.substring(0,icone.lastIndexOf('_off.'))+".png"
          for (i=0;i<cards.length;i++){
              var nova_div = "imagem_"+cards[i]
              var icone_atual = document.getElementById(nova_div).src
              if (icone_atual.indexOf("_off") == -1){
              document.getElementById(nova_div).src = icone_atual.replace(".png","_off.png")
              }
          }
          if (linha_array[1] == "pendente"){
              document.getElementById("mostra_tabela_prioridade").style.display = "none"
              document.getElementById("mostra_tabela_aguardando").style.display = "none"
              document.getElementById("mostra_tabela_pendente").style.display = "inline-block"
          }
          if (linha_array[1] == "priorizar"){
              document.getElementById("mostra_tabela_prioridade").style.display = "none"
              document.getElementById("mostra_tabela_aguardando").style.display = "inline-block"
              document.getElementById("mostra_tabela_pendente").style.display = "none"
          }
          if (linha_array[1] == "prioridade"){
              document.getElementById("mostra_tabela_prioridade").style.display = "inline-block"
              document.getElementById("mostra_tabela_aguardando").style.display = "none"
              document.getElementById("mostra_tabela_pendente").style.display = "none"
          }
          
      } else {
          document.getElementById(div_img).src = icone.substring(0,icone.lastIndexOf('.'))+"_off.png"
          document.getElementById("mostra_tabela_prioridade").style.display = "inline-block"
              document.getElementById("mostra_tabela_aguardando").style.display = "inline-block"
              document.getElementById("mostra_tabela_pendente").style.display = "inline-block"
      }
    }
</script>
  	
  






    </body>

</html>