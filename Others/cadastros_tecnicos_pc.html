<!doctype html>
<html>
    <head>
      <title>Cilindros Porta Clichê - Valgroup</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      
      <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">

      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
      <link rel="stylesheet" href="css/style.css">
      <link rel="stylesheet" href="css/table.css">
        <meta name="viewport" content="width=944">
        <meta name="robots" content="noindex, follow">
	<link rel="Shortcut icon" href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/favicon.ico" type="image/x-icon">
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon.png" rel="apple-touch-icon" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144" />
        <link rel="stylesheet" href="fonts/fontawesome-all.min.css">
        <link rel="stylesheet" href="fonts/font-awesome.min.css">
        <link rel="stylesheet" href="fonts/fontawesome5-overrides.min.css">
        <script src="js/popper.js"></script>
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
          <script src="js/jscolor.js"></script>
        
  
        
        <script src="/portal.cgi/PP_FILE_STORE/Sistema/assets/js/vendor/modernizr-2.6.2.min.js"></script>
      	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-1.8.3.min.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-ui-1.9.2.custom.js'></script>
    	
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.cookie.js'></script>
    <!-- portal.js -->
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-linedtextarea.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/codemirror.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/javascript.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.tmpl.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-regex.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/sitemapstyler.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/date.format.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.iframe-transport.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.fileupload.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.notify.min.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.event.drag-2.2.js'></script>
        <script type='text/javascript' src='/portal.cgi?api=js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/portal/js/nixps-portal-api.js'></script>
        <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.i18n.js'></script>
        <script type='text/javascript' src='./Charts/Chart.min.js'></script>
        <script type='text/javascript' src='./Charts/utils.js'></script>
       <style>
		#canvas-holder {
			width: 100%;
			margin-top: 50px;
			text-align: center;
		}
		#chartjs-tooltip {
			opacity: 1;
			position: absolute;
			background: rgba(0, 0, 0, .7);
			color: white;
			border-radius: 3px;
			-webkit-transition: all .1s ease;
			transition: all .1s ease;
			pointer-events: none;
			-webkit-transform: translate(-50%, 0);
			transform: translate(-50%, 0);
		}

		.chartjs-tooltip-key {
			display: inline-block;
			width: 10px;
			height: 10px;
			margin-right: 10px;
		}
	</style>

       
    

    </head>


    <body>

  		<div class="wrapper d-flex align-items-stretch">
  			<nav id="sidebar">
  				<div class="p-4 pt-5">
            <img>
  		  		<img src="./logo/logo_valgroup.png" style="width: 90%; margin-bottom: 50px;">
         	   <ul class="active components mb-5">
           
          <li  style="list-style-type: none">
               <a href="cadastros_clientes.html"><img src="./Icons/clientes.png" width="30px" style="margin-right: 10px">Clientes</a>
              </li>
          <li>
              <a href="#homeSubmenu2" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><img src="./Icons/fornecedores.png" width="30px" style="margin-right: 10px">Fornecedores</a>
           <li class="active" style="list-style-type: none">
               <ul class="collapse list-unstyled" id="homeSubmenu2">
               <li style="list-style-type: none">
               <a href="cadastros_fornecedores_flexo.html"><img src="./Icons/flexo.png" width="20px" style="margin-right: 10px">Flexo</a>
          </li>
          <li  style="list-style-type: none">
               <a href="cadastros_fornecedores_roto.html"><img src="./Icons/roto.png" width="20px" style="margin-right: 10px">Roto</a>
          </li>
          <li  style="list-style-type: none">
               <a href="cadastros_fornecedores_anilox.html"><img src="./Icons/anilox.png" width="20px" style="margin-right: 10px">Anilox</a>
          </li>
          <li  style="list-style-type: none">
               <a href="cadastros_fornecedores_pc.html"><img src="./Icons/porta_cliche.png" width="20px" style="margin-right: 10px">Cilindro Porta Clichê</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_fornecedores_prepress.html"><img src="./Icons/prepress.png" width="20px" style="margin-right: 10px">Prepress</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_fornecedores_materiaprima.html"><img src="./Icons/material.png" width="20px" style="margin-right: 10px">Matéria Prima</a>
          </li>
          </ul>
          
          <li class="active">
              <a  href="#homeSubmenu3" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><img src="./Icons/tecnicos.png" width="30px" style="margin-right: 10px">Cadastros Técnicos</a>
           <li class="active" style="list-style-type: none">
               <ul class="collapse list-unstyled" id="homeSubmenu3">
              
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_unidades.html"><img src="./Icons/unidades.png" width="20px" style="margin-right: 10px">Unidades</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_tipotrabalho.html"><img src="./Icons/tipo_trabalho.png" width="20px" style="margin-right: 10px">Tipo de Trabalho</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_finalidade.html"><img src="./Icons/finalidade.png" width="20px" style="margin-right: 10px">Finalidade</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_substratos.html"><img src="./Icons/substratos.png" width="20px" style="margin-right: 10px">Substratos</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_duplaface.html"><img src="./Icons/dupla_face.png" width="20px" style="margin-right: 10px">Dupla Face</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_estruturas.html"><img src="./Icons/estruturas.png" width="20px" style="margin-right: 10px">Estruturas</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_tintas.html"><img src="./Icons/tintas.png" width="20px" style="margin-right: 10px">Tintas</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_situacaoanilox.html"><img src="./Icons/situacao_anilox.png" width="20px" style="margin-right: 10px">Situação de Anilox</a>
          </li>
          <li   class="active" style="list-style-type: none">
               <a href="cadastros_tecnicos_pc.html"><img src="./Icons/porta_cliche.png" width="20px" style="margin-right: 10px">Cilindros Porta Clichê</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_lavagemanilox.html"><img src="./Icons/lavagem_anilox.png" width="20px" style="margin-right: 10px">Anilox (tipo de lavagem)</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_segmentos.html"><img src="./Icons/segmentos.png" width="20px" style="margin-right: 10px">Segmentos</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_maquinas.html"><img src="./Icons/impressoras.png" width="20px" style="margin-right: 10px">Máquinas</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_tecnicos_testform.html"><img src="./Icons/testform.png" width="20px" style="margin-right: 10px">Test Form</a>
          </li>
          </ul>
          
              
                <li>
              <a href="#homeSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><img src="./Icons/sequencia.png" width="30px" style="margin-right: 10px">Sequência Padrão</a>
              <ul class="collapse list-unstyled" id="homeSubmenu">
              <li class="active" style="list-style-type: none">
               <a href="receita_tintas.html"><img src="./Icons/contagotas.png" width="20px" style="margin-right: 10px">Criar Sequência</a>
              </li>
              <li  style="list-style-type: none">
               <a href="lista_receitas.html"><img src="./Icons/listasequencia.png" width="20px" style="margin-right: 10px">Lista Sequências</a>
              </li>
              <li style="list-style-type: none">
               <a href="cadastros_tintas.html"><img src="./Icons/novasequencia.png" width="20px" style="margin-right: 10px">Lista de Cores</a>
              </li>
              </ul>
          </li>
              </ul>
          
   
  	        <div class="footer">
  	        	<p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0.
  						  Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib.com</a>
  						   Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
  	        </div>
  	      </div>
      	</nav>

          <!-- Page Content  -->
        <div id="content" class="p-4 p-md-5">

          <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">

              <button type="button" id="sidebarCollapse" class="btn btn-primary">
                <i class="fa fa-bars"></i>
                <span class="sr-only">Toggle Menu</span>
              </button>
              <button class="btn btn-dark d-inline-block d-lg-none ml-auto" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <i class="fa fa-bars"></i>
              </button>
              <div id="bemvindo" style="margin-left: 20px;"></div>

              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav ml-auto">
              
                  <li class="nav-item">
                      <a class="nav-link" href= "javascript:window.history.go(-1)" style="cursor:pointer;"><img src="./Icons/voltar.png" width="20px" style="margin-right: 5px;">Voltar</a>
                  </li>  
                 <li class="nav-item">
                      <a class="nav-link" href="cadastros_clientes.html">Cadastros</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="solicitacao_desenho.html">Tickets</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="alterar_senha.html" target="_Blank">Alterar Senha</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav>

          <div>
      
        
        <div  class="form-group col-md-11" style="display:inline-block;">
       
            <div id="tipo_alteracao" style="display:none"></div>
            <div id="id_tipo_trabalho" style="display:none"></div>
            <div id="id_finalidade" style="display:none"></div>
            <div id="id_substrato" style="display:none"></div>
             <div id="id_detalhe" style="display:none"></div>
             <div id="id_situacaoanilox" style="display:none"></div>
             <div id="id_portacliche" style="display:none"></div>
             <div id="qual_cilindro" style="display:none"></div>
             <div id="id_lavagemanilox" style="display:none"></div>
             
             <div id="id_segmento" style="display:none"></div>
             <div id="id_planta" style="display:none"></div>
             <div id="id_dupla" style="display:none"></div>
             <div id="id_maquina" style="display:none"></div>
             <div id="id_tinta" style="display:none"></div>
             <div id="id_estrutura" style="display:none"></div>
            <div id="id_familia" style="display:none"></div>
        <h4 id="que_estou_fazendo"></h4>
        <div id="nome_tabela" style="display: none"></div>
            
    
       
          
         <h5 id="a_div_portacliche"><i id="portaclicheArrow" class="fas fa-plus-square" onclick="mostraPortacliche()" style="margin-right: 5px; cursor:pointer;"></i>Cilindro Porta Clichê</h5>
                <p><i>Cadastro das peças, tamanhos e distorções dos porta-clichês</i></p>
                
                 <div id="info_portacliche" class="form-group" style="display: none">
                
               
                
                   
                  
                  
                 <div  class="form-group col-md-2" style="display:inline-block;">
                <label for="nomenclatura_portacliche">Nomenclatura</label>
                  <input type="text" class="form-control" onchange="busca_portacliche()" id="nomenclatura_portacliche" onkeyup="this.value=this.value.toUpperCase()" name="nomenclatura_portacliche">
                 </div>
                 <div  class="form-group col-md-2" style="display:inline-block;">
                <label for="passo_portacliche">Passo do Cilindro</label>
                  <input type="number" class="form-control"  id="passo_portacliche" name="passo_portacliche" step="0.01">
                 </div>
                 <div  class="form-group col-md-2" style="display:inline-block;">
                <label for="perimetro_portacliche">Perímetro Real</label>
                  <input type="number" class="form-control" id="perimetro_portacliche" onfocusout="calcula_diametro()" name="perimetro_portacliche" min="0" step="0.001" >
                 </div>
                 <div  class="form-group col-md-2" style="display:inline-block;">
                <label for="distorcido_portacliche">Perímetro Distorcido</label>
                  <input type="number" class="form-control"  id="distorcido_portacliche" name="distorcido_portacliche" step="0.01">
                 </div>
                <div  class="form-group col-md-2" style="display:inline-block;">
                <label for="diametro_portacliche">Diâmetro</label>
                  <input type="text" class="form-control" id="diametro_portacliche"  name="diametro_portacliche">
                 </div>
               
                 
               
                  
                 
                 <div  class="form-group col-md-2" style="display:inline-block;">
                <label for="fornecedor_portacliche">Fornecedor</label>
                  <select class="form-control"  id="fornecedor_portacliche" name="fornecedor_portacliche">
                      <option value="undefined">Selecionar..</option>
                      </select>
                 </div>
                 <div  class="form-group col-md-2" style="display:inline-block;">
                <label for="numero_portacliche">Número PC</label>
                  <input type="text" class="form-control" onkeypress="return onlyNumberKey(event)" id="numero_portacliche" name="numero_portacliche">
                 </div>
                  <div  class="form-group col-md-2" style="display:inline-block;">
                <label for="lote_portacliche">Lote</label>
                  <input type="text" class="form-control" id="lote_portacliche" name="lote_portacliche">
                 </div>
                   <div  class="form-group col-md-2" style="display:inline-block;">
                <label for="sleeve_portacliche">Sleeve</label>
                  <input type="text" class="form-control" id="sleeve_portacliche" name="sleeve_portacliche">
                 </div>
                  
                 <div  class="form-group col-md-2" style="display:inline-block;">
                 <label for="espessuradupla_portacliche">Espessura Dupla Face</label>
                  <select class="form-control"  id="espessuradupla_portacliche" name="espessuradupla_portacliche">
                      <option value="undefined">Selecionar...</option>
                      <option value="0.50">0.50</option>
                      <option value="0.38">0.38</option>
                      </select>
                 </div>
               <div  class="form-group col-md-2" style="display:inline-block; vertical-align: top;">
                <label for="status_portacliche">Status PC</label>
                  <select class="form-control"  id="status_portacliche" name="status_portacliche">
                      <option value="undefined">Selecionar...</option>
                      <option>LIBERADO</option>
                      <option>COM AVARIA</option>
                      <option>INATIVO</option>
                      </select>
            </div>
            <div  class="form-group col-md-2" style="display:inline-block;">
                <label for="totalpecas_portacliche">Qt.Peças</label>
                  <input type="text" class="form-control"  id="totalpecas_portacliche" name="totalpecas_portacliche" value="0" readonly>
                 </div>
            <div  class="form-group col-md-2" style="display:inline-block;">
                <label for="numero_engrenagem">Nº Engrenagem</label>
                  <input type="number" class="form-control"  id="numero_engrenagem" name="numero_engrenagem">
                 </div>
       
          
            <div  class="form-group col-md-4" style="display:inline-block; vertical-align: top;">
                <label for="observacoes_portacliche">Observações</label>
                  <textarea class="form-control"  id="observacoes_portacliche" name="observacoes_portacliche"></textarea>
               
            </div>
            <div  class="form-group col-md-11" style="display:inline-block; vertical-align: top;">
              <div  class="form-group col-md-6" style="display:inline-block; vertical-alignL: top;">
               
                <label for="as_avarias">Avarias</label><br>
                  <select class="form-control"  id="as_avarias" name="as_avarias" style="width: 70%; display: inline-block;">
                     </select><span style="display: inline-block;"><img src="./Icons/icone_mais.png" width="20px" style="cursor: pointer; display: inline-block; margin-left: 5px;" onclick="adiciona_avaria()"></span>
             </div>
              <div id="mostra_tabela_avarias" class="form-group col-md-5" style="display:inline-block; vertical-align: top;">
                 <table id="tabela_avarias" class="table custom-table" style="display: inline-block;">
                 <thead>
                <tr>
             
                 <th class="col" style="width:400px">Avaria</th>
              <th class="col" style="width:50px">Apagar</th>
           
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
     
                
             </div>
             
             
             </div>
                             
                <div  class="form-group col-md-4" style="display:none">
                <div  class="form-group col-md-9" style="display:inline-block;">
                <label for="planta_portacliche">Unidade</label>
                  <select class="form-control"  id="planta_portacliche" name="planta_portacliche">
                    </select>
                 </div><span><img id="img-planta_portacliche" src="./Icons/icone_mais.png" width="20px" style="cursor: pointer;" onclick="adiciona_planta()"></span><span><img id="img-planta_portacliche_menos" src="./Icons/icone_menos.png" width="20px" style="cursor: pointer;" onclick="remove_planta()"></span>
                 <div  class="form-group col-md-11" style="display:inline-block;">
                  <input type="text" class="form-control"  id="as_planta_portacliche" name="as_planta_portacliche">
                  <span class="error" id="error_planta_portacliche" style="color: red"></span>
                 </div>
                </div>
                 
                 
                <br>
                 <div  class="form-group col-md-11" style="display:inline-block; margin-top: 10px;">
                  <button class="btn btn-primary" onclick="salvar_portacliche()" style="cursor: pointer">Salvar Cilindro</button>
                 <button class="btn btn-secondary" onclick="cancelar_portacliche()" style="cursor: pointer">Cancelar</button>
                 </div>
                
                 
             </div>
         
            
            
            <div  class="form-group col-md-3" style="display:inline-block; vertical-align: top;">
                <label for="filtro_nomenclatura">Nomenclatura</label>
                  <select class="form-control"  id="filtro_nomenclatura" onchange="filtrar_pc()" name="filtro_nomenclatura">
                      <option>TODOS</option>
                      </select>
            </div>
            
            <div  class="form-group col-md-3" style="display:inline-block; vertical-align: top;">
                <label for="filtro_status">Status PC</label>
                  <select class="form-control"  id="filtro_status" onchange="filtrar_pc()" name="filtro_status">
                      <option>TODOS</option>
                      <option>LIBERADO</option>
                      <option>COM AVARIA</option>
                      <option>INATIVO</option>
                      </select>
            </div>
            
            <div  class="form-group col-md-3" style="display:inline-block;">
                 <label for="filtro_dupla">Dupla Face</label>
                  <select class="form-control"  id="filtro_dupla" onchange="filtrar_pc()" name="filtro_dupla">
                      <option>TODAS</option>
                      <option value="0.5">0.50</option>
                      <option value="0.38">0.38</option>
                      </select>
                 </div>
                 <div  class="form-group col-md-2" style="display:inline-block;">
                     <a href="#info_report" style="cursor:pointer;"><img src="./Icons/vergrafico.png" width="20px" style="margin-right: 5px;">Ver Gráfico</a>
                     </div>
           
            
            <table id="tabela_portacliche" class="table custom-table"  style="display: inline-block; min-width: 900px;">
          <thead>
            <tr>
             
             <th class="col" style="width:3%" colspan="1"></th>
               <th class="col" style="width:17%" colspan="2">QT. PEÇAS</th>
              <th class="col" style="width:30%" colspan="3">NOMENCLATURA</th>
                <th class="col" style="width:25%;" colspan="2">DIÂMETRO</th>
              <th class="col" style="width:25%;" colspan="2">PASSO</th>
           
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
     
           
        <hr>
      
       
       
    <div id="info_report" class="form-group" style="display: inline-block; width: 100%">
      
         <div style="width: 80%; display: inline-block; vertical-align: top;">
        <div id="canvas-holder" style="width:100%;">
		<canvas id="chart-area"></canvas>
		<div id="chartjs-tooltip">
			<table></table>
		</div>
	    </div> 
        </div>
        <div style="width: 19%; display: inline-block; vertical-align: top;">
            <div  class="form-group col-md-11" style="display:inline-block; margin-top: 140px;">
                <label for="total_ativos">Liberados</label>
                  <input type="text" class="form-control" id="total_ativos" name="total_ativos" style="background-color: #4BC0C0; color: white; text-align: center;" readonly>
                 </div>
            
            <div  class="form-group col-md-11" style="display:inline-block;">
                <label for="total_avaria">Com Avaria</label>
                  <input type="text" class="form-control" id="total_avaria" name="total_avaria" style="background-color: #FF9F3F; color: white; text-align: center;" readonly>
                 </div>
          
            <div  class="form-group col-md-11" style="display:inline-block;">
                <label for="total_inativos">Inativos</label>
                  <input type="text" class="form-control" id="total_inativos" name="total_inativos" style="background-color: #FF6484; color: white; text-align: center;" readonly>
                 </div>
            
            <br>
            <br>
            <br>
            <br>
            
            <div  class="form-group col-md-8" style="display:inline-block;">
                     <a href="#top" style="cursor:pointer;"><img src="./Icons/vertopo.png" width="20px" style="margin-right: 5px;">Topo</a>
                     </div>
           
        </div>
       </div>
        
        
  </div>
        
       
            
             
          
            
            <!-- terminar mostra locais e começa mostra registro -->
            
          
          
           
                <br>
                  <div id="info_update" style="color: green"></div>
              
            </div>
        
       </div>
  	 <script src="js/popper.js"></script>
  <script src="js/main.js"></script>
  		
  		
  	
  	<script>
  	    // funcoes de apoio
  	    
      function clearTable(table) {
  var rows = table.rows;
  var i = rows.length;
  while (--i) {
    rows[i].parentNode.removeChild(rows[i]);
    // or
    // table.deleteRow(i);
  }
}

function onlyUnique(value, index, self) {
  return self.indexOf(value) === index;
}



function cmyk2rgb(c, m, y, k, normalized){
    c = (c / 100);
    m = (m / 100);
    y = (y / 100);
    k = (k / 100);
    
    c = c * (1 - k) + k;
    m = m * (1 - k) + k;
    y = y * (1 - k) + k;
    
    var r = 1 - c;
    var g = 1 - m;
    var b = 1 - y;
    
    if(!normalized){
        r = Math.round(255 * r);
        g = Math.round(255 * g);
        b = Math.round(255 * b);
    }
    
    return {
        r: r,
        g: g,
        b: b
    }
}

function rgb2cmyk(r, g, b, normalized){
    var c = 1 - (r / 255);
    var m = 1 - (g / 255);
    var y = 1 - (b / 255);
    var k = Math.min(c, Math.min(m, y));
    
    c = (c - k) / (1 - k);
    m = (m - k) / (1 - k);
    y = (y - k) / (1 - k);
    
    if(!normalized){
        c = Math.round(c * 10000) / 100;
        m = Math.round(m * 10000) / 100;
        y = Math.round(y * 10000) / 100;
        k = Math.round(k * 10000) / 100;
    }
    
    c = isNaN(c) ? 0 : c;
    m = isNaN(m) ? 0 : m;
    y = isNaN(y) ? 0 : y;
    k = isNaN(k) ? 0 : k;
    
    return {
        c: c,
        m: m,
        y: y,
        k: k
    }
}

var usuario = api.auth.get_current_user()

if (usuario.username != "admin"){
    if (usuario.scope_name[0].indexOf("_") != -1){
        var scopo =  usuario.scope_name[0]
        var scopo_array = scopo.split("_")
        var planta = (scopo_array[scopo_array.length-1]).toUpperCase()
         document.getElementById("as_planta_portacliche").value = planta
    } 
}


  	</script>
  	
  	<script>
  	
  // preenche selects
  
 
  
    
    
    selectTipo15 = document.getElementById('fornecedor_portacliche');
  
  
    var tiposTipo15 = api.custom_objects.list_with_options("BR-VALFI_Fornecedores",["tipo","equal to","portacliche"]).results
    for (var i = 0; i<tiposTipo15.length; i++){
        var opt = document.createElement('option');
        opt.value = tiposTipo15[i].nome;
        opt.innerHTML = tiposTipo15[i].nome;
        selectTipo15.appendChild(opt);
    }
    
   
    
    </script>
  	




 
    
    
    <script>
   
    
    </script>

<script>

    
        function mostraPortacliche(){
         
        var div_cliente = document.getElementById("info_portacliche")
        var icone = document.getElementById("portaclicheArrow")
        icone.classList.toggle("fa-minus-square")
        if (div_cliente.style.display === "none") {
            div_cliente.style.display = "inline-block";
            div_cliente.style.width = "100%";
            
            } else {
                document.getElementById("id_portacliche").innerText = ""
                document.getElementById("passo_portacliche").value="";
                           document.getElementById("nomenclatura_portacliche").value= "";
                            document.getElementById("perimetro_portacliche").value= "";
                            document.getElementById("distorcido_portacliche").value= "";
                            document.getElementById("diametro_portacliche").value="";
                            document.getElementById("fornecedor_portacliche").value="undefined";
                            document.getElementById("numero_portacliche").value="";
                            document.getElementById("lote_portacliche").value = "";
                            document.getElementById("sleeve_portacliche").value = "";
                            document.getElementById("totalpecas_portacliche").value="0";
                            document.getElementById("id_portacliche").innerText="";
                            document.getElementById("espessuradupla_portacliche").value="undefined";
                            document.getElementById("status_portacliche").value="";
                            document.getElementById("numero_engrenagem").value="undefined";
                            document.getElementById("observacoes_portacliche").value="";
                            document.getElementById("qual_cilindro").innerText="";
                div_cliente.style.display = "none";
            }
     
      }
      
   
      
  </script>
  




<script>
    function salvar_portacliche(){
        var existe_id = document.getElementById("id_portacliche").innerText
        var existe_array = existe_id.split("_")
        var numero_cilindro = parseInt(existe_array[1])
        console.log("NUMERO DO CLINDRO ====>"+numero_cilindro)
        console.log(existe_id)
        var data ={}
        
        if (existe_id == ""){
        data["nomenclatura"] = document.getElementById("nomenclatura_portacliche").value
        data["distorcido"] = document.getElementById("distorcido_portacliche").value
        data["numero"] = document.getElementById("numero_portacliche").value
        data["fornecedor"] = document.getElementById("fornecedor_portacliche").value
        data["lote"] = document.getElementById("lote_portacliche").value
        data["sleeve"] = document.getElementById("sleeve_portacliche").value
        data["perimetro"] = document.getElementById("perimetro_portacliche").value
        data["passo"] = parseInt(document.getElementById("passo_portacliche").value)
        data["diametro"] = document.getElementById("diametro_portacliche").value
        data["usuario"] = usuario
        data["espessuradupla"] = document.getElementById("espessuradupla_portacliche").value
        data["status"] = document.getElementById("status_portacliche").value
        data["engrenagem"] = document.getElementById("numero_engrenagem").value
        data["observacoes"] = document.getElementById("observacoes_portacliche").value
        if (planta == undefined){
            data["planta"] = "SP1"
        } else {
        data["planta"] = [planta]
        }
        
       if (avarias_array != undefined){
        data["lista_avarias"] = avarias_array
       } else {
         data["lista_avarias"] = []  
       }
        
        var cria = api.hub.start_from_whitepaper_with_files_and_variables("[CADASTRO TECNICOS]","portacliche_Criar",[],data)
        console.log(cria)
            
            
            
        } else {
        data["_id"] = existe_id.substring(existe_id.lastIndexOf("_")+1,existe_id.length)
        
        for (i=0;i<os_porta.length;i++){
          if (os_porta[i]._id == data._id){
              os_porta[i].cilindros[numero_cilindro]["perimetro"] = document.getElementById("perimetro_portacliche").value
              os_porta[i].cilindros[numero_cilindro]["distorcido"] = document.getElementById("distorcido_portacliche").value
              os_porta[i].cilindros[numero_cilindro]["numero"] = document.getElementById("numero_portacliche").value
              os_porta[i].cilindros[numero_cilindro]["fornecedor"] = document.getElementById("fornecedor_portacliche").value
              os_porta[i].cilindros[numero_cilindro]["lote"] = document.getElementById("lote_portacliche").value
              os_porta[i].cilindros[numero_cilindro]["sleeve"] = document.getElementById("sleeve_portacliche").value
              os_porta[i].cilindros[numero_cilindro]["diametro"] = document.getElementById("diametro_portacliche").value
              os_porta[i].cilindros[numero_cilindro]["espessuradupla"] = document.getElementById("espessuradupla_portacliche").value
              os_porta[i].cilindros[numero_cilindro]["status"] = document.getElementById("status_portacliche").value
              os_porta[i].cilindros[numero_cilindro]["engrenagem"] = document.getElementById("numero_engrenagem").value
              os_porta[i].cilindros[numero_cilindro]["observacoes"] = document.getElementById("observacoes_portacliche").value
              os_porta[i].cilindros[numero_cilindro]["lista_avarias"] = avarias_array
             var indice = i 
              
          }  
        }
        var cria = api.hub.start_from_whitepaper_with_files_and_variables("[CADASTRO TECNICOS]","portacliche_Alterar",[],{"id":data._id,"thecils":os_porta[indice].cilindros,"passo":document.getElementById("passo_portacliche").value})
      
        }
        
        
       
       
       
       setTimeout(function(){document.getElementById("nomenclatura_portacliche").value="";
       
                            document.getElementById("passo_portacliche").value="";
                            document.getElementById("perimetro_portacliche").value= "";
                            document.getElementById("distorcido_portacliche").value= "";
                            document.getElementById("diametro_portacliche").value="";
                            document.getElementById("fornecedor_portacliche").value="undefined";
                            document.getElementById("numero_portacliche").value="";
                            document.getElementById("lote_portacliche").value = "";
                            document.getElementById("sleeve_portacliche").value = "";
                            document.getElementById("totalpecas_portacliche").value="0";
                            document.getElementById("id_portacliche").innerText="";
                            document.getElementById("espessuradupla_portacliche").value="undefined";
                            document.getElementById("status_portacliche").value="undefined";
                            document.getElementById("numero_engrenagem").value= "";
                            document.getElementById("observacoes_portacliche").value="";
                            document.getElementById("qual_cilindro").innerText="";
                            document.getElementById("passo_portacliche").readOnly = false;
                            document.getElementById("distorcido_portacliche").readOnly = false;
                            document.getElementById("perimetro_portacliche").readOnly = false;
                            var atualiza = api.custom_objects.list("BR-VALFI_portacliche").results
                            
                           // document.getElementById("as_planta_portacliche").value="";
                           // document.getElementById("as_planta_portacliche").value="";
                            preenche_portacliche(atualiza)
           
       },1000)
                            
        
       
       }
    
    
    let os_porta
    os_porta = api.custom_objects.list_with_options("BR-VALFI_portacliche").results
    
    // preenche select
    
    var the_lista_avarias = []
for (i=0;i<os_porta.length;i++){
    var thecils = os_porta[i].cilindros
    for (k=0;k<thecils.length;k++){
        if (thecils[k].lista_avarias != undefined){
        if (thecils[k].lista_avarias.length > 0){
            var theavar = thecils[k].lista_avarias
            for (j=0;j<theavar.length;j++){
                the_lista_avarias.push(theavar[j].trim())
            }
        }
    } else {
        thecils[k].lista_avarias = []
    }
    }
}

var the_lista_clean = the_lista_avarias.filter(onlyUnique)

the_lista_clean.sort()


 selectAvarias = document.getElementById('as_avarias');
  
  
    for (var i = 0; i<the_lista_clean.length; i++){
        var opt = document.createElement('option');
        opt.value = the_lista_clean[i]
        opt.innerHTML = the_lista_clean[i]
        selectAvarias.appendChild(opt);
    }
    
    
    
    selectTipo16 = document.getElementById('filtro_nomenclatura');
    
    var thenomes = []
  for (var i = 0; i<os_porta.length; i++){
      
   thenomes.push(os_porta[i].nomenclatura)   
  }
  
  
  
  var lista_seq = []
  var lista_C = []
  for (var i = 0; i<thenomes.length; i++){
      if (thenomes[i].indexOf("C") === -1){
      lista_seq.push(thenomes[i])
      }
  }
  
  lista_seq.sort(function(a,b){
      return parseInt(a) -  parseInt(b); 
  })
  
  
  for (var i = 0; i<thenomes.length; i++){
      if (thenomes[i].indexOf("C") > -1){
      lista_C.push(thenomes[i])
      }
  }
  
 lista_C.sort(function(a,b){
      return parseInt(a.substring(1,a.length)) -  parseInt(b.substring(1,b.length)); 
  }) 
  
  
  
  
    for (var i = 0; i<lista_seq.length; i++){
        var opt = document.createElement('option');
        opt.value = lista_seq[i];
        opt.innerHTML = lista_seq[i];
        selectTipo16.appendChild(opt);
    }
    
    for (var i = 0; i<lista_C.length; i++){
        var opt = document.createElement('option');
        opt.value = lista_C[i];
        opt.innerHTML = lista_C[i];
        selectTipo16.appendChild(opt);
    }
    
    
    
     function preenche_portacliche(osporta){
       var ativos = 0
       var com_avaria = 0
       var inativos = 0
       
        clearTable(document.getElementById("tabela_portacliche"))
          
          
         var table = document.getElementById("tabela_portacliche")
        var qtasrow = table.rows.length
      
            
            for (i=0;i<osporta.length;i++){
            var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
            cell1.colSpan = 1
            cell2.colSpan = 2
            cell3.colSpan = 3
            cell4.colSpan = 2
            cell5.colSpan = 2
             
            var quantas =  osporta[i].cilindros.length
            cell1.innerHTML = '<img id="'+qtasrow+'" src="./Icons/threelittledots.png" width="10px" style="cursor: pointer" onclick="mostraDisclosure()">'
            cell2.innerHTML = '<div style="font-size:1em; text-align: center;"><span style="display: inline-block;">'+quantas+'</span></div>'
            cell3.innerHTML = '<div style="font-size:1em; text-align: center;">'+osporta[i].nomenclatura+'</div>'
            cell4.innerHTML = '<div style="font-size:1em; text-align: center;">'+osporta[i].diametro+'</div>'
            cell5.innerHTML = '<div style="font-size:1em; text-align: center;">'+osporta[i].passo+'</div>'
            qtasrow = qtasrow +1
      
      var cil_linha =   osporta[i].cilindros 
      
      cil_linha.sort(function(a,b){
          return parseInt(a.numero) -  parseInt(b.numero);
      })
      
       var table = document.getElementById("tabela_portacliche")
       var qtasrow = table.rows.length
        
         var row3 =  table.insertRow(qtasrow);
            var cell1_3 = row3.insertCell(0);
            var cell2_3 = row3.insertCell(1);
            var cell3_3 = row3.insertCell(2);
            var cell4_3 = row3.insertCell(3);
            var cell5_3 = row3.insertCell(4);
            var cell6_3 = row3.insertCell(5);
            var cell7_3 = row3.insertCell(6);
            var cell8_3 = row3.insertCell(7);
            var cell9_3 = row3.insertCell(8);
            var cell10_3 = row3.insertCell(9);
            row3.style.display = "none"
         cell1_3.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center;"><strong>Número</strong></div>'
         cell2_3.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center;"><strong>Perímetro</strong></div>'
         cell3_3.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center;"><strong>Distorcido</strong></div>'
         cell4_3.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center;"><strong>Dupla Face</strong></div>'
         cell5_3.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center;"><strong>Status</strong></div>'
         cell6_3.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center;"><strong>Avarias</strong></div>'
         cell7_3.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center;"><strong>Relatório</strong></div>'
         cell8_3.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center;"><strong>Upload</strong></div>'
         cell9_3.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center;"><strong>Editar</strong></div>'
         cell10_3.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center;"><strong>Apagar</strong></div>'
        
      qtasrow = qtasrow +1
      
      for (k=0;k<cil_linha.length;k++){
         var table = document.getElementById("tabela_portacliche")
             var qtasrow = table.rows.length
            
            
            var row2 =  table.insertRow(qtasrow);
            var cell1_2 = row2.insertCell(0);
            var cell2_2 = row2.insertCell(1);
            var cell3_2 = row2.insertCell(2);
            var cell4_2 = row2.insertCell(3);
            var cell5_2 = row2.insertCell(4);
            var cell6_2 = row2.insertCell(5);
            var cell7_2 = row2.insertCell(6);
            var cell8_2 = row2.insertCell(7);
            var cell9_2 = row2.insertCell(8);
            var cell10_2 = row2.insertCell(9);
            //cell1_2.colSpan = 1
            //cell1_2.style = "background-color: lightgray"
            row2.style = "display: none;"
            
            var cordalinha = "green"
            if (cil_linha[k].status == "COM AVARIA"){
                cordalinha = "orange"
                com_avaria = com_avaria+1
            }
            else if (cil_linha[k].status == "INATIVO"){
                cordalinha = "red"
                inativos = inativos+1
            } else {
                ativos = ativos+1
                
            }
            var cordaespessura = "black"
            
            if (cil_linha[k].espessuradupla == "0.50"){
              cordaespessura = "blue"  
            }
            
            
            
            
            cell1_2.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center; color:'+cordalinha+';">'+cil_linha[k].numero+'</div>'
            cell2_2.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center; color:'+cordalinha+';">'+cil_linha[k].perimetro+'</div>'
            cell3_2.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center; color:'+cordalinha+';">'+cil_linha[k].distorcido+'</div>'
            cell4_2.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center; color:'+cordaespessura+';">'+cil_linha[k].espessuradupla+'</div>'
            cell5_2.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center; color:'+cordalinha+';">'+cil_linha[k].status+'</div>'
          if (cil_linha[k].lista_avarias != undefined){
           if (cil_linha[k].lista_avarias.length > 0){
            cell6_2.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center; color:'+cordalinha+';">'+cil_linha[k].lista_avarias.toString()+'</div>'
           } else {
                 cell6_2.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center; color:'+cordalinha+';"></div>'
          
           } 
           } else {
                 cell6_2.innerHTML = '<div style="font-size:1em; cursor: pointer; text-align: center; color:'+cordalinha+';"></div>'
          
           }
            if (cil_linha[k].relatorios === undefined){
            cell7_2.innerHTML = '<div></div>'
            } else {
             var last_report = cil_linha[k].relatorios.length
             cell7_2.innerHTML = '<div><a href="'+cil_linha[k].relatorios[last_report-1].view_url+'" target="_Blank"><img src="Icons/view.png" height="20px"  style="cursor: pointer;"></a></div>'  
            }
            cell8_2.innerHTML = '<div><a href="uploadPDF_Cilindro.html?ordem='+i+'_'+osporta[i]._id+'" target="_Blank"><img src="Icons/upload.png" height="20px"  style="cursor: pointer;"></a></div>'
            cell9_2.innerHTML = '<div><img id="editpc_'+cil_linha[k].indice+'_'+osporta[i]._id+'" src="Icons/edit.png" height="20px" onclick="editar_portacliche()" style="cursor: pointer;"></div>'
            cell10_2.innerHTML = '<div><img id="deletepc_'+cil_linha[k].indice+'_'+osporta[i]._id+'" src="Icons/delete.png" height="20px" onclick="apagar_portacliche()" style="cursor: pointer;"></div>'
           
           
            qtasrow = qtasrow +1
        
        
      }
    }

   preenche_grafico(ativos,com_avaria,inativos)
}
 
 

 
    
  
    
    
    function mostraDisclosure(){
  	 console.log(event.srcElement.id)
        var linha = parseInt(event.srcElement.id)
         
        console.log(linha)
        var table = document.getElementById("tabela_portacliche")
        var linhas = parseInt(table.rows[linha].children[1].innerText)
        console.log(linhas)
        for (i=linha+1;i<linhas+linha+2;i++){
        if (table.rows[i].style.display == "none"){
            table.rows[i].style.display = ""
            
        } else {
            table.rows[i].style.display = "none" 
        }
      }
    }
      
    
     function apagar_portacliche(){
    if (confirm("Deseja mesmo apagar esse porta clichê?") === true){     
    var linha = event.srcElement.id
    var linha_array = linha.split("_")
     var numerocilindro = parseInt(linha_array[1])
     console.log("NUMEERO DO CILINDRO  ---->"+numerocilindro)
    var ID = linha_array[2]
     
      var tira = thedoors.splice(numerocilindro,1)
    if (thedoors.length > 0){
        console.log(" O ID "+ID)
      for (i=0;i<os_porta.length;i++){
          if (os_porta[i]._id == ID){
              os_porta[i].cilindros = thedoors
          }
      }  
    var altera = api.custom_objects.set_keys("BR-VALFI_portacliche",ID,{"cilindros":thedoors})
    preenche_portacliche(os_porta) 
    console.log("ALTEREI "+altera)
    } else {
        for (i=0;i<os_porta.length;i++){
          if (os_porta[i]._id == ID){
              var tira  = os_porta.splice(i,1)
          }
      }  
        api.custom_objects.delete("BR-VALFI_portacliche",ID)
        preenche_portacliche(os_porta) 
    }
   clearTable(document.getElementById("tabela_detalheportacliche"))
   clearTable(document.getElementById("tabela_avarias"))
   avarias_array = []
   document.getElementById("div_tabela_detalhes_pc").style.display = "none"
  
      
    }
     }
    
     function editar_portacliche(){
    
     var linha = event.srcElement.id
     var linha_array = linha.split("_")
     var numeroporta = parseInt(linha_array[1])
     
     var nomethecilinder = ""
     var diametercilinder = ""
     var passo = ""
     var passo_distorcido = ""
     
     for (i=0;i<os_porta.length;i++){
         if (linha_array[2] == os_porta[i]._id){
            nomethecilinder = os_porta[i].nomenclatura
            diametercilinder = os_porta[i].diametro
            passo = os_porta[i].passo
            var indice = i
         }
     }
     
    document.getElementById("id_portacliche").innerText = linha
    
    document.getElementById("info_portacliche").style = "display: inline-block; width: 100%;"
    document.getElementById("nomenclatura_portacliche").value = nomethecilinder
    document.getElementById("distorcido_portacliche").value = os_porta[indice].cilindros[numeroporta].distorcido
    document.getElementById("passo_portacliche").value = passo
    document.getElementById("numero_portacliche").value = os_porta[indice].cilindros[numeroporta].numero
    document.getElementById("diametro_portacliche").value = diametercilinder
    document.getElementById("perimetro_portacliche").value = os_porta[indice].cilindros[numeroporta].perimetro
    document.getElementById("lote_portacliche").value = os_porta[indice].cilindros[numeroporta].lote
    document.getElementById("sleeve_portacliche").value = os_porta[indice].cilindros[numeroporta].sleeve
    document.getElementById("espessuradupla_portacliche").value = os_porta[indice].cilindros[numeroporta].espessuradupla
    document.getElementById("numero_engrenagem").value = os_porta[indice].cilindros[numeroporta].engrenagem
    document.getElementById("observacoes_portacliche").value = os_porta[indice].cilindros[numeroporta].observacoes
    document.getElementById("fornecedor_portacliche").value = os_porta[indice].cilindros[numeroporta].fornecedor
    document.getElementById("status_portacliche").value = os_porta[indice].cilindros[numeroporta].status
    document.getElementById("as_planta_portacliche").value = os_porta[indice].cilindros[numeroporta].plantas
    
     document.getElementById("totalpecas_portacliche").value = os_porta[indice].cilindros.length
     var perimetro = parseFloat(os_porta[indice].cilindros[numeroporta].perimetro.replace(",","."))
    
    
    avarias_array = os_porta[indice].cilindros[numeroporta].lista_avarias
    
    preenche_avarias()
    
    }
    
    function cancelar_portacliche(){
     document.getElementById("nomenclatura_portacliche").value = ""
     document.getElementById("distorcido_portacliche").value = ""
    document.getElementById("numero_portacliche").value = ""
    document.getElementById("perimetro_portacliche").value = ""
    document.getElementById("lote_portacliche").value = ""
    document.getElementById("sleeve_portacliche").value = ""
    document.getElementById("passo_portacliche").value = ""
    document.getElementById("fornecedor_portacliche").value = "undefined"
     document.getElementById("totalpecas_portacliche").value = "0"
     document.getElementById("diametro_portacliche").value = "0"
     document.getElementById("numero_engrenagem").value = ""
       document.getElementById("observacoes_portacliche").value = ""
       avarias_array = []
    
   document.getElementById("div_tabela_detalhes_pc").style.display = "none"
   clearTable(document.getElementById("tabela_detalheportacliche"))
     setTimeout(function(){mostraPortacliche()},1000)
     
    }
    
     function onlyNumberKey(evt) {
          
        // Only ASCII character in that range allowed
        var ASCIICode = (evt.which) ? evt.which : evt.keyCode
        if (ASCIICode > 31 && (ASCIICode < 48 || ASCIICode > 57))
            return false;
        return true;
    }
    
    function calcula_diametro(){
        
        if (planta == "SP1"){
        var perimetro = parseFloat(document.getElementById("perimetro_portacliche").value.replace(",","."))
        
        document.getElementById("diametro_portacliche").value = (perimetro/Math.PI).toFixed(3)
        console.log(perimetro)
        }
        
    }
    
    function busca_portacliche(){
       var qtepecas = api.custom_objects.list("BR-VALFI_portacliche",["nomenclatura","equal to",document.getElementById("nomenclatura_portacliche").value]).results
        document.getElementById("totalpecas_portacliche").value = qtepecas[0].cilindros.length+1
        document.getElementById("passo_portacliche").value = qtepecas[0].passo
        document.getElementById("passo_portacliche").readOnly = true;
        document.getElementById("perimetro_portacliche").value = qtepecas[0].cilindros[0].perimetro
        document.getElementById("perimetro_portacliche").readOnly = true;
        document.getElementById("distorcido_portacliche").value = qtepecas[0].cilindros[0].distorcido
        document.getElementById("distorcido_portacliche").readOnly = true;
        document.getElementById("diametro_portacliche").value = qtepecas[0].diametro
        var ultimo = parseInt(qtepecas[0].cilindros[qtepecas[0].cilindros.length-1].numero)
        document.getElementById("numero_portacliche").value = ultimo+1
        
    }
    
    function fecha_pc(){
       clearTable(document.getElementById("tabela_detalheportacliche"))
       document.getElementById("div_tabela_detalhes_pc").style ="display:none;"
       
         
    }
    
    
</script>
<script>

 function  preenche_grafico(ativo,com_avaria,inativo){
     var infograf = [ativo,com_avaria,inativo]

    document.getElementById("total_ativos").value = ativo
    document.getElementById("total_avaria").value = com_avaria
    document.getElementById("total_inativos").value = inativo



    	var config = {
			type: 'pie',
			data: {
				datasets: [{
					data: infograf,
					backgroundColor: [
						window.chartColors.green,
						window.chartColors.orange,
						window.chartColors.red,
					],
					label: 'Dataset 1'
				}],
				labels: [
					'Liberado',
					'Com Avaria',
					'Inativo',
				]
			},
			options: {
				responsive: true,
				title: "Estado dos Cilindros"
			}
		};
		
		
		new Chart("chart-area", config);
		
		//	var ctx = document.getElementById('chart-area').getContext('2d');
			
			
			
		//	window.myPie = new Chart(ctx, config);
    
    var div_cliente = document.getElementById("info_portacliche")
	if (div_cliente.style.display == "inline-block"){
       mostraPortacliche()
   }
   
   }
</script>
<script>
preenche_portacliche(os_porta)

function filtrar_pc(){
    var nomenclatura = document.getElementById("filtro_nomenclatura").value
        console.log(nomenclatura)
        if (nomenclatura != "TODOS"){
        console.log("Estou em todos")
        for (i=0;i<os_porta.length;i++){
         if (os_porta[i].nomenclatura == nomenclatura){
            var tira = os_porta.splice(i,1)
            console.log("to fazendo o splice")
            console.log(tira.length)
         }   
        }
        } else {
            console.log("Não estou em todos")
            var tira = os_porta
        }
        
        
    
    
    var status_pc = document.getElementById("filtro_status").value
    console.log(status_pc)
    if (status_pc != "TODOS"){
        var quais_tira = []
        console.log("qtde de tira")
        console.log(tira.length)
        for (i=0;i<tira.length;i++){
            var tira_cils = tira[i].cilindros
            var resultado = tira_cils.filter(function(x){
             return x.status == status_pc;
                })
            console.log(resultado.length)
            tira[i]["cilindros"] = resultado
        }
     console.log(tira)   
    }
    
    
    var dupla = document.getElementById("filtro_dupla").value
    
    if (dupla != "TODAS"){
        var quais_tira = []
        console.log("qtde de tira")
        console.log(tira.length)
        for (i=0;i<tira.length;i++){
            var tira_cils = tira[i].cilindros
            var resultado = tira_cils.filter(function(x){
             return x.espessuradupla == dupla;
                })
            console.log(resultado.length)
            tira[i]["cilindros"] = resultado
        }
     console.log(tira)   
    }
    
    
  os_porta = api.custom_objects.list_with_options("BR-VALFI_portacliche").results
   preenche_portacliche(tira)
}

function removeItem(array, item) {
  for(i = 0; i<array.length; i++){
    if(array[i] == item) {
      array.splice(array.indexOf(item), 1);
    }
  }
}

</script>
<script>
var avarias_array = []
    function adiciona_avaria(){
       var existe = false
       for (i=0;i<avarias_array.length;i++){
           if (avarias_array[i] == document.getElementById("as_avarias").value){
               existe = true
           }
       }
       if (existe === false){
        avarias_array.push(document.getElementById("as_avarias").value)
        preenche_avarias()
       } else {
           alert("Essa avaria já foi adicionada a lista!")
       }
    }

function preenche_avarias(){
    
     clearTable(document.getElementById("tabela_avarias"))
       if (avarias_array.length === 0){
           document.getElementById("mostra_tabela_avarias").style.display = "none"
       } else {
           
        document.getElementById("mostra_tabela_avarias").style.display = "inline-block"
          
         var table = document.getElementById("tabela_avarias")
        var qtasrow = table.rows.length
      
      
            
            for (i=0;i<avarias_array.length;i++){
            var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
           
             
            cell1.innerHTML = '<div style="font-size:1em; text-align: center;">'+avarias_array[i]+'</div>'
            cell2.innerHTML = '<div><img id="'+i+'" src="Icons/delete.png" height="20px" onclick="apagar_avaria()" style="cursor: pointer;"></div>'
           
            qtasrow = qtasrow +1
            }
       }
}

function apagar_avaria(){
    var linha = parseInt(event.srcElement.id)
    var tira = avarias_array.splice(linha,1)
    preenche_avarias()
}
</script>




    </body>

</html>