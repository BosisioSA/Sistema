<!doctype html>
<html>
    <head>
      <title>Visualiza OT</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      
      <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
      <link rel="stylesheet" href="css/style.css">
      <link rel="stylesheet" href="css/table.css">
        <link href="css/bootstrap4-toggle.min.css" rel="stylesheet">
    
        <meta name="viewport" content="width=944">
        <meta name="robots" content="noindex, follow">
	<link rel="Shortcut icon" href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/favicon.ico" type="image/x-icon">
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon.png" rel="apple-touch-icon" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-idecon-precomposed" sizes="72x72" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144" />
        <link rel="stylesheet" href="fonts/fontawesome-all.min.css">
        <link rel="stylesheet" href="fonts/font-awesome.min.css">
        <link rel="stylesheet" href="fonts/fontawesome5-overrides.min.css">
        <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
        <link href="https://use.fontawesome.com/releases/v5.0.1/css/all.css" rel="stylesheet">
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/jscolor.js"></script>
        <script src="js/html-duration-picker.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/example-styles.css">
    <link rel="stylesheet" type="text/css" href="css/demo-styles.css">
    <!--<link rel="stylesheet" type="text/css" href="css/chat.css">-->
        <style>
            .multi-select-button:after {
              margin-left: 7px;  
            }
        </style> 
       <script type="text/javascript" src="js/jquery-2.2.4.min.js"></script>
 
        <script src="/portal.cgi/PP_FILE_STORE/Sistema/assets/js/vendor/modernizr-2.6.2.min.js"></script>
      	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-1.8.3.min.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-ui-1.9.2.custom.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.cookie.js'></script>
    	<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.4.2/chroma.min.js'></script>
    <!-- portal.js -->
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-linedtextarea.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/codemirror.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/javascript.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.tmpl.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-regex.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/sitemapstyler.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/date.format.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.iframe-transport.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.fileupload.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.notify.min.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.event.drag-2.2.js'></script>
        <script type='text/javascript' src='/portal.cgi?api=js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/portal/js/nixps-portal-api.js'></script>
        <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.i18n.js'></script>
         <script src="js/bootstrap4-toggle.js"></script>
    
        <script>
            var today = new Date();
        </script>
       
   <script>
            var queryString = window.location.search;
            var ordem = decodeURI(queryString.substring(7,queryString.length))
        </script>
    

 <script>
           function logout () {
        	$.cookie('user_id','', { expires: -1, path: '/' });
        	$.cookie('user_hash','', { expires: -1, path: '/' });
        	$.cookie('expiration_date','', { expires: -1, path: '/' });
        	$.cookie('customer_id','', { expires: -1, path: '/' });
        	$.cookie('customer_name', '', { expires: -1 , path: '/' });
       		$.cookie('username', '', { expires: -1 , path: '/' });
        	$.cookie('scope', '', { expires: -1 , path: '/' });
        	window.location = 'http://vpn3.bosisio.com.ar:9090/portal.cgi/PP_FILE_STORE/Public/Login/login.html';
    	  }
		

      </script>
    </head>


    <body>

  		<div class="wrapper d-flex align-items-stretch">
  			<nav id="sidebar">
  				<div class="p-4 pt-5">
            <img>
  		  		<img src="./logo//logo_bosisio.png" style="width: 90%; margin-bottom: 50px;">
             
                  <ul class="active components mb-5">
              <li style="list-style-type: none">
               <a href="ordenes_dash.html"><img src="./Icons/ticket_dg.png" width="30px" style="margin-right: 5px;">Dashboard OTs</a>
              </li>
             
               <li  class="active" style="list-style-type: none">
               <a href="Nueva_OT.html"><img src="./Icons/entrada_ticket.png" width="30px" style="margin-right: 5px;">Nueva OT</a>
              </li>
             
               <!--    <li  style="list-style-type: none">
               <a href="reuniao_dg_mg4.html"><img src="./Icons/liberado_reuniao.png" width="20px" style="margin-right: 5px;">Reunião DG</a>
              </li> --> 
                    </ul>
                
        <div style="width: 100%; margin: auto">
            <div style="width: 80%; margin: auto">
               <a href id="link_view" target="_Blank" style="cursor: pointer"><img id="preview" src="" style="max-width: 100%; max-height: 300px;"></a>
            </div>
        </div>      
                    
       
   
  	        <div class="footer">
  	        	<p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0.
  						  Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib.com</a>
  						   Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
  	        </div>
  	      </div>
      	</nav>

          <!-- Page Content  -->
      <div id="content" class="p-4 p-md-5">

          <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">

              <button type="button" id="sidebarCollapse" class="btn btn-primary">
                <i class="fa fa-bars"></i>
                <span class="sr-only">Toggle Menu</span>
              </button>
              <button class="btn btn-dark d-inline-block d-lg-none ml-auto" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <i class="fa fa-bars"></i>
              </button>
              <div id="bemvindo" style="margin-left: 20px;"></div>

              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav ml-auto">
                 
                  <li class="nav-item">
                      <a class="nav-link" href="cambiar_pwd.html" target="_Blank">Cambiar Contraseña</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" onclick="logout()">Logout</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
          <div>
    <div style="padding-left: 2%; padding-right: 2%;">        
    <div id="info_testform" class="form-group" style="display: inline-block; width: 100%">
   <div style="display: inline-block; margin-right: 1%"><span id="liberado" style="vertical-align: baseline;height:25px;width:25px;background-color:green;border-radius:50%;display:inline-block"></span></div>
   <h3 style="display: inline-block; margin-leftt: 5%" id="titulo"></h3>
    <div class="tabset">
  <!-- Tab 1 -->
  <input type="radio" name="tabset"  id="01" aria-controls="prateleira_01" checked>
  <label for="01">Info Trabajo</label>
  <input type="radio" name="tabset"  id="02" aria-controls="prateleira_02">
  <label for="02">Datos Técnicos</label>
  <input type="radio" name="tabset"  id="03" aria-controls="prateleira_03">
  <label for="03">Info Arte</label>
  <input type="radio" name="tabset" onclick="preenche_tabela_receita()" id="04" aria-controls="prateleira_04">
  <label for="04">Colores</label>
  <input type="radio" name="tabset" onclick="preenche_indicaciones()" id="05" aria-controls="prateleira_05">
  <label  for="05">Indicaciones</label>
  <input type="radio" name="tabset"  onclick="llena_carpetasproduccion()" id="06" aria-controls="prateleira_06">
  <label for="06">Preprensa</label>
  <input type="radio" name="tabset"   id="07" aria-controls="prateleira_07">
  <label for="07">Aprobaciones</label>
  <input type="radio" name="tabset"  id="08" aria-controls="prateleira_08">
  <label for="08">GPS</label>
  <input type="radio" name="tabset"  onclick="preenche_chats_existentes()" id="09" aria-controls="prateleira_09">
  <label style="display: none" for="09">Chat</label>
  
  
  
  <div class="tab-panels">
    
   
    <section id="prateleira_01" class="tab-panel">
        
         <!-- Informacion Cliente -->
    
      <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px">
        <h5 style="margin-top: -9px;"><img src="./Icons/clientes.png" width="30px" style="display: inline-block; margin-right: 5px"><strong>Informaciones del Cliente</strong></h5>
    
        <div  class="form-group " style="display:inline-block;  width: 49%;vertical-align: top; margin-right: 1%">
                <label for="cliente">Cliente<sup>*</sup></label>
                   <input type="text" class="form-control" id="cliente"  onkeyup="this.value=this.value.toUpperCase()" onchange="llena_perfiles()"  name="cliente" list="os_clientes">
                   <datalist id="os_clientes"></datalist>
                   <span class="error" id="error_cliente"></span>
                 </div>
                  
                    <div  class="form-group " style="display:inline-block;  width: 49%;vertical-align: top;">
                <label for="impresor">Impresor<sup>*</sup></label>
                   <input type="text" class="form-control" id="impresor"  onkeyup="this.value=this.value.toUpperCase()" onchange="llena_perfiles()"  name="impresor" list="os_impresores">
                   <datalist id="os_impresores"></datalist>
                   <span class="error" id="error_cliente"></span>
                 </div>
                  
                 <div  class="form-group" style="display:inline-block; width: 25%; vertical-align: top;">
                <label for="tipo_ordem">Tipo Orden</label>
                   <input type="text" class="form-control" id="tipo_ordem" onchange="muda_tipoordem()" name="tipo_ordem">
                 </div>
                 
                
        
       
   
    <div  class="form-group" style="display:inline-block; width: 30%; vertical-align: top margin-left: 1%;">
                <label for="tipo_trabajo">Tipo Trabajo<sup>*</sup></label>
                   <input type="text" class="form-control" id="tipo_trabajo"  onchange="cambia_tipo_trabajo()" name="tipo_trabajo">
                 </div>
    <div id="div_ordenanterior"  class="form-group" style="display:none; width: 25%; vertical-align: top; margin-left: 1%">
                <label for="orden_anterior">Orden Anterior<sup>*</sup></label>
                   <input type="text" class="form-control" id="orden_anterior" onfocusout="llena_datos_orden()" name="orden_anterior" >
    </div>
    
       <div id="div_codigoanterior"  class="form-group" style="display:none; width: 19%; vertical-align: top; margin-left: 1%">
                <label for="codigo_anterior">Código SAP</label>
                   <input type="text" class="form-control" id="codigo_anterior" onfocusout="busca_codigo_anterior()" name="codigo_anterior">
                    
    </div>
        </div>
   
   
   
   <!-- Informacion Trabajo -->
        
   <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px">
        <h5 style="margin-top: -9px;"><img src="./Icons/entrada_ticket.png" width="30px" style="display: inline-block; margin-right: 5px"><strong>Informaciones del Trabajo</strong></h5>
    
  
    <div  class="form-group" style="display:inline-block;  width: 58%; vertical-align: top;">
                <label for="nombre_producto">Nombre del Producto<sup>*</sup></label>
                   <input type="text" class="form-control" id="nombre_producto" onkeyup="this.value=this.value.replace(/[^a-zA-Z0-9,_ ]/g, '')" name="nombre_producto">
                 </div>
                 
            <div  class="form-group" style="display:inline-block;  width: 40%; vertical-align: top; margin-left: 1%;">
                <label for="codigo_producto">Código del Producto<sup>*</sup></label>
                   <input type="text" class="form-control" id="codigo_producto" onkeyup="this.value=this.value.replace(/[^a-zA-Z0-9,_ ]/g, '')" name="codigo_producto">
                 </div>
    <div  class="form-group" style="display:inline-block; width: 30%; vertical-align: top;">
                <label for="prioridad">Prioridade<sup>*</sup></label>
                   <input type="text" class="form-control" id="prioridad"  name="prioridad">
                 </div>
                 <div  class="form-group demo-example" style="display:inline-block; width: 68%;margin-left: 1%">
               <label for="polimeros_con">Enviar Polímeros Con</label>
            <input type="text" class="form-control" id="polimeros_con"   name="polimeros_con">
        </div>
            <div  class="form-group demo-example" style="display:inline-block; width: 99%;">
               <label for="producto">Producto</label>
            <input type="text" class="form-control" id="producto"   name="producto" multiple>
             
        </div>
            <div  class="form-group demo-example" style="display:inline-block; width: 99%;">
               <label for="requiere">Requiere</label>
            <input type="text" class="form-control" id="requiere"   name="requiere" multiple>
              
        </div>
    </div>
    

     </section>
   
    <section id="prateleira_02" class="tab-panel">
             <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px">
        <h5 style="margin-top: -9px;"><img src="./Icons/premeet.png" width="30px" style="display: inline-block; margin-right: 5px"><strong>Datos Técnicos</strong></h5>
       
       
       
        
       
         <div  class="form-group" style="display:none; width: 21%; vertical-align: top;">
    <label>Gama Expandida</label><br>
        <div class="form-check form-check-inline">
        <input type="text" name="gama_expandida" onchange="es_gamaexpandida()"  id="gamaexpandida_si" value="Si">
        <label class="form-check-label" for="gamaexpandida_si">Si</label>
    </div>
    <div class="form-check form-check-inline">
        <input type="text" name="gama_expandida" onchange="es_gamaexpandida()" id="gamaexpandida_no" value="No">
        <label class="form-check-label" for="gamaexpandida_no">No</label>
    </div>
    </div>
    
    <div id="div_gamaexpandida"  class="form-group" style="display:none; width: 25%; vertical-align: top; margin-right: 1%">
                <label for="color_gamaexpandida">Colores<sup>*</sup></label>
                   <input type="text" class="form-control" id="color_gamaexpandida" onchange="llena_nombre()" name="color_gamaexpandida">
    </div>
    
  
           <div id="div_perfil" class="form-group" style="display:inline-block; width: 50%; vertical-align: top;">
                <label for="informacion_impresion">Información Impresión<sup>*</sup></label>
                   <input type="text" class="form-control" id="informacion_impresion" onchange="llena_nombre()"  name="informacion_impresion">
            </div>
            <br>
        <div id="div_nombreperfil" class="form-group" style="display:inline-block;  width: 98%; vertical-align: top;">
                <label for="nombre_perfil">Nombre Perfil</label>
                   <input type="text" class="form-control"  id="nombre_perfil" name="nombre_perfil" readonly>
                 </div>
        <div id="div_aviso" class="form-group" style="display:none;  width: 98%; vertical-align: top; background-color: red; color: yellow; text-align: center; font-size: 1.2em; padding-top:10px">
        <p><strong>No se permite editar perfiles en el curso de la orden. Sin embargo, los cambios realizados se van a grabar como una modificación del proceso standarizado del cliente. Apenas realize cambios si estás seguro que no tienen un impacto en la calidad del trabajo.
        </strong></p></div>
        <br>
         <div  class="form-group" style="display:inline-block;  width: 35%; vertical-align: top;">
                <label for="material">Material</label>
                   <input type="text" class="form-control" id="material" name="material" onfocusout="calcula_cambio_perfil()" readonly list="materialcliente">
                   <datalist id="materialcliente"></datalist>
                 </div>
                  <div  class="form-group" style="display:inline-block;  width: 20%; vertical-align: top; margin-left: 1%">
                <label for="sentido">Sentido Impresión</label>
                   <input type="text" class="form-control" id="sentido" name="sentido" onfocusout="calcula_cambio_perfil()" readonly list="ladoimpcliente">
                   <datalist id="ladoimpcliente">
                       <option value="FRENTE"></option>
                       <option value="DORSO"></option>
                   </datalist>
                 </div>
                   <div  class="form-group" style="display:inline-block;  width: 24%; vertical-align: top; margin-left: 1%">
                <label for="maquina">Máquina</label>
                   <input type="text" class="form-control" id="maquina" name="maquina" onfocusout="calcula_cambio_perfil()" readonly list="maquinascliente">
                 <datalist id="maquinascliente"></datalist>
                 </div>
                   <div  class="form-group" style="display:inline-block;  width: 15%; vertical-align: top;margin-left: 1%">
                <label for="lineatura">Lineatura</label>
                   <input type="text" class="form-control" id="lineatura" name="lineatura" onfocusout="calcula_cambio_perfil()" readonly list="lineaturacliente">
                <datalist id="lineaturacliente"></datalist>
                 </div>
                  <div  class="form-group" style="display:inline-block;  width: 18%; vertical-align: top;">
                <label for="fabricante_polimero">Fabricante Fotopolímero</label>
                   <input type="text" class="form-control" id="fabricante_polimero" name="fabricante_polimero" onfocusout="calcula_cambio_perfil()"  readonly list="fabricanetepolimetocliente">
                    <datalist id="fabricanetepolimetocliente">
                        <option value="KODAK"></option>
                        <option value="DUPONT"></option>
                        <option value="XSYS"></option>
                        <option value="MCDERMID"></option>
                    </datalist>
                 </div>
                  <div  class="form-group" style="display:inline-block;  width: 16%; vertical-align: top;margin-left: 1%">
                <label for="espesor_polimero">Espesor Polímero</label>
                   <input type="text" class="form-control" id="espesor_polimero" name="espesor_polimero" onfocusout="calcula_cambio_perfil()" readonly list="espessorpolimetocliente">
                    <datalist id="espessorpolimetocliente">
                    </datalist>
                
                 </div>
                  <div  class="form-group" style="display:inline-block;  width: 21%; vertical-align: top;margin-left: 1%">
                <label for="fabricante_polimeroblanco">Fab. Polímero Blanco</label>
                   <input type="text" class="form-control" id="fabricante_polimeroblanco" name="fabricante_polimeroblanco" onfocusout="calcula_cambio_perfil()"  readonly list="fabricanetepolblancocliente">
                     <datalist id="fabricanetepolblancocliente">
                        <option value="KODAK"></option>
                        <option value="DUPONT"></option>
                        <option value="XSYS"></option>
                        <option value="MCDERMID"></option>
                     </datalist>
               
                 </div>
                  <div  class="form-group" style="display:inline-block;  width: 23%; vertical-align: top;margin-left: 1%">
                <label for="fabricante_polimerobarniz">Fab. Polímero Barniz</label>
                   <input type="text" class="form-control" id="fabricante_polimerobarniz" name="fabricante_polimerobarniz" onfocusout="calcula_cambio_perfil()" readonly list="fabricanetepolbarnizcliente">
                   <datalist id="fabricanetepolbarnizcliente">
                       <option value="KODAK"></option>
                        <option value="DUPONT"></option>
                        <option value="XSYS"></option>
                        <option value="MCDERMID"></option>
                   </datalist>
               
                 </div>
                 <div  id="div_lapis" class="form-group" style="display:none;  width: 13%;margin-left: 1%">
              <img src="./Icons/edit.png" width="30px" style="cursor: pointer; margin-top: 37px" onclick="edit_perfil()">
              
              </div>
       
       </div>  
   
   
     </section>
     
     <section id="prateleira_03" class="tab-panel">
            <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px">
        <h5 style="margin-top: -9px;"><img src="./Icons/infoarte.png" width="30px" style="display: inline-block; margin-right: 5px"><strong>Informaciones del Arte</strong></h5>
    
         <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px">
        <p><strong>Corte</strong></p>
         <div  class="form-group" style="display:inline-block;  width: 19%; margin-right: 1%;">
                <label for="medida_corte">Medidas</label>
                   <input type="text" class="form-control" id="medida_corte" name="medida_corte" onfocusout="calcula_total_corte()" onkeyup="this.value=this.value.replace(/[^0-9,.]/g, '')" >
                 </div>
                  <div  class="form-group" style="display:inline-block;  width: 19%; margin-right: 1%;">
                <label for="repeticion_corte">Repetición</label>
                   <input type="text" class="form-control" id="repeticion_corte" name="repeticion_corte" onfocusout="calcula_total_corte()"  onkeyup="this.value=this.value.replace(/[^0-9]/g, '')" >
                 </div>
                  <div  class="form-group" style="display:none;  width: 19%; margin-right: 1%;">
                <label for="marcas_corte">Marcas</label>
                   <input type="number" class="form-control" id="marcas_corte" name="marcas_corte" onfocusout="calcula_total_corte()"  onkeyup="this.value=this.value.replace(/[^0-9,]/g, '')" value="6" step="0.5">
                 </div>
                  <div  class="form-group" style="display:inline-block;  width: 19%; margin-right: 1%;">
                <label for="total_corte">Medida Total</label>
                   <input type="text" class="form-control" id="total_corte" name="total_corte" readonly>
                 </div>
                  <div  class="form-group" style="display:inline-block;  width: 19%;margin-right: 1%; ">
                <label for="deformacionmedida_corte">Medidas Deformación</label>
                   <input type="text" class="form-control" id="deformacionmedida_corte" name="deformacionmedida_corte"  readonly>
                 </div>
                  <div  class="form-group" style="display:inline-block;  width: 18%; ">
                <label for="deformacionfactor_corte">Factor Deformación</label>
                   <input type="number" class="form-control" id="deformacionfactor_corte" name="deformacionfactor_corte" onfocusout="calcula_total_corte()" value="1.000" step="0.001" >
                 </div>
        
        </div>
      
      
         <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px;">
        <p><strong>Desarollo</strong></p>
         <div  class="form-group" style="display:inline-block;  width: 19%; margin-right: 1%;">
                <label for="medida_desarollo">Medidas</label>
                   <input type="text" class="form-control" id="medida_desarollo" name="medida_desarollo" onfocusout="calcula_total_desarollo()"  onkeyup="this.value=this.value.replace(/[^0-9,.]/g, '')" >
                 </div>
                  <div  class="form-group" style="display:inline-block;  width: 19%;margin-right: 1%; ">
                <label for="repeticion_desarollo">Repeticiones</label>
                   <input type="text" class="form-control" id="repeticion_desarollo" name="repeticion_desarollo" onfocusout="calcula_total_desarollo()" onkeyup="this.value=this.value.replace(/[^0-9]/g, '')" >
                 </div>
                  <div  class="form-group" style="display:inline-block;  width: 19%; margin-right: 1%;">
                <label for="total_desarollo">Medida Total L</label>
                   <input type="text" class="form-control" id="total_desarollo" name="total_desarollo"  readonly>
                 </div>
                  <div  class="form-group" style="display:inline-block;  width: 19%; margin-right: 1%;">
                <label for="deformacionmedida_desarollo">Medidas Deformación</label>
                   <input type="text" class="form-control" id="deformacionmedida_desarollo" name="deformacionmedida_desarollo"  onkeyup="this.value=this.value.replace(/[^0-9,]/g, '')"  readonly>
                 </div>
                  <div  class="form-group" style="display:inline-block;  width: 18%; ">
                <label for="deformacionfactor_desarollo">Factor Deformación</label>
                   <input type="number" class="form-control" id="deformacionfactor_desarollo" name="deformacionfactor_desarollo"  onfocusout="calcula_total_desarollo()"  value="1.000" step="0.001">
                 </div>
        
        </div>
       
         <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px; margin-left: 1%">
          <div  class="form-group" style="display:inline-block;  width: 43%; vertical-align:top; margin-right: 1%"> 
          <p><strong>Dimensiones Fotocélula</strong></p>
          
          <div  class="form-group" style="display:none;  width: 22%; vertical-align: top;">
                   <input type="checkbox" class="form-group" id="fotocelula_seaplica" name="fotocelula_seaplica" onchange="mostra_aplica()" checked >
                    <label for="fotocelula_seaplica">No se aplica</label>
               
        </div>
        <div id="div_dimensoes_taco" style="display: inline-block; width: 77%;vertical-align: top;">
           <div  class="form-group" style="display:inline-block;  width: 49%; margin-right: 1%; ">
                <label for="ancho_fotocelula">Ancho</label>
                   <input type="text" class="form-control" id="ancho_fotocelula" name="ancho_fotocelula" onkeyup="this.value=this.value.replace(/[^0-9,.]/g, '')" >
                 </div>
          
           <div  class="form-group" style="display:inline-block;  width: 48%;">
                <label for="alto_fotocelula">Alto</label>
                   <input type="text" class="form-control" id="alto_fotocelula" name="alto_fotocelula" onkeyup="this.value=this.value.replace(/[^0-9,.]/g, '')" >
                 </div>
          
          <div  class="form-group" style="display:inline-block;  width: 49%; margin-right: 1%;">
                <label for="fotocelula_caladotintas">F.C. Calado Tintas</label>
                   <input type="text" class="form-control" id="fotocelula_caladotintas" name="fotocelula_caladotintas" onkeyup="this.value=this.value.replace(/[^0-9,.]/g, '')" >
                 </div>
                 
            <div  class="form-group" style="display:inline-block;  width: 48%;">
                <label for="fotocelula_caladobarniz">F.C. Calado Barniz</label>
                   <input type="text" class="form-control" id="fotocelula_caladobarniz" name="fotocelula_caladobarniz" onkeyup="this.value=this.value.replace(/[^0-9,.]/g, '')" >
                 </div>
         
         
          <div  class="form-group" style="display:inline-block;  width: 98%;">
                <label for="color_calle">Color Calle</label>
                   <input type="text" class="form-control" id="color_calle" name="color_calle" >
                 </div>
          </div>
          </div>
      
         <div  class="form-group" style="display:inline-block;  width: 55%; vertical-align:top">
        <p><strong>Ubicación Fotocélula</strong></p>
        <div  class="form-group" style="display:none;  width: 100%; ">
                   <input type="checkbox" class="form-group" id="fotocelula_segunplano" name="fotocelula_segunplano" onchange="mostra_fotocelula()" disabled>
                    <label for="fotocelula_segunplano">Según Plan Mecânico</label>
               
        </div>
                   <div id="mostra_fotocelula1" style ="width: 100%; display: none">
                    <div style="height: 50px; margin-left: 50px; display: inline-block;">
                        
                    
                        <div style="width: 20px;display: inline-block; cursor: pointer">
                            <span id="90ES"  style="margin-top:5px;height:50px;width:20px;background-color:lightgray;display:inline-block">
                            </span>
                        </div>
                        <div style="width: 40px;display: inline-block;">
                        </div>
                        <div style="width: 20px;display: inline-block; ; cursor: pointer">
                            <span id="90CS"   style="margin-top:5px;height:50px;width:20px;background-color:lightgray;display:inline-block">
                            </span>
                        </div>
                        <div style="width: 40px;display: inline-block;">
                        </div>
                         <div style="width: 20px;display: inline-block; ; cursor: pointer">
                            <span id="90DS"   style="margin-top:5px;height:50px;width:20px;background-color:lightgray;display:inline-block">
                            </span>
                        </div>
                        <div style="width: 50px;display: inline-block;">
                        </div>
                </div>
            </div>
            <div id="mostra_fotocelula2" style="width: 100%;display: none">
            <div style ="width: 50px; height: 200px; display: inline-block;">
                <div style="width: 50px;display: inline-block; ; cursor: pointer">
                            <span id="0ES"   style="margin-top:5px;height:20px;width:50px;background-color:lightgray;display:inline-block">
                            </span>
                </div>
                <div style="height 70px:width: 50px;display: inline-block;">
                    <span  style="margin-top:5px;height:50px;width:50px;background-color:#FAFAFA;display:inline-block">
                            </span>
                        </div>
               <div style="width: 50px;display: inline-block; ; cursor: pointer">
                            <span id="0EC"   style="margin-top:5px;height:20px;width:50px;background-color:lightgray;display:inline-block">
                            </span>
                </div>
                <div style="height 70px:width: 50px;display: inline-block;">
                    <span  style="margin-top:5px;height:50px;width:50px;background-color:#FAFAFA;display:inline-block">
                            </span>
                        </div>
                <div style="width: 50px;display: inline-block;; cursor: pointer">
                            <span id="0EI"   style="margin-top:5px;height:20px;width:50px;background-color:lightgray;display:inline-block">
                            </span>
                </div>
            </div>
            <div style ="width: 160px; height: 220px; display: inline-block; vertical-align: top;">
                <img src="./Icons/A.png" width="100%">
                </div>
            <div style ="width: 50px; height: 200px; display: inline-block;">
                <div style="width: 50px;display: inline-block;; cursor: pointer">
                            <span id="0DS"   style="margin-top:5px;height:20px;width:50px;background-color:lightgray;display:inline-block">
                            </span>
                </div>
                <div style="height 70px:width: 50px;display: inline-block;">
                    <span  style="margin-top:5px;height:50px;width:50px;background-color:#FAFAFA;display:inline-block">
                            </span>
                        </div>
               <div style="width: 50px;display: inline-block;; cursor: pointer">
                            <span id="0DC"   style="margin-top:5px;height:20px;width:50px;background-color:lightgray;display:inline-block">
                            </span>
                </div>
                <div style="height 70px:width: 50px;display: inline-block;">
                    <span  style="margin-top:5px;height:50px;width:50px;background-color:#FAFAFA;display:inline-block">
                            </span>
                        </div>
                <div style="width: 50px;display: inline-block;; cursor: pointer">
                            <span id="0DI"   style="margin-top:5px;height:20px;width:50px;background-color:lightgray;display:inline-block">
                            </span>
                </div>
            </div>
            </div>
            <div id="mostra_fotocelula3" style="width: 100%;display: none">
                    <div style="height: 50px; margin-left: 50px; display: inline-block;">
                        
                    
                        <div style="width: 20px;display: inline-block;; cursor: pointer">
                            <span id="90EI"   style="margin-top:5px;height:50px;width:20px;background-color:lightgray;display:inline-block">
                            </span>
                        </div>
                        <div style="width: 40px;display: inline-block;">
                        </div>
                        <div style="width: 20px;display: inline-block;; cursor: pointer">
                            <span id="90CI"   style="margin-top:5px;height:50px;width:20px;background-color:lightgray;display:inline-block">
                            </span>
                        </div>
                        <div style="width: 40px;display: inline-block;">
                        </div>
                         <div style="width: 20px;display: inline-block;; cursor: pointer">
                            <span id="90DI"  q style="margin-top:5px;height:50px;width:20px;background-color:lightgray;display:inline-block">
                            </span>
                        </div>
                        <div style="width: 50px;display: inline-block;">
                        </div>
                </div>
            </div>
            
      
        </div>
          <div  class="form-group" style="display:inline-block;  width: 40%; vertical-align:top">
         </div>
       </div>
        
        
        <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px;">
          
         
        <div class="form-group" style="display:inline-block; vertical-align: top; width: 12%; margin-right: 1%">
        <p><strong>Pié Imprenta</strong></p>
        <label  for="pie_imprenta_si">LLeva Pié</label>
        <input class="form-control" type="text" name="existe_pieimprenta"  id="pie_imprenta_si">
        
    </div>
     <div class="form-group" style="display:none; vertical-align: top; width: 12%; margin-right: 1%">
        
        <label class="form-check-label" for="pie_imprenta_si">Pie Imprenta</label>
        <input type="text" name="existe_pieimprenta"  id="pie_imprenta_no">
        
    </div>
   

        
      <div id="div_pie_imprenta" style="display: inline-block; width: 86%">
         <div  class="form-group" style="display:inline-block;  width: 30%; vertical-align: top; margin-right: 1%">
          <p><strong>Dimensiones</strong></p>
           <div  class="form-group" style="display:inline-block;  width: 49%; vertical-align: top; margin-right: 1%">
                <label for="ancho_pie">Ancho</label>
                   <input type="text" class="form-control" id="ancho_pie" name="ancho_pie" onkeyup="this.value=this.value.replace(/[^0-9,.]/g, '')" >
                 </div>
          
           <div  class="form-group" style="display:inline-block;  width: 48%; ">
                <label for="alto_pie">Alto</label>
                   <input type="text" class="form-control" id="alto_pie" name="alto_pie" onkeyup="this.value=this.value.replace(/[^0-9,.]/g, '')" >
                 </div>
         </div>
         <div  class="form-group" style="display:inline-block;  width: 68%; vertical-align: top;">
          <p><strong>Información Pié de Imprenta</strong></p>
          
         
         <div  class="form-group" style="display:inline-block;  width: 35%; ">
                <label for="posicion_pie">Ubicación</label>
                   <input type="text" class="form-control" id="posicion_pie" name="posicion_pie" onkeyup="this.value=this.value.toUpperCase()" >
                 </div>
                <div  class="form-group" style="display:inline-block;  width: 63%; ">
                <label for="texto_pie">Texto</label>
                   <input type="text" class="form-control" id="texto_pie" name="texto_pie" onkeyup="this.value=this.value.toUpperCase()" >
                 </div>
        <div class="form-group" style="display:inline-block;  width: 35%;">
                  <label  for="pie_caladotintas">Calado Tintas</label>
                  <input class="form-control"  type="text"   id="pie_caladotintas" value="pie_caladotintas">
        </div>
          </div>      
         </div> 
         
          </div>
       
       <div style="background-color: #FAFAFA;  width: 34%;display: inline-block; vertical-align: top; margin-right: 1%">
        <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px;">
        <p><strong>Linea de Refile</strong></p>
          <div class="form-group" style="display:inline-block; vertical-align: top; width: 31%; margin-right: 1%">
        <label for="linea_refile_si">Lleva Linea</label>
        <input type="text" class="form-control" name="existe_linerefile"  id="linea_refile_si" value="Si">
        
    </div>
    <div class="form-check form-check-inline" style="display: none">
        <input type="text" name="existe_linerefile" onchange="existe_linearefile()" id="linea_refile_no" value="No" checked>
        <label class="form-check-label" for="linea_refile_no">N/A</label>
    </div>
     
        <div  id="div_anchopie" class="form-group" style="display:inline-block;  width: 66%; ">
                <label for="ancho_linearefile">Ancho</label>
                   <input type="text" class="form-control" id="ancho_linearefile" name="ancho_linearefile" onkeyup="this.value=this.value.replace(/[^0-9]/g, '')" >
                 </div>
         <div id="div_ubicacionpie"  class="form-group" style="display:inline-block;  width: 100%; ">
                <label for="posicion_linearefile">Ubicación</label>
                   <input type="text" class="form-control" id="posicion_linearefile" name="posicion_linearefile" onkeyup="this.value=this.value.toUpperCase()" >
         </div>
       
       </div>   
     </div>
        <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 64%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px;">
        <p><strong>Código de Barras</strong></p>
         <div class="form-group" style="display:inline-block; vertical-align: top; width: 17%; margin-right: 1%">
        <label for="codigo_barras_si">Lleva Código</label>
        <input type="text" class="form-control" name="existe_codigobarras"  id="codigo_barras_si">
         </div>
    <div class="form-check form-check-inline" style="display: none">
        <input type="text" name="existe_codigobarras" onchange="existe_codigobarras()" id="codigo_barras_no" value="No" checked>
        <label class="form-check-label" for="codigo_barras_no">N/A</label>
    </div>
       
        
        <div id="div_numerocodigo" class="form-group" style="display:inline-block;  width: 46%; margin-right: 1%">
                <label for="numero_codigobarras">Número</label>
                   <input type="text" class="form-control" id="numero_codigobarras" name="numero_codigobarras" onkeyup="this.value=this.value.replace(/[^0-9 -]/g, '')" >
                 </div>
         <div id="div_magcodigo" class="form-group" style="display:inline-block;  width: 32%; ">
                <label for="magnificacion_codigobarras">Magnificación</label>
                   <input type="text" class="form-control" id="magnificacion_codigobarras" name="magnificacion_codigobarras" onkeyup="this.value=this.value.replace(/[^0-9.,]/g, '')" >
            </div>
         <div id="div_bwrcodigo"  class="form-group" style="display:inline-block;  width: 21%; margin-right: 1%">
                <label for="bwr_codigobarras">BWR</label>
                   <input type="text" class="form-control" id="bwr_codigobarras" name="bwr_codigobarras" onkeyup="this.value=this.value.replace(/[^0-9.,]/g, '')" >
         </div>
                <div  id="div_caladocodigo" class="form-group" style="display:inline-block;  width: 30%;">
                  <label  for="codigobarras_caladotintas">C.B. Calado Tintas</label>
                
                  <input class="form-control"  type="text"  onchange="adiciona_check()" id="codigobarras_caladotintas" value="codigobarras_caladotintas">
                </div>
                <div class="form-group" style="display: inline-block">
                  <label  for="codigobarras_caladobarniz">C.B. Calado Barniz</label>
                  <input class="form-control"  type="text"   id="codigobarras_caladobarniz" value="codigobarras_caladobarniz">
                </div>
                
       
       </div>   
       
          <div style="background-color: #FAFAFA;  width: 100%;display: inline-block; vertical-align: top;">
         <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px;">
        <p><strong>Textos Legales</strong></p>
        
         <div class="form-group" style="display:inline-block; vertical-align: top; width: 12%; margin-right: 1%">
              <label  for="textolegal_si">Lleva Texto Legal</label>
  
        <input type="text" class="form-control" name="existe_textolegal"  id="textolegal_si">
    </div>
    <div class="form-check form-check-inline" style="display: none">
        <input type="text" name="existe_textolegal" onchange="existe_textolegal()" id="textolegal_no" value="No" checked>
        <label class="form-check-label" for="textolegal_no">N/A</label>
    </div>
       
    <div id="div_textoslegales" style="display: inline-block; width: 86%">
            <div  class="form-group" style="display:inline-block;  width: 19%; vertical-align: top; margin-right: 1%">
                <label for="senasa">SENASA</label>
                   <input type="text" class="form-control" id="senasa" name="senasa">
                 </div>
                 <div  class="form-group" style="display:inline-block;  width: 19%; vertical-align: top; margin-right: 1%">
                <label for="rne">R.N.E.</label>
                   <input type="text" class="form-control" id="rne" name="rne">
                 </div>
                 <div  class="form-group" style="display:inline-block;  width: 19%; vertical-align: top; margin-right: 1%">
                <label for="rnpa">R.N.P.A</label>
                   <input type="text" class="form-control" id="rnpa" name="rnpa">
                 </div>
                 <div  class="form-group" style="display:inline-block;  width: 19%; vertical-align: top; margin-right: 1%">
                <label for="rin">R.I.N.</label>
                   <input type="text" class="form-control" id="rin" name="rin">
                 </div>
                 <div  class="form-group" style="display:inline-block;  width: 18%; vertical-align: top;">
                <label for="pams">P.A.M.S.</label>
                   <input type="text" class="form-control" id="pams" name="pams">
                 </div>
        
        
        </div>
       
        </div>
        </div>
      
         
            <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 49%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px; margin-right: 1%">
        <p><strong>Plano</strong></p>
        <div  class="form-group" style="display:inline-block;  width: 100%; ">
                <label for="codigo_plano">Código</label>
                   <input type="text" class="form-control" id="codigo_plano" name="codigo_plano">
                 </div>
        </div>  
         <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 49%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px;">
        <p><strong>Sentido Impresión</strong></p>
        <div  class="form-group" style="display:inline-block;  width: 70%; ">
                <label for="sentido_impresion">Lado</label>
                   <input type="text" class="form-control" id="sentido_impresion" onchange="cambiaimg_sentido()" name="sentido_impresion">
                 </div>
                 <div  class="form-group" style="display:inline-block;  width: 29%; ">
                     <img id="img_sentido" src="./Icons/sentidoimpresion.png" width="40px">
                     </div>
        </div>  
      
       
                   
           
           </div>
                
                
     
     </section>
    
     <section id="prateleira_04" class="tab-panel">
  
     
          <!-- Tabla Colores Flexo -->   
     
         
         <div id="div_lista_flexo" style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px">
        <h5 style="margin-top: -9px;"><img src="./Icons/novasequencia.png" width="30px" style="display: inline-block; margin-right: 5px"><strong>Listado Colores</strong></h5>
         
       
        <table id="tabela_receitas_flexo" class="table custom_table" cellspacing="0" width="100%" style="display: inline-block">
          <thead>
            <tr>
            
            
              <th class="col" style="width: 22%; text-align: left; font-size: 0.8em">Color
              </th>
              <th class="col" style="width: 5.5%; font-size: 0.8em">Lineatura
              </th>
              <th class="col" style="width: 5.5%; font-size: 0.8em">Trama
              </th>
              <th class="col" style="width: 5.5%; font-size: 0.8em">Angulo
              </th>
              <th class="col" style="width: 4.5%; font-size: 0.8em">Producir
              </th>
              <th class="col" style="width: 6%; font-size: 0.8em">Tipo Armado
              </th>
              <th class="col" style="width: 12%; font-size: 0.8em">Herramental
              </th>
              <th class="col" style="width: 8%; font-size: 0.8em">Trama Sólido
              </th>
              <th class="col" style="width: 4%; font-size: 0.8em">Cod. Barra
              </th>
              <th class="col" style="width: 4%; font-size: 0.8em">Pie Imp.
              </th>
              <th class="col" style="width: 4%; font-size: 0.8em">Taco
              </th>
              <th class="col" style="width: 4%; font-size: 0.8em">Linea Fife
              </th>
              <th class="col" style="width: 4%; font-size: 0.8em">Repetición
              </th>
             
           
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
          

                
         </div> 
         
             <div id="div_colores_hueco" style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: none; padding: 20px; vertical-align: top; margin-bottom: 10px">
        <h5 style="margin-top: -9px;"><img src="./Icons/tintas.png" width="30px" style="display: inline-block; margin-right: 5px"><strong>Colores</strong></h5>
                     
                 
                <input type="text" style="width: 3%; border: none; margin-rigth: 5px" id="acor" name="acor">
                 <div class="form-group" style="display:inline-block; width: 32%">
                <label for="nombre_tinta">Pantone</label>
                  <input type="text" class="form-control" id="nombre_tinta" name="nombre_tinta" onchange="seleciona_pantone()" list="as_cores">
                  <datalist id="as_cores"></datalist>
                 </div>
                  
                 
               
                <div  class="form-group" style="display:inline-block; width: 20%; margin-left: 3%;">
                 <input type="checkbox" checked data-toggle="toggle" id="se_produce" data-on="Producir" data-off="No Producir" data-onstyle="success" data-offstyle="danger" data-width="150" data-height="30">
                </div> 
                
                
                
              
               
                <div  class="form-group" style="display:inline-block; width: 15%; margin-left: 1%;">
                    <button id="btn-masinfotinta2" class="btn btn-secondary" onclick="mostra_info_tinta2()" style="cursor: pointer">Más Opciones</button>
                    <button id="btn-menosinfotinta2" class="btn btn-secondary" onclick="mostra_info_tinta2()" style="cursor: pointer; display: none">Menos Opciones</button>
                    
                </div>
                
               

                <div id="masinfotinta2" style="display: none; width: 100%">
                <hr>
                 <div  style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 25%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px; margin-right:1%;">
                <p><strong>Info Cilindro</strong></p> 
                  <div class="form-group" style="display:inline-block; width: 100%;">
                 <label for="cantidad_planchas">Repeticiones</label>
                  <input type="number" class="form-control" id="cantidad_planchas" onkeyup="this.value=this.value.replace(/[^0-9]/g, '').toUpperCase()" value="1"> 
                 </div>  
                 <div class="form-group" style="display:inline-block; width: 100%;">
                 <label for="herramental">Herramental</label>
                  <input type="text" class="form-control" id="herramental"> 
                 </div> 
                  <div class="form-group" style="display:inline-block; width: 13%;">
                 <label for="armado">Armado</label>
                  <select class="form-control" id="armado" name="armado">
                  <option value="undefined">Seleccionar..</option>
                  <option>A</option>
                  <option>AB</option>
                  <option>ABC</option>
                  <option>AC</option>
                  <option>B</option>
                  <option>BC</option>
                  <option>C</option>
                  </select>
                 </div>
                 </div>
                    <div  style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 25%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px;margin-right:1%;">
                <p><strong>Doble Color</strong></p> 
               <div class="form-group" style="display:inline-block; width: 100%;">
                 <label for="lineatura_2">Lineatura 2</label>
                  <input type="text" class="form-control" id="lineatura_2" name="lineatura_2">
                 </div>
                <div class="form-group" style="display:inline-block; width: 100%;">
                 <label for="trama_2">Trama 2</label>
                  <select class="form-control" id="trama_2" name="trama_2">
                  <option value="undefined">Seleccionar..</option>
                  </select>
                 </div>
               
               </div> 
               
                   <div  style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 47%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px">
                <p><strong>Corte</strong></p> 
               <div class="form-group" style="display:inline-block; width: 60%; margin-right: 1%">
                 <label for="tipo_corte">Tipo de Corte</label>
                  <select class="form-control" id="tipo_corte" name="tipo_corte">
                  <option value="undefined">Seleccionar..</option>
                  <option>Diferencial</option>
                  <option>Escalonado</option>
                  <option>Normal</option>
                  <option>Sinusoidal</option>
                  </select>
                 </div>
               <div class="form-group" style="display:inline-block; width: 38%;">  
                 <div class="form-check form-check-inline">
                  <input class="form-check-input"  type="checkbox"  id="desplazado" value="desplazado">
                  <label class="form-check-label" for="desplazado">Desplazado</label>
                </div>
               </div>
               <div class="form-group" style="display:inline-block; width: 48%; margin-right: 1%;">
                 <label for="corte_especial">Corte Especial</label>
                  <input type="text" class="form-control" id="corte_especial"> 
                 </div> 
                 <div class="form-group" style="display:inline-block; width: 48%; margin-right: 1%;">
                 <label for="desarollo_especial">Desarollo Especial</label>
                  <input type="text" class="form-control" id="desarollo_especial"> 
                 </div> 
               
               </div>
                    
                    
                </div>
      
                <br>
               
                 <div class="form-group" style="display:inline-block; width: 15%; margin-top: 20px">
                 
                 <button class="btn btn-primary" onclick="adicionar_tinta_flexo()">Agregar Tinta</button>
                
                 </div>
                 <div class="form-group" style="display:inline-block; width: 25%;">
                 <button class="btn btn-secondary" onclick="adicionar_cuerpo_libre()">Agregar Cuerpo Libre</button>
               </div>
               <div class="form-group" style="display:inline-block; width: 25%;">
                 <button class="btn btn-secondary" style="background-color: blue;" onclick="adicionar_CMYK()">Agregar CMYK</button>
               </div>
               <div class="form-group" style="display:inline-block; width: 25%;">
                 <button class="btn btn-secondary" style="background-color: orange;" onclick="adicionar_ogv()">Agregar OGV</button>
               </div>
            
                 
                 
                
                 
                 
                 
           
      <div  id="error_tinta" class="form-group col-md-11"></div>    
 
    <div id="altera_tinta" style="display: none">99</div>
          
       </div>
     
                
                 
                 
                 
           <!-- Tabla Colores Hueco -->   
     
          
         <div id="div_lista_hueco" style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: none; padding: 20px; vertical-align: top; margin-bottom: 10px">
        <h5 style="margin-top: -9px;"><img src="./Icons/novasequencia.png" width="30px" style="display: inline-block; margin-right: 5px"><strong>Listado Colores</strong></h5>
                 
          <table id="tabela_receitas_hueco" class="table custom_table" cellspacing="0" width="100%" style="display: inline-block">
          <thead>
            <tr>
            
            
              <th class="col" style="width: 37%; text-align: left;">Color
              </th>
              <th class="col" style="width: 6%">Lineatura
              </th>
              <th class="col" style="width: 15%">Trama
              </th>
              <th class="col" style="width: 17%">Trama Sólido
              </th>
              <th class="col" style="width: 17%">Cód. Facturación
              </th>
               <th class="col" style="width: 2%">FC
              </th>
              <th class="col" style="width: 2%">LR
              </th>
              <th class="col" style="width: 2%">PI
              </th>
              <th class="col" style="width: 2%">CB
              </th>
              <th class="col" style="width: 2%">LF
              </th>
               <th class="col" style="width: 3%">Editar
                </th>
                <th class="col" style="width: 3%">Borrar
                </th>
           
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
        

                
         </div>       
      
    
   
     </section>
    
     <section id="prateleira_05" class="tab-panel">
             <div  style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px">
        <h5 style="margin-top: -9px;"><img src="./Icons/pregravacao_on.png" width="30px" style="display: inline-block; margin-right: 5px"><strong>Indicaciones</strong></h5>
      
      
        <div id="div_colores_hueco" style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px">
        <h6>Nueva Indicación</h6>
      
                <div class="form-group" style="display:inline-block; width: 25%; margin-right: 1%; vertical-align: top;">
                 <label for="depto_indicaciones">Depto</label>
                  <select class="form-control" id="depto_indicaciones" name="depto_indicaciones">
                  <option value="undefined">Seleccionar..</option>
                  <option>Soporte</option>
                  <option>Programación</option>
                  <option>Preprensa</option>
                  <option>Grabación</option>
                  <option>Facturación</option>
                  </select>
                 </div>
                 <div class="form-group" style="display:inline-block; width: 73%; ">
                 <label for="indicacion">Indicación</label><br>
                  <textarea class="form-control" id="indicacion" name="indicacion"  style="display: inline-block; width:90%; vertical-align: middle" rows="2"></textarea>
                  <span><img src="./Icons/icone_mais.png" width="40px" style="cursor: pointer;" onclick="adiciona_indicacion()"></span>
                 </div>
      
      </div>
      <div id="div_colores_hueco" style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px">
        <h6>Listado de Indicaciones</h6>
      
         <table id="tabela_indicaciones" class="table custom_table" cellspacing="0" width="100%" style="display: inline-block">
          <thead>
            <tr>
            
            
              <th class="col" style="width: 20%; text-align: left;">Fecha Creación
              </th>
              <th class="col" style="width: 10%; text-align: left;">Creado por
              </th>
              <th class="col" style="width: 10%">Depto
              </th>
              <th class="col" style="width: 50%">Indicación
              </th>
              <th class="col" style="width: 5%">
              </th>
              <th class="col" style="width: 5%">
              </th>
              
           
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
       
      
      </div>
      
      </div>   
       
   
     </section>
     
     <section id="prateleira_06" class="tab-panel">
         
        <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px;">
        <p><strong>Servidor de Archivos</strong></p>
      
       <div id="div_tabela_pastas" style="width: 25%; display: inline-block">
              <table id="tabela_pastas" class="table custom-table" style="display: inline-block; min-width: 200px; vertical-align: top;">
          <thead>
            <tr>
             
             
              
              <th class="th-sm" style="width:10%;vertical-align: top;">
              </th>
              <th class="th-sm" style="width:90%;vertical-align: top; text-align: left;">
              </th>
               
              
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
  
        
    </div>
    
    <div id="div_tabela_subpastas" style="width: 70%; display: inline-block">
              <table id="tabela_subpastas" class="table custom-table" style="display: inline-block; min-width: 200px; vertical-align: top;">
          <thead>
            <tr>
             
             
             
              <th class="th-sm" style="width:10%;vertical-align: top;">
              </th>
              <th class="th-sm" style="width:90%;vertical-align: top;">
              </th>
              
               
              
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
  
        
    </div>
    
      
      
      </div>   
   
   
       <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px;">
        <p><strong>Flujos de Producción</strong></p>
      
     <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 49%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px; margin-rigth: 1%">
        <p><strong>Rótulo</strong></p>
        <div class="form-group" style="display:inline-block; width: 49%; margin-right: 1%;">
                 <label for="ficha_tecnica">Tipo Rótulo</label>
                  <select class="form-control" id="ficha_tecnica" name="ficha_tecnica">
                  <option value="undefined">Seleccionar..</option>
                  <option>Desplazado</option>
                  <option>Convencional</option>
                  </select>
                 </div>
     <div class="form-group" style="display:inline-block; width: 48%">
         <button class="btn btn-primary" style="cursor: pointer; width: 98%" onclick="enviar_fichatecnica()">Ejecutar Flujo</button>
     </div>
     <div class="form-group" style="display:inline-block; width: 100%;"> 
         <span id="msg_flujoficha" style="color: green"></span>
        </div>
     
      
      </div>   
   </div>
  
     </section>
     
     <section id="prateleira_07" class="tab-panel">
   
  
     </section>
     
     <section id="prateleira_08" class="tab-panel">
                 <div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px;">
        <p><strong>GPS</strong></p>
        <section class="form-group" style="width: 83.5%; display: inline-block"></section>
        <div class="form-group" style="width: 16%; display: inline-block">
          <label for="tempo_total_producao">Tiempo desde Ingreso</label>
            <input type="text" class="form-control"   id="tempo_total_producao" name="tempo_total_producao" readonly>
            
        </div>
       
        <table id="tabela_gps" class="table custom-table" cellspacing="0" width="100%" style="display: inline-block; min-width: 500px;">
        <thead>
          <tr>
          
          
        
            <th class="col" style="width:36%">Descripción
            </th>
            <th class="col" style="width:19%">Responsable
            </th>
            <th class="col" style="width:14%">Inicio
            </th>
            <th class="col" style="width:14%">Termino
            </th>
            <th class="col" style="width:14%">Tiempo Total
            </th>
            
    
           
         
          </tr>
        </thead>
        <tbody>
            
        </tbody>
      </table>

         
         
         </div>
  
         

 
     </section>
     
      <section id="prateleira_09" class="tab-panel">
         
 <div class="container" style="width: 100%; max-width: 2000px">
<div class="row clearfix">
    <div class="col-lg-12">
        
        <div style="width: 30%; margin-right: 1%; display: inline-block">
        <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i style="cursor:pointer" class="fa fa-address-book"></i></span>
                        </div>
                        <select id="newuser_chat" class="form-control">
                            <option value="undefined">Seleccionar un usuário</option>
                        </select>
                    </div>
        </div>
        <div style="width: 60%; margin-right: 1%; display: inline-block">
        
        <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i style="cursor:pointer" onclick="send_message2()" class="fa fa-comments"></i></span>
                        </div>
                        <input id="new_chat" type="text" class="form-control" placeholder="Iniciar una conversación...">                                    
                    </div>
        </div>
        
        <div class="card2 chat-app">
            <div id="plist" class="people-list">
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text"><i class="fa fa-search"></i></span>
                    </div>
                    <input type="text" class="form-control" placeholder="Busqueda...">
                </div>
                <ul id="chats_existentes" class="list-unstyled chat-list mt-2 mb-0">
                  
                   
                </ul>
            </div>
            <div class="chat">
                <div class="chat-header clearfix">
                    <div class="row">
                        <div id="mostra_nome" style="display: none" class="col-lg-6">
                            <a href="javascript:void(0);" data-toggle="modal" data-target="#view_info">
                                <img src="./Icons/cliente.png">
                            </a>
                            <div    class="chat-about">
                                <h6 id="nome_recipiente" class="m-b-0">Hybrid</h6>
                                <!--<small>Last seen: 2 hours ago</small>-->
                            </div>
                        </div>
                        <div class="col-lg-6 hidden-sm text-right" style="display: none">
                            <a href="javascript:void(0);" class="btn btn-outline-secondary"><i class="fa fa-camera"></i></a>
                            <a href="javascript:void(0);" class="btn btn-outline-primary"><i class="fa fa-image"></i></a>
                            <a href="javascript:void(0);" class="btn btn-outline-info"><i class="fa fa-cogs"></i></a>
                            <a href="javascript:void(0);" class="btn btn-outline-warning"><i class="fa fa-question"></i></a>
                        </div>
                    </div>
                </div>
                <div class="chat-history" style="overflow-y: scroll; height:500px;">
                    <ul id="mensagens" class="m-b-0">
                        
                      
                    </ul>
                </div>
                <div class="chat-message clearfix">
                    <div class="input-group mb-0">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i style="cursor:pointer" onclick="send_message()" class="fa fa-send"></i></span>
                        </div>
                        <input id="msg_chat" type="text" class="form-control" placeholder="Escribir nuevo mensaje...">                                    
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>

 
     </section>
     
    
   
    
  </div>
  
</div>
   
   
          
        <!-- Datos Técnicos -->
        
        
        <!-- Informacion arte -->
        
           </div>
          
         <!-- Colores Flexo -->   
            
       
             <!-- Colores Hueco -->   

         
          
            
             
         
             <div  style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: none; padding: 20px; vertical-align: top; margin-bottom: 10px">
        <h5 style="margin-top: -9px;"><img src="./Icons/uploadedownload.png" width="30px" style="display: inline-block; margin-right: 5px"><strong>Servidor de Archivos</strong></h5>
        
            
               <div class="form-group" style="display:inline-block; width: 40%; margin-right: 1%">
                 <label for="carpeta_trabajo">Seleccionar Carpeta del Trabajo</label>
                  <select class="form-control" id="carpeta_trabajo" onchange="select_folder()" name="carpeta_trabajo">
                  <option value="undefined">Seleccionar..</option>
                  
                  </select>
                 </div>
      
          
      </div>
                    
                   
                <div id="mensagem_alteracao" style="background-color: green; heigth: 100px; width: 100%; font-size: 3em; color: white; display: none; text-align: center;">BLOQUEAR O ITEM NO SAP!!</div>
             <hr>
                     
                         <div  class="form-group" style="display: inline-block; width: 22%; vertical-align: baseline;">
                <label for="liberado_preprensa">Liberado Preprensa</label>
                   <input class="form-control" id="liberado_preprensa" style="background-color: red; color: white; text-align: center; cursor:pointer;"  onclick="liberar_preprensa()" name="liberado_preprensa" readonly value="No">
                      
                 </div>
                 <div id="mostra_botao_salvar" class="form-group" style="display:none; margin-left: 2%">
                    
                    <button class="btn btn-primary" style="cursor: pointer" onclick="verifica_campos()" >Finalizar Tarea</button>
                       </div>
                       
                        <div id="mostra_botao_devolver" class="form-group" style="display: inline-block; margin-left: 2%">
                    
                    <button class="btn btn-primary" style="cursor: pointer" onclick="devolver_a_soporte()" >Retornar a Soporte</button>
                       </div>
                  
                </div>
                
              
         
        
         
       <br>
     <div  id="div_motivo" style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: none; padding: 20px; vertical-align: top; margin-bottom: 10px;">
        <h5 style="margin-top: -9px;"><img src="./Icons/devolver.png" width="30px" style="display: inline-block; margin-right: 5px"><strong>Motivo Devolución</strong></h5>
      <div class="form-group" style="display: inline-block; width: 100%">
      <textarea id="motivo_devolucion" class="form-control" rows="3"></textarea>
      </div>
      
      <div id="mostra_botao_devolver" class="form-group" style="display: inline-block; margin-left: 2%">
                    
                    <button class="btn btn-primary" style="cursor: pointer" onclick="retornar()" >Retornar</button>
                       </div>
                       
                        <div id="mostra_botao_cancelar" class="form-group" style="display: inline-block; margin-left: 2%">
                    
                    <button class="btn btn-primary" style="cursor: pointer" onclick="cancelar_retorno()" >Cancelar</button>
                       </div>
      
      </div>
      
      <div id="msg_ot" style="color: green"></div>
               
         </div>     
            </div>   
       
  	
  		
   <script src="js/popper.js"></script>
  <script src="js/main.js"></script>	
  		
  	<script>
  	    // funcoes de apoio
  	    
  	  var usuario = api.auth.get_current_user()
  	    
  	   document.getElementById("bemvindo").innerText = "bien venido, "+usuario.fullname
  	    
              function clearTable(table) {
          var rows = table.rows;
          var i = rows.length;
          while (--i) {
            rows[i].parentNode.removeChild(rows[i]);
            // or
            // table.deleteRow(i);
          }
        }
        
        function onlyUnique(value, index, self) {
          return self.indexOf(value) === index;
        }

function cmyk2rgb(c, m, y, k, normalized){
    c = (c / 100);
    m = (m / 100);
    y = (y / 100);
    k = (k / 100);
    
    c = c * (1 - k) + k;
    m = m * (1 - k) + k;
    y = y * (1 - k) + k;
    
    var r = 1 - c;
    var g = 1 - m;
    var b = 1 - y;
    
    if(!normalized){
        r = Math.round(255 * r);
        g = Math.round(255 * g);
        b = Math.round(255 * b);
    }
    
    return {
        r: r,
        g: g,
        b: b
    }
}

function rgb2cmyk(r, g, b, normalized){
    var c = 1 - (r / 255);
    var m = 1 - (g / 255);
    var y = 1 - (b / 255);
    var k = Math.min(c, Math.min(m, y));
    
    c = (c - k) / (1 - k);
    m = (m - k) / (1 - k);
    y = (y - k) / (1 - k);
    
    if(!normalized){
        c = Math.round(c * 10000) / 100;
        m = Math.round(m * 10000) / 100;
        y = Math.round(y * 10000) / 100;
        k = Math.round(k * 10000) / 100;
    }
    
    c = isNaN(c) ? 0 : c;
    m = isNaN(m) ? 0 : m;
    y = isNaN(y) ? 0 : y;
    k = isNaN(k) ? 0 : k;
    
    return {
        c: c,
        m: m,
        y: y,
        k: k
    }
}



function msToTime(s) {

  // Pad to 2 or 3 digits, default is 2ver
  function pad(n, z) {
    z = z || 2;
    return ('00' + n).slice(-z);
  }

  var ms = s % 1000;
  s = (s - ms) / 1000;
  var secs = s % 60;
  s = (s - secs) / 60;
  var mins = s % 60;
  var hrs = (s - mins) / 60;
  if (hrs > 24){
      var days = parseInt(hrs/24)
      hrs = parseInt(hrs-days*24)
  } else {
      var days = "00"
  }

  return pad(days)+"d - "+pad(hrs) + ':' + pad(mins)+"hs";
}

function componentToHex(c) {
  var hex = c.toString(16);
  return hex.length == 1 ? "0" + hex : hex;
}

function rgbToHex(r, g, b) {
  return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
}



 function array_move(arr, old_index, new_index) {
    if (new_index >= arr.length) {
        var k = new_index - arr.length + 1;
        while (k--) {
            arr.push(undefined);
        }
    }
    arr.splice(new_index, 0, arr.splice(old_index, 1)[0]);
    return arr; // for testing
};


// preenche dados se existe ordem

if (usuario.scope_name != undefined){
    var nome_scope = usuario.scope_name[0].split("_")
   
}




// preenche Selects

  
         
        
        
     


// preenche  checklists

   
   
   
   
   
   
   
   
    
         
         
         
// preenche data de hoje

var hoje = new Date()


  	</script>
  	
<script>
    
    // preenche dados do ticket
    
    var buscaOT = api.custom_objects.list("AR-BOSISIO_ordenes",["_id","equal to",ordem]).results[0]
    
    document.getElementById("titulo").innerText = "Orden de Trabajo - "+buscaOT.numero_op
    
    var beginning = new Date(buscaOT.fecha_ingreso)
 
 var totaltempoprod = hoje.getTime()-beginning.getTime()
 document.getElementById("tempo_total_producao").value = msToTime(totaltempoprod)
  
    document.getElementById("cliente").value = buscaOT.cliente
    document.getElementById("impresor").value = buscaOT.impresor
    
    // llena los datos de perfiles
    
     var busca_cliente = api.custom_objects.list_with_options("AR-BOSISIO_clientes",["DENOMINACION","equal to",buscaOT.cliente]).results
            
            if (busca_cliente.length > 0){
                   perfiles = busca_cliente[0].datos_tecnicos
                
            }
            
            
   
            
            
    
    
    
    
    document.getElementById("tipo_ordem").value = buscaOT.tipo_orden
    document.getElementById("tipo_trabajo").value = buscaOT.tipo_trabajo
    document.getElementById("polimeros_con").value = buscaOT.informacion_trabajo.enviar_polimeroscon
    document.getElementById("producto").value = buscaOT.informacion_trabajo.producto.toString()
    document.getElementById("requiere").value = buscaOT.informacion_trabajo.requiere.toString()
    
    
    if (buscaOT.liberado_preprensa === true){
       document.getElementById("liberado").style.backgroundColor = "green"
        document.getElementById("liberado_preprensa").value = "Si"
            document.getElementById("liberado_preprensa").style.backgroundColor = "green"
       
    } else {
        document.getElementById("liberado_preprensa").value = "No"
            document.getElementById("liberado_preprensa").style.backgroundColor = "red"
       document.getElementById("liberado").style.backgroundColor = "red" 
    }
     document.getElementById("nombre_producto").value = buscaOT.informacion_trabajo.nombre_producto
     document.getElementById("codigo_producto").value = buscaOT.informacion_trabajo.codigo_producto
     document.getElementById("prioridad").value = buscaOT.informacion_trabajo.prioridad
    
   // llena datos tecnicos
    
    var selectPerfiles = []
    var apenasCMYK = new RegExp(".*CMYK")
    var apenasCMYKOVG = new RegExp(".*CMYKOGV")
   
   
   if (buscaOT.datos_tecnicos != "" || buscaOT.datos_tecnicos != undefined){
      
       var es_gamaexpandida = new RegExp("CMYKO.*")
      
       if (es_gamaexpandida.test(buscaOT.datos_tecnicos.TINTASDOCUMENTO_N) === true){
      
           document.getElementById("gamaexpandida_si").checked = true
           document.getElementById("div_gamaexpandida").style.display = "inline-block"
           document.getElementById("color_gamaexpandida").value = buscaOT.datos_tecnicos.CODIGONUEVO.substring(buscaOT.datos_tecnicos.CODIGONUEVO.lastIndexOf("_")+1,buscaOT.datos_tecnicos.CODIGONUEVO.length)
      
           for (i=0;i<perfiles.length;i++){
               if (perfiles[i].TINTASDOCUMENTO_N.length > 4 && apenasCMYKOVG.test(perfiles[i].TINTASDOCUMENTO_N) === true){
                var theprofilename = perfiles[i].CODIGO
                var thearrayprofile = theprofilename.split("_")
                var nombre_perfil = ""
                for (j=0;j<thearrayprofile.length-1;j++){
                  nombre_perfil=nombre_perfil+  thearrayprofile[j]+"_"
                }
                nombre_perfil = nombre_perfil.substring(0,nombre_perfil.length-1)
                   selectPerfiles.push(nombre_perfil)
               }
           }
           
       } else {
           
            for (i=0;i<perfiles.length;i++){
               if (apenasCMYK.test(perfiles[i].TINTASDOCUMENTO_N) === true){
                var theprofilename = perfiles[i].CODIGO
                var thearrayprofile = theprofilename.split("_")
                var nombre_perfil = ""
                for (j=0;j<thearrayprofile.length-1;j++){
                  nombre_perfil=nombre_perfil+  thearrayprofile[j]+"_"
                 }
                nombre_perfil = nombre_perfil.substring(0,nombre_perfil.length-1)
                   selectPerfiles.push(nombre_perfil)
               }
           }
          
           document.getElementById("gamaexpandida_no").checked = true
       }
       
        var thecleanprofiles = selectPerfiles.filter(onlyUnique)
        
        var theselectPerfiles = document.getElementById("informacion_impresion")
        
        thecleanprofiles.sort() 
        
        for (var i = 0; i<thecleanprofiles.length; i++){
                var opt = document.createElement('option');
                opt.value = thecleanprofiles[i];
                opt.innerHTML = thecleanprofiles[i];
                theselectPerfiles.appendChild(opt);
            }
       
       
       if (buscaOT.datos_tecnicos != ""){
       document.getElementById("informacion_impresion").value = buscaOT.datos_tecnicos.CODIGONUEVO.substring(0,buscaOT.datos_tecnicos.CODIGONUEVO.lastIndexOf('_'))
       document.getElementById("nombre_perfil").value = buscaOT.datos_tecnicos.CODIGONUEVO
       if (buscaOT.datos_tecnicos.CODIGONUEVO != "Genérico_CMYK" || buscaOT.datos_tecnicos.CODIGONUEVO != "Genérico_CMYKOVG" ){
           document.getElementById('div_lapis').style.display = "none"
       }
       if (buscaOT.datos_tecnicos.MATERIAL_N.indexOf(" - ") > -1){
         document.getElementById("material").value = buscaOT.datos_tecnicos.MATERIAL_N.split(" - ")[0].toUpperCase()  
       } else {
          document.getElementById("material").value = buscaOT.datos_tecnicos.MATERIAL_N.toUpperCase() 
       }
       if (buscaOT.datos_tecnicos.SENTIDOIMPRESION_N.indexOf(" - ") > -1){
         document.getElementById("sentido").value = buscaOT.datos_tecnicos.SENTIDOIMPRESION_N.split(" - ")[0].toUpperCase()  
       } else {
          document.getElementById("sentido").value = buscaOT.datos_tecnicos.SENTIDOIMPRESION_N.toUpperCase() 
       }
       if (buscaOT.datos_tecnicos.MAQUINAIMPRESORA.indexOf(" - ") > -1){
         document.getElementById("maquina").value = buscaOT.datos_tecnicos.MAQUINAIMPRESORA.split(" - ")[0].toUpperCase()  
       } else {
          document.getElementById("maquina").value = buscaOT.datos_tecnicos.MAQUINAIMPRESORA.toUpperCase() 
       }
       if (buscaOT.datos_tecnicos.LINEATURA_N.indexOf(" - ") > -1){
         document.getElementById("lineatura").value = buscaOT.datos_tecnicos.LINEATURA_N.split(" - ")[0].toUpperCase()  
       } else {
          document.getElementById("lineatura").value = buscaOT.datos_tecnicos.LINEATURA_N.toUpperCase() 
       }
       if (buscaOT.datos_tecnicos.FABRICANTEPOLIMERO_N.indexOf(" - ") > -1){
         document.getElementById("fabricante_polimero").value = buscaOT.datos_tecnicos.FABRICANTEPOLIMERO_N.split(" - ")[0].toUpperCase()  
       } else {
          document.getElementById("fabricante_polimero").value = buscaOT.datos_tecnicos.FABRICANTEPOLIMERO_N.toUpperCase() 
       }
         document.getElementById("espesor_polimero").value = buscaOT.datos_tecnicos.ESPESORPOLIMERO_N
      if (buscaOT.datos_tecnicos.FABRICANTEPOLIMEROBLA.indexOf(" - ") > -1){
         document.getElementById("fabricante_polimeroblanco").value = buscaOT.datos_tecnicos.FABRICANTEPOLIMEROBLA.split(" - ")[1].toUpperCase()  
       } else {
          document.getElementById("fabricante_polimeroblanco").value = buscaOT.datos_tecnicos.FABRICANTEPOLIMEROBLA.toUpperCase() 
       }
      if (buscaOT.datos_tecnicos.FABRICANTEPOLIMEROBAR.indexOf(" - ") > -1){
         document.getElementById("fabricante_polimerobarniz").value = buscaOT.datos_tecnicos.FABRICANTEPOLIMEROBAR.split(" - ")[1].toUpperCase()  
       } else {
          document.getElementById("fabricante_polimerobarniz").value = buscaOT.datos_tecnicos.FABRICANTEPOLIMEROBAR.toUpperCase() 
       }
       
      
   }
   }

    var thearte = buscaOT.informacion_arte
    var fotocelulas = buscaOT.informacion_arte.fotocelula_ubicacion
    
    for (i=0;i<fotocelulas.length;i++){
        document.getElementById(fotocelulas[i]).style.background = "black"
    }
    
    delete thearte["fotocelula_ubicacion"]
    
    var chavesarte = Object.keys(thearte)
    
    
    for (i=0;i<chavesarte.length;i++){
        console.log(chavesarte[i])
        if (chavesarte[i] != "fotocelula_caladobarniz" && 
            chavesarte[i] != "fotocelula_caladotintas" &&
            chavesarte[i] != "pie_imprenta_si" &&
            chavesarte[i] != "pie_imprenta_no" &&
            chavesarte[i] != "pie_caladotintas" &&
            chavesarte[i] != "linea_refile_si" &&
            chavesarte[i] != "codigo_barras_si" &&
            chavesarte[i] != "codigobarras_caladotintas" &&
            chavesarte[i] != "codigobarras_caladobarniz" &&
            chavesarte[i] != "textolegal_si"){
        if (document.getElementById(chavesarte[i]).type == "radio" || document.getElementById(chavesarte[i]).type == "checkbox"){
        document.getElementById(chavesarte[i]).checked = buscaOT.informacion_arte[chavesarte[i]]
        } else {
         document.getElementById(chavesarte[i]).value = buscaOT.informacion_arte[chavesarte[i]]   
        }
        } else {
            if (buscaOT.informacion_arte[chavesarte[i]] === true){
                document.getElementById(chavesarte[i]).value = "Si"
            } else {
                document.getElementById(chavesarte[i]).value = "No"
            }
        }
    }
    
    if (buscaOT.informacion_arte.pie_imprenta_si === true){
        document.getElementById("div_pie_imprenta").style.display = "inline-block"
    }
    if (buscaOT.informacion_arte.textolegal_si === true){
        document.getElementById("div_textoslegales").style.display = "inline-block"
    }
    
    
   if (buscaOT.informacion_arte.alto_fotocelula != ""){
        document.getElementById("fotocelula_segunplano").disabled = false
         document.getElementById("div_dimensoes_taco").style.display = "inline-block"  
           document.getElementById("mostra_fotocelula1").style.display = "inline-block"
            document.getElementById("mostra_fotocelula2").style.display = "inline-block"
            document.getElementById("mostra_fotocelula3").style.display = "inline-block" 
   } 
   
   document.getElementById("codigo_plano").value = buscaOT.informacion_arte.codigo_plano
   document.getElementById("sentido_impresion").value = buscaOT.informacion_arte.sentido_impresion
   
    if (buscaOT.informacion_arte.sentido_impresion === "Arriba"){
              document.getElementById("img_sentido").style.transform = "rotate(180deg)"
          }
          if (buscaOT.informacion_arte.sentido_impresion=== "Abajo"){
              
              document.getElementById("img_sentido").style.transform = "rotate(0deg)"
          }
          if (buscaOT.informacion_arte.sentido_impresion === "Izquierda"){
              document.getElementById("img_sentido").style.transform = "rotate(90deg)"
          }
          if (buscaOT.informacion_arte.sentido_impresion === "Derecha"){
              document.getElementById("img_sentido").style.transform = "rotate(-90deg)"
          }
   
   if (buscaOT.indicaciones != undefined){
   var indicaciones = buscaOT.indicaciones
   } else {
       var indicaciones = []
   }
   
    var arteselec = []
  		    var pedidoselec = []
  		    var plantaselec = []
    
   
     var therealgps = []
    
    for (i=0;i<buscaOT.tiempos_proceso.length;i++){
        var datagps = {}
        datagps["descricao"] = buscaOT.tiempos_proceso[i].etapa
        
        var temposdogps = buscaOT.tiempos_proceso[i].tiempos
        if (temposdogps[temposdogps.length-1]["termino"] === undefined){
        datagps["responsavel"] = ""
        datagps["final"] = ""
        datagps["status_etapa"] = ""
        } else {
          datagps["responsavel"] = buscaOT.tiempos_proceso[i].finalizado_por
          datagps["final"] = temposdogps[temposdogps.length-1].termino
          datagps["status_etapa"] = buscaOT.tiempos_proceso[i].state 
          var totaltimegps = (new Date(temposdogps[temposdogps.length-1].termino)).getTime()-(new Date(temposdogps[0].inicio)).getTime()
          console.log(totaltimegps)
          datagps["tempo_total"] = msToTime(totaltimegps)
        }
        datagps["inicio"] = temposdogps[0].inicio
        
        
        therealgps.push(datagps)
    }
             
             
             
therealgps.sort((a, b) => {
  if (new Date(b.inicio) < new Date(a.inicio)) {
    return -1;
  }
}
)
          
     
     for (i=0;i<therealgps.length;i++){
         
         var table = document.getElementById("tabela_gps")
                var qtasrow = table.rows.length
                var row =  table.insertRow(qtasrow);
                    var cell1 = row.insertCell(0);
                    var cell2 = row.insertCell(1)
                    var cell3 = row.insertCell(2);
                    var cell4 = row.insertCell(3);
                    var cell5 = row.insertCell(4);
                 
                var back_etapa = "green"
                
                 if (therealgps[i].status_etapa == ""){
                     back_etapa = "blue"
                 }
                 if (therealgps[i].status_etapa == "delay"){
                     back_etapa = "red"
                 }
                 
                   
              
                cell1.innerHTML = '<div><input type="text" class="form-control"  readonly value="' +therealgps[i].descricao+'"></div>' 
                cell2.innerHTML = '<div><input type="text" class="form-control"  readonly value="' +therealgps[i].responsavel+'"></div>' 
                cell3.innerHTML = '<div><input type="text" class="form-control" style="text-align: center" readonly value="' +dateFormat(new Date(therealgps[i].inicio),"dd/mm/yyyy")+'"></div>' 
                if (therealgps[i].final != ""){
                cell4.innerHTML = '<div><input type="text" class="form-control" style="text-align: center" readonly value="' +dateFormat(new Date(therealgps[i].final),"dd/mm/yyyy")+'"></div>' 
                cell5.innerHTML = '<div><input type="text" class="form-control" style="text-align: center" readonly value="'+therealgps[i].tempo_total+'"></div>'
                    
                } else {
                
                 cell4.innerHTML = '<div><input type="text" class="form-control"  readonly value=""></div>'    
                 cell5.innerHTML = '<div><input type="text" class="form-control"  readonly value=""></div>'    
                
                    
                }
                 
                    
               qtasrow = qtasrow+1
             } 
             
             
    if (buscaOT.arte_producao._id != undefined){
        
        var arte_produccion = api.asset.list_with_options(["url","contains",buscaOT.arte_producao.url]).results[0]
        if (arte_produccion.thumb != undefined){
            document.getElementById("preview").src = arte_produccion.thumb
        }
        
        if (buscaOT.proofscope_arte === undefined){
            var cria_proof = api.proofscope.create_view_file_url("",arte_produccion.cloudflow.file)
            if (cria_proof.result == "ok"){
                document.getElementById("link_view").href = cria_proof.url
            api.custom_objects.set_keys("AR-BOSISIO_ordenes",ordem,{"proofscope_arte":cria_proof.url})
                
            }
        
            
        }
        
        api.custom_objects.set_keys("AR-BOSISIO_ordenes",ordem,{"arte_producao":arte_produccion})
    }
    
</script>
  	
  	
  	
  	
   <script>
       function salva_ticket(){
           var data = {}
            data["tipo_trabalho"] = document.getElementById("tipo_trabalho").value
            data["criado_em"] = new Date()
            data["criado_por"] = usuario
            var info_arte = {}
            info_arte["codigo"] = document.getElementById("codigo_arte").value
            info_arte["revisao"] = document.getElementById("arte_revisao").value
            info_arte["evolucao"] = document.getElementById("arte_evolucao").value
            data["info_arte"] = info_arte
            data["cliente"] = document.getElementById("cliente").value
            data["responsavel_comercial"] = document.getElementById("responsavel_comercial").value
            data["descricao"] = document.getElementById("descricao").value
            data["item"] = document.getElementById("item").value
            data["item_referencia"] = document.getElementById("item_referencia").value
            data["priorizado"] = false
            data["arte_iniciado"] = false
            data["arte_finalizado"] = false
            data["ticket_dg"] = document.getElementById("numero_ticket").value
            var info_checklist = {}
            info_checklist["Arte OK"] = document.getElementById("Arte OK").checked
            info_checklist["Referencia de Cor"] = document.getElementById("Referencia de Cor").checked
            info_checklist["Especificacao"] = document.getElementById("Especificacao").checked
            data["checklist_entrada"] = info_checklist
            console.log(data)
            var info_observa = {}
            info_observa["quem"] = usuario
            info_observa["quando"] = new Date()
            info_observa["texto"] = document.getElementById("observacoes").value
            var as_observacoes = []
            as_observacoes.push(info_observa)
            data["observacoes"] = as_observacoes
            
            
            //api.custom_objects.create("BR-VALFI_Tickets",data)
           
           // document.getElementById("info_ticket").innerText = "Ticket criado com sucesso!"
            
           setTimeout(function(){document.getElementById("info_ticket").innerText = ""}, 3000);
       }
       
      
   </script>
   <script>
    var tintas_flexo = []
    function adicionar_tinta_flexo(){
       var valor_hex = chroma(document.getElementById("acor").style.backgroundColor).hex()
         
        if (document.getElementById("altera_tinta").innerText == "99"){
        var info_tinta = {}
        info_tinta["nombre_tinta"] = document.getElementById("nombre_tinta").value
        info_tinta["lineatura_flexo"] = document.getElementById("lineatura_flexo").value
        info_tinta["trama_flexo"] = document.getElementById("trama_flexo").value
        info_tinta["angulo_flexo"] = document.getElementById("trama_flexo").value
        info_tinta["trama_solidos_flexo"] = document.getElementById("trama_solidos_flexo").value
        info_tinta["codigo_facturacion"] = ""
        info_tinta["fotocelula"] = false
        info_tinta["linea_refile"] = false
        info_tinta["pie_imprenta"] = false
        info_tinta["codigo_barras"] = false
        info_tinta["hex"] = valor_hex
        info_tinta["producir"] = document.getElementById("se_produce").checked
        info_tinta["armado"] = document.getElementById("armado").value
        info_tinta["cantidad_planchas"] = document.getElementById("cantidad_planchas").value
        info_tinta["herramental"] = document.getElementById("herramental").value
        info_tinta["lineatura_2"] = document.getElementById("lineatura_2").value
        info_tinta["trama_2"] = document.getElementById("trama_2").value
        info_tinta["tipo_corte"] = document.getElementById("tipo_corte").value
        info_tinta["desplazado"] = document.getElementById("desplazado").checked
        info_tinta["corte_especial"] = document.getElementById("corte_especial").value
        info_tinta["desarollo_especial"] = document.getElementById("desarollo_especial").value
        
        
        tintas_flexo.push(info_tinta)
          document.getElementById("error_tinta").style = "color: green"
         document.getElementById("error_tinta").innerText = "Tinta creada con êxito"
         setTimeout(document.getElementById("error_tinta").innerText = "", 3000)
        
        } else {
            var qual_tinta = parseInt(document.getElementById("altera_tinta").innerText)
            
            tintas_flexo[qual_tinta]["nombre_tinta"] = document.getElementById("nombre_tinta").value
            tintas_flexo[qual_tinta]["lineatura_flexo"] = document.getElementById("lineatura_flexo").value
            tintas_flexo[qual_tinta]["trama_flexo"] = document.getElementById("trama_flexo").value
            tintas_flexo[qual_tinta]["angulo_flexo"] = document.getElementById("angulo_flexo").value
            tintas_flexo[qual_tinta]["trama_solidos_flexo"] = document.getElementById("trama_solidos_flexo").value
            tintas_flexo[qual_tinta]["codigo_facturacion"] = ""
            tintas_flexo[qual_tinta]["hex"] = valor_hex
            tintas_flexo[qual_tinta]["producir"] = document.getElementById("se_produce").checked
            tintas_flexo[qual_tinta]["armado"] = document.getElementById("armado").value
            tintas_flexo[qual_tinta]["cantidad_planchas"] = document.getElementById("cantidad_planchas").value
            tintas_flexo[qual_tinta]["herramental"] = document.getElementById("herramental").value
            tintas_flexo[qual_tinta]["lineatura_2"] = document.getElementById("lineatura_2").value
            tintas_flexo[qual_tinta]["trama_2"] = document.getElementById("trama_2").value
            tintas_flexo[qual_tinta]["tipo_corte"] = document.getElementById("tipo_corte").value
            tintas_flexo[qual_tinta]["desplazado"] = document.getElementById("desplazado").checked
            tintas_flexo[qual_tinta]["corte_especial"] = document.getElementById("corte_especial").value
            tintas_flexo[qual_tinta]["desarollo_especial"] = document.getElementById("desarollo_especial").value
           
            document.getElementById("error_tinta").style = "color: green"
         document.getElementById("error_tinta").innerText = "Tinta cambiada com êxito"
         setTimeout(document.getElementById("error_tinta").innerText = "", 3000)
           
        }
        
        document.getElementById("nombre_tinta").value = ""
        document.getElementById("acor").style = "background-color: rgb(255, 255, 255); width: 30px; border: none; display: inline-block;"
        document.getElementById("altera_tinta").innerText = "99"
        
        
        
        
        
       
        
        preenche_tabela_receita()
      
        
    }
    
     function adicionar_cuerpo_libre(){
    //   var valor_hex = chroma(document.getElementById("acor").style.backgroundColor).hex()
         
        var info_tinta = {}
        info_tinta["nombre_tinta"] = "Cuerpo Libre"
        info_tinta["lineatura_flexo"] = "N/A"
        info_tinta["trama_flexo"] = "N/A"
        info_tinta["angulo_flexo"] = "N/A"
        info_tinta["trama_solidos_flexo"] = "N/A"
        info_tinta["codigo_facturacion"] = ""
        info_tinta["fotocelula"] = false
        info_tinta["linea_refile"] = false
        info_tinta["pie_imprenta"] = false
        info_tinta["codigo_barras"] = false
        info_tinta["hex"] = "#FFFFFF"
        info_tinta["producir"] = false
        info_tinta["armado"] = ""
        info_tinta["cantidad_planchas"] = ""
        info_tinta["herramental"] = ""
        info_tinta["lineatura_2"] = ""
        info_tinta["trama_2"] = ""
        info_tinta["tipo_corte"] = ""
        info_tinta["desplazado"] = ""
        info_tinta["corte_especial"] = ""
        info_tinta["desarollo_especial"] = ""
        tintas_flexo.push(info_tinta)
          document.getElementById("error_tinta").style = "color: green"
         document.getElementById("error_tinta").innerText = "Tinta creada con êxito"
         setTimeout(document.getElementById("error_tinta").innerText = "", 3000)
        
       
        
        document.getElementById("nombre_tinta").value = ""
        document.getElementById("acor").style = "background-color: rgb(255, 255, 255); width: 30px; border: none; display: inline-block;"
        document.getElementById("altera_tinta").innerText = "99"
        
        
        
        
        
       
        
        preenche_tabela_receita()
      
        
    }
    
    
      function adicionar_CMYK(){
    //   var valor_hex = chroma(document.getElementById("acor").style.backgroundColor).hex()
        var verifica_campos = true
        var tintas = ["Cyan","Magenta","Yellow","Black","Blanco"]
        var reticulas = ["52.5","22.5","7.5","82.5","Pleno"]
        
        for (i=0;i<tintas.length;i++){
        var nombre = tintas[i]
        
        var existe_tinta = false
        
        for (j=0;j<tintas_flexo.length;j++){
            if (tintas_flexo[j]["nombre_tinta"] == nombre){
                existe_tinta = true
            }
        }
        if (existe_tinta === false){
        var info_tinta = {}
        info_tinta["nombre_tinta"] = nombre
        if (theveryoneprofile == ""){
        if (document.getElementById("lineatura_flexo").value != ""){
        info_tinta["lineatura_flexo"] = document.getElementById("lineatura_flexo").value
        } else {
            document.getElementById("tramasolidos").style.display = "inline-block"
            document.getElementById("lineatura_flexo").style.borderColor = "red"
             document.getElementById("error_lineatura_flexo").innerText = "Llenar lineatura"
            verifica_campos = false
        }
        } else {
            if (theveryoneprofile.LINEATURA_N.indexOf(" - ") > -1){
                    var onearray = theveryoneprofile.LINEATURA_N.split(" - ")
                    info_tinta["lineatura_flexo"] =  onearray[1]    
            } else {
                    info_tinta["lineatura_flexo"] = theveryoneprofile.LINEATURA_N  
            }
        }
        
        if (theveryoneprofile == ""){
        if (document.getElementById("trama_flexo").value  != "undefined"){
        info_tinta["trama_flexo"] = document.getElementById("trama_flexo").value
        } else {
          document.getElementById("tramasolidos").style.display = "inline-block"
            document.getElementById("trama_flexo").style.borderColor = "red"
            document.getElementById("error_trama_flexo").innerText = "Eligir un tipo de trama"
            verifica_campos = false
        }
        } else {
        info_tinta["trama_flexo"] = theveryoneprofile.TRAMA_N
        }
        
        if (nombre == "Cyan"){
            if (theveryoneprofile == ""){
            info_tinta["angulo_flexo"] = reticulas[i]    
            } else {
            info_tinta["angulo_flexo"] = theveryoneprofile.ANGULOS_N
            }
            info_tinta["hex"] = "#00FFFF"
        }
        if (nombre == "Magenta"){
            if (theveryoneprofile == ""){
            info_tinta["angulo_flexo"] = reticulas[i]    
            } else {
            info_tinta["angulo_flexo"] = theveryoneprofile.ANGULOMAGENTA_N
            }
            info_tinta["hex"] = "#FF00FF"
        }
        if (nombre == "Yellow"){
            if (theveryoneprofile == ""){
            info_tinta["angulo_flexo"] = reticulas[i]    
            } else {
            info_tinta["angulo_flexo"] = theveryoneprofile.ANGULOAMARILLO_N
            }
            info_tinta["hex"] = "#FFFF00"
        }
        if (nombre == "Black"){
            if (theveryoneprofile == ""){
            info_tinta["angulo_flexo"] = reticulas[i]    
            } else {
            info_tinta["angulo_flexo"] = theveryoneprofile.ANGULONEGRO_N
            }
            info_tinta["hex"] = "#000000"
        }
        if (nombre == "Blanco"){
            if (theveryoneprofile == ""){
            info_tinta["angulo_flexo"] = reticulas[i]    
            } else {
            info_tinta["angulo_flexo"] = theveryoneprofile.ANGULONEGRO_N
            }
            info_tinta["hex"] = "#FFFFFF"
        }
        if (theveryoneprofile == ""){
        if (document.getElementById("trama_solidos_flexo").value  != "undefined"){
        info_tinta["trama_solidos_flexo"] = document.getElementById("trama_solidos_flexo").value 
        } else {
           document.getElementById("tramasolidos").style.display = "inline-block"
            document.getElementById("trama_solidos_flexo").style.borderColor = "red"
             document.getElementById("error_trama_solidos_flexo").innerText = "Eligir un tipo de trama"
            verifica_campos = false 
        }
        } else {
        info_tinta["trama_solidos_flexo"] = theveryoneprofile.TRATAMIENTOSOLIDOSPLE
        }
      //  info_tinta["codigo_facturacion"] = "N/A"
        info_tinta["fotocelula"] = false
        info_tinta["linea_refile"] = false
        info_tinta["pie_imprenta"] = false
        info_tinta["codigo_barras"] = false
        
        
        
        info_tinta["producir"] = document.getElementById("se_produce").checked
        info_tinta["armado"] = document.getElementById("armado").value
        info_tinta["cantidad_planchas"] = document.getElementById("cantidad_planchas").value
        info_tinta["herramental"] =  document.getElementById("herramental").value
        info_tinta["lineatura_2"] =  document.getElementById("lineatura_2").value
        info_tinta["trama_2"] =  document.getElementById("trama_2").value
        info_tinta["tipo_corte"] =  document.getElementById("tipo_corte").value
        info_tinta["desplazado"] =  document.getElementById("desplazado").checked
        info_tinta["corte_especial"] =  document.getElementById("corte_especial").value
        info_tinta["desarollo_especial"] =  document.getElementById("desarollo_especial").value
        if (verifica_campos == true){
        tintas_flexo.push(info_tinta)
        }
        }
        }
        
        
        
        
       
        if (verifica_campos === true){
        preenche_tabela_receita()
        } else {
            alert("Verificar campos en blanco/ No seleccionados!")
            setTimeout(function(){document.getElementById("trama_solidos_flexo").style.borderColor = "#236423";
                                   document.getElementById("trama_flexo").style.borderColor = "#236423";
                                   document.getElementById("lineatura_flexo").style.borderColor = "#236423";
                                   document.getElementById("error_lineatura_flexo").innerText = "";
                                   document.getElementById("error_trama_flexo").innerText = "";
                                   document.getElementById("error_trama_solidos_flexo").innerText = ""
            }, 4000)
        }
     
        
    }
    
    
    
    function adicionar_ogv(){
    //   var valor_hex = chroma(document.getElementById("acor").style.backgroundColor).hex()
         var verifica_campos = true
        var tintas = ["Orange","Green","Violet"]
        var reticulas = ["52.5","22.5","82.5"]
        
        for (i=0;i<tintas.length;i++){
        var nombre = tintas[i]
        
        var existe_tinta = false
        
        for (j=0;j<tintas_flexo.length;j++){
            if (tintas_flexo[j]["nombre_tinta"] == nombre){
                existe_tinta = true
            }
        }
        if (existe_tinta === false){
        var info_tinta = {}
        info_tinta["nombre_tinta"] = nombre
        if (theveryoneprofile == ""){
        if (document.getElementById("lineatura_flexo").value != ""){
        info_tinta["lineatura_flexo"] = document.getElementById("lineatura_flexo").value
        } else {
            document.getElementById("tramasolidos").style.display = "inline-block"
            document.getElementById("lineatura_flexo").style.borderColor = "red"
             document.getElementById("error_lineatura_flexo").innerText = "Llenar lineatura"
            verifica_campos = false
        } } else {
            if (theveryoneprofile.LINEATURA_N.indexOf(" - ") > -1){
                    var onearray = theveryoneprofile.LINEATURA_N.split(" - ")
                    info_tinta["lineatura_flexo"] =  onearray[1]    
            } else {
                    info_tinta["lineatura_flexo"] = theveryoneprofile.LINEATURA_N  
            }
        }
        
        if (theveryoneprofile == ""){
        if (document.getElementById("trama_flexo").value  != "undefined"){
        info_tinta["trama_flexo"] = document.getElementById("trama_flexo").value
        } else {
          document.getElementById("tramasolidos").style.display = "inline-block"
            document.getElementById("trama_flexo").style.borderColor = "red"
            document.getElementById("error_trama_flexo").innerText = "Eligir un tipo de trama"
            verifica_campos = false
        }
        } else {
        info_tinta["trama_flexo"] = theveryoneprofile.TRAMA_N
        }
        
        if (nombre == "Green"){
            if (theveryoneprofile == ""){
            info_tinta["angulo_flexo"] = reticulas[i]    
            } else {
            info_tinta["angulo_flexo"] = theveryoneprofile.ANGULOVERDE_N
            }
            info_tinta["hex"] = "#00FF00"
        }
        if (nombre == "Orange"){
            if (theveryoneprofile == ""){
            info_tinta["angulo_flexo"] = reticulas[i]    
            } else {
            info_tinta["angulo_flexo"] = theveryoneprofile.ANGULONARANJA_N
            }
            info_tinta["hex"] = "#FFA500"
        }
        if (nombre == "Violet"){
            if (theveryoneprofile == ""){
            info_tinta["angulo_flexo"] = reticulas[i]    
            } else {
            info_tinta["angulo_flexo"] = theveryoneprofile.ANGULOVIOLETA_N
            }
            info_tinta["hex"] = "#8F00FF"
        }
        
     if (theveryoneprofile == ""){
        if (document.getElementById("trama_solidos_flexo").value  != "undefined"){
        info_tinta["trama_solidos_flexo"] = document.getElementById("trama_solidos_flexo").value 
        } else {
           document.getElementById("tramasolidos").style.display = "inline-block"
            document.getElementById("trama_solidos_flexo").style.borderColor = "red"
             document.getElementById("error_trama_solidos_flexo").innerText = "Eligir un tipo de trama"
            verifica_campos = false 
        }
        } else {
        info_tinta["trama_solidos_flexo"] = theveryoneprofile.TRATAMIENTOSOLIDOSPLE
        }
        //  info_tinta["codigo_facturacion"] = "N/A"
        info_tinta["fotocelula"] = false
        info_tinta["linea_refile"] = false
        info_tinta["pie_imprenta"] = false
        info_tinta["codigo_barras"] = false
        
        
        
        info_tinta["producir"] = document.getElementById("se_produce").checked
        info_tinta["armado"] = document.getElementById("armado").value
        info_tinta["cantidad_planchas"] = document.getElementById("cantidad_planchas").value
        info_tinta["herramental"] =  document.getElementById("herramental").value
        info_tinta["lineatura_2"] =  document.getElementById("lineatura_2").value
        info_tinta["trama_2"] =  document.getElementById("trama_2").value
        info_tinta["tipo_corte"] =  document.getElementById("tipo_corte").value
        info_tinta["desplazado"] =  document.getElementById("desplazado").checked
        info_tinta["corte_especial"] =  document.getElementById("corte_especial").value
        info_tinta["desarollo_especial"] =  document.getElementById("desarollo_especial").value
        if (verifica_campos == true){
        tintas_flexo.push(info_tinta)
        }
        
        }
        }
        
        
        
        
       
        
       if (verifica_campos === true){
        preenche_tabela_receita()
        } else {
            alert("Verificar campos en blanco/ No seleccionados!")
            setTimeout(function(){document.getElementById("trama_solidos_flexo").style.borderColor = "#236423";
                                   document.getElementById("trama_flexo").style.borderColor = "#236423";
                                   document.getElementById("lineatura_flexo").style.borderColor = "#236423";
                                   document.getElementById("error_lineatura_flexo").innerText = "";
                                   document.getElementById("error_trama_flexo").innerText = "";
                                   document.getElementById("error_trama_solidos_flexo").innerText = ""
            }, 4000)
        }
      
        
    }
    
 
</script>
<script>
    function preenche_tabela_receita(){
       console.log(tintas_flexo.length)
        
        
        clearTable(document.getElementById("tabela_receitas_flexo"))
          
          
         var table = document.getElementById("tabela_receitas_flexo")
        var qtasrow = table.rows.length
      
            
            for (i=0;i<tintas_flexo.length;i++){
            var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
            var cell6 = row.insertCell(5);
            var cell7 = row.insertCell(6);
            var cell8 = row.insertCell(7);
            var cell9 = row.insertCell(8);
            var cell10 = row.insertCell(9);
            var cell11 = row.insertCell(10);
            var cell12 = row.insertCell(11);
            var cell13 = row.insertCell(12);
           
           
           cell1.style.textAlign = "left"
           var numero_cilindro = i+1
           
           var color_produce = "red"
           
           if (tintas_flexo[i].producir === true){
               color_produce = "green"
           }
           
        // checkbox para cambiar tintas en Batch     
          // cell1.innerHTML = '<div style="font-size: 0.8em; display: inline-block;"><input type="checkbox" id="batch_'+tintas_flexo[i].nombre_tinta+'" onclick="batch_tintas()"><div style="display:inline-block; margin-left: 3px"><i onclick="move_acima()" id="'+i+'" class="fas fa-arrow-up" style="margin-right: 5px; cursor: pointer;"></i><i  onclick="move_abaixo()" id="'+i+'" class="fas fa-arrow-down" style="margin-right: 5px;cursor: pointer;"></i><span style="margin-top:5px;height:20px;width:20px;background-color:'+tintas_flexo[i].hex+';border-radius:50%;display:inline-block"></span></div><span style="display: inline-block;"></span></div><strong> '+numero_cilindro+' - '+tintas_flexo[i].nombre_tinta+'</strong></div>'
           
           
           cell1.innerHTML = '<div style="font-size: 0.6em; display: inline-block; text-align: left;"><div style="display:inline-block; margin-left: 3px"><i onclick="move_acima()" id="'+i+'" class="fas fa-arrow-up" style="margin-right: 5px; cursor: pointer;"></i><i onclick="move_abaixo()" id="'+i+'" class="fas fa-arrow-down" style="margin-right: 5px;cursor: pointer;"></i><img id="'+qtasrow+'" onclick="mostraDisclosure()" src="./Icons/showinfo.png" height="20px" id="disclosure_'+i+'" style="margin-left: 5px; margin-right: 5px; vertical-align: baseline;"><span style="vertical-align: baseline;height:15px;width:15px;background-color:'+tintas_flexo[i].hex+';border-radius:50%;display:inline-block"></span></div><span style="display: inline-block;"></span></div><strong> '+numero_cilindro+' - '+tintas_flexo[i].nombre_tinta.replace("PANTONE","P.")+'</strong></div>'
           cell2.innerHTML = '<div style="font-size:1em; cursor: pointer"><input type="text" id="tinta_'+i+'" value="'+tintas_flexo[i].lineatura_flexo+'" class="form-control"  style="font-size: 1em; text-align: center;" readonly></div>'
           cell3.innerHTML = '<div style="font-size:1em; cursor: pointer"><input type="text" id="trama_'+i+'" value="'+tintas_flexo[i].trama_flexo+'" class="form-control" style="font-size: 1em; text-align: center;"  readonly></div>'
            cell4.innerHTML = '<div style="font-size:1em; cursor: pointer"><input type="text" id="angulo_'+i+'" value="'+tintas_flexo[i].angulo_flexo+'" class="form-control" style="font-size: 1em; text-align: center;"  readonly></div>'
           cell5.innerHTML = '<div><span id="'+i+'" style="margin-top:5px;height:15px;width:15px;background-color:'+color_produce+';border-radius:50%;display:inline-block; cursor: pointer" onclick="cambia_seproduce()"></span></div>'
         
          
           var info_armado = ""
           info_armado = info_armado+'<select class="form-control"  id="tipoarmado_'+i+'" style="background-color:#e9ecef; font-size: 1em; text-align: center;" name="tipo_ordem">'
             info_armado = info_armado+'<option disabled>A</option>'
             info_armado = info_armado+'<option disabled>AB</option>'
             info_armado = info_armado+'<option disabled>ABC</option>'
             info_armado = info_armado+'<option disabled>AC</option>'
             info_armado = info_armado+'<option disabled>B</option>'
             info_armado = info_armado+'<option disabled>BC</option>'
             info_armado = info_armado+'<option disabled>C</option>'
             info_armado = info_armado+'</select>'
             
           
           
            cell6.innerHTML = '<div style="font-size:1em; cursor: pointer">'+info_armado+'</div>'
          
            cell7.innerHTML = '<div style="font-size:1em; cursor: pointer"><input type="text" id="herramental_'+i+'" value="'+tintas_flexo[i].herramental+'" class="form-control"  style="font-size: 1em; text-align: center;" readonly></div>'
          
            cell8.innerHTML = '<div style="font-size:1em; cursor: pointer"><input type="text" id="tramasolido_'+i+'" value="'+tintas_flexo[i].trama_solidos_flexo+'" class="form-control" style="font-size: 1em; text-align: center;" readonly></div>'
         
         if (tintas_flexo[i].codigobarras === undefined){
          cell9.innerHTML = '<div style="font-size:1em; cursor: pointer"><input type="checkbox" id="codigobarras_'+i+'" class="form-control" style="height: 1em" disabled></div>'
         } else {
             if (tintas_flexo[i].codigobarras == true){
                cell9.innerHTML = '<div style="font-size:1em; cursor: pointer"><input type="checkbox" id="codigobarras_'+i+'" class="form-control" style="height: 1em" checked disabled></div>'
           
             } else {
                     cell9.innerHTML = '<div style="font-size:1em; cursor: pointer"><input type="checkbox" id="codigobarras_'+i+'" class="form-control" style="height: 1em"disabled></div>'
            
             }
             
         }
           cell10.innerHTML = '<div style="font-size:1em; cursor: pointer"><input type="checkbox" id="pieimprenta_'+i+'" class="form-control" style="height: 1em" disabled ></div>'
           cell11.innerHTML = '<div style="font-size:1em; cursor: pointer"><input type="checkbox" id="fotocelula_'+i+'" class="form-control" style="height: 1em" disabled></div>'
           cell12.innerHTML = '<div style="font-size:1em; cursor: pointer"><input type="checkbox" id="lineafife_'+i+'" class="form-control" style="height: 1em" disabled ></div>'
           
            cell13.innerHTML = '<div style="font-size:1em; cursor: pointer"><input type="text" id="cantidad_'+i+'" value="'+tintas_flexo[i].cantidad_planchas+'" class="form-control" style="font-size: 1em; text-align: center;" readonly></div>'
          
        //    cell14.innerHTML = '<div><img id="editartintaflexo_'+i+'" src="Icons/edit.png" height="15px" onclick="editarTinta()" style="cursor: pointer;"></div>'
            
         //   cell15.innerHTML = '<div><img id="editartintaflexo'+i+'" src="Icons/delete.png" height="15px" onclick="apagarTinta()" style="cursor: pointer;"></div>'
            qtasrow = qtasrow +1
      
           var table = document.getElementById("tabela_receitas_flexo")
             var qtasrow = table.rows.length
              var row2 =  table.insertRow(qtasrow);
            var cell1_2 = row2.insertCell(0);
            cell1_2.colSpan = 15
            cell1_2.style = "background-color: lightgray"
            cell1_2.style = "display: none;"
            
             var string_div = '<div style="width: 100%; display:inline-block; vertical-align: top; padding-top: 5px; ">'
            
            
             // div Doble Lineatura
             string_div = string_div+'<div style="width: 35%; display:inline-block; vertical-align: top; margin-right: 1% ">'
             string_div = string_div+'<div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 100%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px; margin-right: 1%">'
             string_div = string_div+'<p><strong>Doble Color</strong></p>'
             string_div = string_div+'<div  class="form-group" style="display:inline-block; width: 32%; vertical-align: top; margin-right: 1%">'
             string_div = string_div+'<label>Lineatura 2</label>'
             if (tintas_flexo[i].lineatura_flexo2 == ""){
             string_div = string_div+'<input type="text" class="form-control" id="lineatura2_'+i+'" value="No Aplica" readonly>'
             } else {
             string_div = string_div+'<input type="text" class="form-control" id="lineatura2_'+i+'" value="'+tintas_flexo[i].lineatura_flexo2+'"  style="text-align: center"  readonly>'
                 
             }
             string_div = string_div+'</div>'
             string_div = string_div+'<div  class="form-group" style="display:inline-block; width: 32%; vertical-align: top; margin-right: 1%">'
             string_div = string_div+'<label>Angulo 2</label>'
             if (tintas_flexo[i].angulo_flexo2 == ""){
             string_div = string_div+'<input type="text" class="form-control" id="angulo2_'+i+'"  value="No Aplica" readonly>'
             } else {
             string_div = string_div+'<input type="text" class="form-control" id="angulo2_'+i+'"  value="'+tintas_flexo[i].angulo_flexo2+'"  style="text-align: center" readonly>'
             }
             string_div = string_div+'</div>'
             string_div = string_div+'<div  class="form-group" style="display:inline-block; width: 32%; vertical-align: top;">'
             string_div = string_div+'<label>Trama</label>'
             if (tintas_flexo[i].trama_flexo == "undefined"){
             string_div = string_div+'<input type="text" class="form-control" id="trama2_'+i+'"  value="No Aplica" readonly>'
             } else {
             string_div = string_div+'<input type="text" class="form-control" id="trama2_'+i+'"  value="'+tintas_flexo[i].trama_flexo+'" style="text-align: center" readonly>'
                 
             }
             string_div = string_div+'</div>'
             string_div = string_div+"</div>"
            string_div = string_div+"</div>"
            
           
             // div Doble Lineatura
             string_div = string_div+'<div style="border-radius: 20px; background-color: #FAFAFA; box-shadow: 2px 2px #246425; width: 63%;display: inline-block; padding: 20px; vertical-align: top; margin-bottom: 10px;">'
             string_div = string_div+'<p><strong>Corte de Plancha</strong></p>'
             string_div = string_div+'<div  class="form-group" style="display:inline-block; width: 25%; margin-right: 1%;">'
             string_div = string_div+'<label>Tipo de Corte</label>'
             string_div = string_div+'<select class="form-control" id="tipocorte_'+i+'" style="background-color:#e9ecef; text-align: center" onchange="cambia_tipocorte()" >'
             string_div = string_div+'<option selected>Normal</option>'
             string_div = string_div+'<option disabled>Diferencial</option>'
             string_div = string_div+'<option disabled>Escalonado</option>'
             string_div = string_div+'<option disabled>Sinusoidal</option>'
             string_div = string_div+'</select>'
             string_div = string_div+'</div>'
             string_div = string_div+'<div  class="form-group" style="display:inline-block; width: 20%;">'
             if (tintas_flexo[i].desplazado === false){
             string_div = string_div+'<input type="checkbox" class="form-group" id="desplazado_'+i+'" disabled>'
             } else {
             string_div = string_div+'<input type="checkbox" class="form-group" id="desplazado_'+i+'" checked disabled>'    
             }
             string_div = string_div+'<label>Desplazado</label>'
             string_div = string_div+'</div>'
             string_div = string_div+'<div  class="form-group" style="display:inline-block; width: 26%; vertical-align: top; margin-right: 1%">'
             string_div = string_div+'<label>Corte Especial</label>'
             if (tintas_flexo[i].corte_especial === ""){ 
             string_div = string_div+'<input type="text" class="form-control" id="corteespecial_'+i+'"  value="No Aplica" readonly>'
             } else {
             string_div = string_div+'<input type="text" class="form-control" id="corteespecial_'+i+'"  value="'+tintas_flexo[i].corte_especial+'" readonly>'
                 
             }
             string_div = string_div+'</div>'
             string_div = string_div+'<div  class="form-group" style="display:inline-block; width: 26%; vertical-align: top;">'
             string_div = string_div+'<label>Desa. Especial</label>'
             if (tintas_flexo[i].desarollo_especial === ""){ 
             string_div = string_div+'<input type="text" class="form-control" id="desaespecial_'+i+'"  value="No Aplica" readonly>'
             } else {
             string_div = string_div+'<input type="text" class="form-control" id="desaespecial_'+i+'"  value="'+tintas_flexo[i].desarollo_especial+'" readonly>'
                 
             }
             string_div = string_div+'</div>'
            
             string_div = string_div+"</div>"
             
             cell1_2.innerHTML = string_div
           
              qtasrow = qtasrow +1
            var div_tipocorte = "tipocorte_"+i
           document.getElementById(div_tipocorte).value = tintas_flexo[i].tipo_corte
            var div_tipoarmado = "tipoarmado_"+i
            document.getElementById(div_tipoarmado).value = tintas_flexo[i].armado
            
                
            }
   
        
   
    }
    
    
    	function mostraDisclosure(){
  	 console.log(event.srcElement.id)
        var linha = parseInt(event.srcElement.id)+1
        
        var table = document.getElementById("tabela_receitas_flexo")
  
        if (table.rows[linha].children[0].style.display == "none"){
            table.rows[linha].children[0].style = "background-color: #EEE;"
            table.rows[linha].children[0].colSpan = 15
        } else {
            table.rows[linha].children[0].style = "display: none;" 
        }
        
      }
    
    function cambia_seproduce(){
      var linha = parseInt(event.srcElement.id)
      if (tintas_flexo[linha].producir === false){
          tintas_flexo[linha].producir = true
      } else {
          tintas_flexo[linha].producir = false
      }
      preenche_tabela_receita()
    }
    
   
    
    
    function cambia_tipocorte(){
      var linha = event.srcElement.id
      var linha_array = linha.split("_")
      var div_corteespecial= "corteespecial_"+linha_array[1]
      var div_desaespecial= "desaespecial_"+linha_array[1]
      
      if (document.getElementById(linha).value == "Normal"){
          document.getElementById(div_corteespecial).readOnly = true
          document.getElementById(div_desaespecial).readOnly = true
      } else {
        
          document.getElementById(div_corteespecial).readOnly = false
          document.getElementById(div_desaespecial).readOnly = false  
          document.getElementById(div_corteespecial).value = "No Aplica"
          document.getElementById(div_desaespecial).value = "No Aplica"
      }
    }
    
    function move_acima(){
       var linha = parseInt(event.srcElement.id)
     //  console.log(linha)
       
      
        if (linha > 0){
       array_move(tintas_flexo,linha,linha-1)
        }

       preenche_tabela_receita()
 
        
    }
        
        function move_abaixo(){
          var linha = parseInt(event.srcElement.id)
    //   console.log(linha)
    
    
       if (linha < tintas_flexo.length-1){
           array_move(tintas_flexo,linha,linha+1)
       }
       
       preenche_tabela_receita()
 
       }
       
       function coloca_cameron(){
           var linha = event.srcElement.id
           
           for (i=0;i<tintas_flexo.length;i++){
               if (tintas_flexo[i].cor === linha){
                   tintas_flexo[i].cameron = document.getElementById(linha).checked
               }
           }
       }
       
       function coloca_fotocelula(){
           var linha = event.srcElement.id
           
           for (i=0;i<tintas_flexo.length;i++){
               if (tintas_flexo[i].cor === linha){
                   
                   tintas_flexo[i].fotocelula = document.getElementById(linha).checked
               }
           }
       }
      
        
    
    
    
    
    
    
    
     function apagarTinta(){
    if (confirm("Al aceptar, la tinta se va a borrar, esta operación no és posible de deshacer.") === true){     
    var linha = event.srcElement.id
    console.log(linha)
    for (i=0;i<tintas_flexo.length;i++){
        
        if (tintas_flexo[i].nombre_tinta === linha){
            console.log("vou tirar")
            var tira = tintas_flexo.splice(i,1)
        }
    }
    
    var nombre_perfil = "CMYK"
    
    console.log(tintas_flexo.length)
    
    if (document.getElementById("gamaexpandida_si").checked === true){
        console.log("estou no IF!!")
        for (i=0;i<tintas_flexo.length;i++){
            console.log("nome da tinta")
            console.log(tintas_flexo[i].nombre_tinta)
            if (tintas_flexo[i].nombre_tinta == "Orange"){
                nombre_perfil = nombre_perfil+"O"
                
            }
            if (tintas_flexo[i].nombre_tinta == "Green"){
                nombre_perfil = nombre_perfil+"G"
                
            }
            if (tintas_flexo[i].nombre_tinta == "Violet"){
                nombre_perfil = nombre_perfil+"V"
                
            }
            
         if (nombre_perfil == "CMYK"){
             var cambiar_perfil = false
             alert("No hay más tintas de Gama Expandida, por favor verificar el perfil de color")
         }   else { 
          //console.log(nombre_perfil) 
          var cambiar_perfil = true
          document.getElementById("color_gamaexpandida").value = nombre_perfil
         }
          
        }
        if (cambiar_perfil === true){
        llena_nombre("cambio_perfil")
        }
        
    } 
        
        preenche_tabela_receita()

        
    }
     }
     
    
     function editarTinta(){
     var linha = event.srcElement.id
    console.log(linha)
    var linha_array = linha.split("_")
   
    var div_lineatura = "tinta_"+linha_array[1]
    var div_trama = "trama_"+linha_array[1]
     var div_trama2 = "trama2_"+linha_array[1]
    var div_angulo = "angulo_"+linha_array[1]
    var div_cantidad = "cantidad_"+linha_array[1]
    var div_lineatura2= "lineatura2_"+linha_array[1]
     var div_angulo2= "angulo2_"+linha_array[1]
     var div_tipoarmado= "tipoarmado_"+linha_array[1]
     var div_tipocorte= "tipocorte_"+linha_array[1]
     var div_desplazado= "desplazado_"+linha_array[1]
      var div_corteespecial= "corteespecial_"+linha_array[1]
      var div_desaespecial= "desaespecial_"+linha_array[1]
      var div_codigobarras = "codigobarras_"+linha_array[1]
      var div_pieimprenta = "pieimprenta_"+linha_array[1]
      var div_fotocelula = "fotocelula_"+linha_array[1]
      var div_lineafife = "lineafife_"+linha_array[1]
      var div_herramental = "herramental_"+linha_array[1]
    
    if (document.getElementById(div_lineatura).readOnly === true){
        document.getElementById(div_lineatura).readOnly = false
        document.getElementById(div_trama).readOnly = false
        document.getElementById(div_trama2).readOnly = false
        document.getElementById(div_herramental).readOnly = false
        document.getElementById(div_angulo).readOnly = false
        document.getElementById(div_cantidad).readOnly = false
        document.getElementById(div_lineatura2).readOnly = false
        document.getElementById(div_angulo2).readOnly = false
        document.getElementById(div_codigobarras).disabled = false
        document.getElementById(div_pieimprenta).disabled = false
        document.getElementById(div_fotocelula).disabled = false
        document.getElementById(div_lineafife).disabled = false
        var selectArmado = document.getElementById(div_tipoarmado)
        for (i=0;i<selectArmado.options.length;i++){
            selectArmado.options[i].disabled = false
        }
        selectArmado.style.backgroundColor = "white"
       var selectTipocorte = document.getElementById(div_tipocorte)
       for (i=0;i<selectTipocorte.options.length;i++){
            selectTipocorte.options[i].disabled = false
        }
        selectTipocorte.style.backgroundColor = "white"
        document.getElementById(div_desplazado).disabled = false
         document.getElementById(div_corteespecial).readOnly = false
         document.getElementById(div_desaespecial).readOnly = false
       
    } else {
         document.getElementById(div_lineatura).readOnly = true
        document.getElementById(div_trama).readOnly = true
        document.getElementById(div_angulo).readOnly = true
        document.getElementById(div_cantidad).readOnly = true
        document.getElementById(div_lineatura2).readOnly = true
         document.getElementById(div_trama2).readOnly = true
         document.getElementById(div_herramental).readOnly = true
        document.getElementById(div_angulo2).readOnly = true
        document.getElementById(div_codigobarras).disabled = true
        document.getElementById(div_pieimprenta).disabled = true
        document.getElementById(div_fotocelula).disabled = true
        document.getElementById(div_lineafife).disabled = true
        
        var selectArmado = document.getElementById(div_tipoarmado)
        for (i=0;i<selectArmado.options.length;i++){
            selectArmado.options[i].disabled = true
            
        }
        selectArmado.style.backgroundColor = "#e9ecef"
       var selectTipocorte = document.getElementById(div_tipocorte)
       for (i=0;i<selectTipocorte.options.length;i++){
            selectTipocorte.options[i].disabled = true
        }
        selectTipocorte.style.backgroundColor = "#e9ecef"
        document.getElementById(div_desplazado).disabled = true
         document.getElementById(div_corteespecial).readOnly = true
         document.getElementById(div_desaespecial).readOnly = true
        
        var cual_tinta = parseInt(linha_array[1])
        tintas_flexo[cual_tinta]["lineatura_flexo"] = document.getElementById(div_lineatura).value
        tintas_flexo[cual_tinta]["angulo_flexo"] = document.getElementById(div_angulo).value
        tintas_flexo[cual_tinta]["trama_flexo"] = document.getElementById(div_trama).value
        tintas_flexo[cual_tinta]["cantidad_planchas"] = document.getElementById(div_cantidad).value
        tintas_flexo[cual_tinta]["lineatura_flexo2"] = document.getElementById(div_lineatura2).value
        tintas_flexo[cual_tinta]["angulo_flexo2"] = document.getElementById(div_angulo2).value
        tintas_flexo[cual_tinta]["tipo_armado"] = document.getElementById(div_tipoarmado).value
        tintas_flexo[cual_tinta]["tipo_corte"] = document.getElementById(div_tipocorte).value
        tintas_flexo[cual_tinta]["codigobarras"] = document.getElementById(div_codigobarras).checked
        tintas_flexo[cual_tinta]["pieimprenta"] = document.getElementById(div_pieimprenta).checked
        tintas_flexo[cual_tinta]["fotocelula"] = document.getElementById(div_fotocelula).checked
        tintas_flexo[cual_tinta]["linearefile"] = document.getElementById(div_lineafife).checked
        tintas_flexo[cual_tinta]["trama_flexo2"] = document.getElementById(div_trama2).value
        tintas_flexo[cual_tinta]["herramental"] = document.getElementById(div_herramental).value
        
    }
    
    }
    
  </script>
    

  <script>
       function muda_cor(){
    if (document.getElementById("valor_L").value != "" &&
        document.getElementById("valor_A").value != "" &&
        document.getElementById("valor_B").value != ""){
    
      var o_L = parseInt(document.getElementById("valor_L").value)
       var o_A = parseInt(document.getElementById("valor_A").value)
        var o_B = parseInt(document.getElementById("valor_B").value)
     
        
    var resultado = chroma.lab(o_L,o_A,o_B)
     var valores_reg = resultado._rgb 
     var hex = rgbToHex(parseInt(valores_reg[0]),parseInt(valores_reg[1]),parseInt(valores_reg[2]))
     var valorlch = chroma.lab(o_L,o_A,o_B).lch()
     document.getElementById("acor").style = "background-color: "+hex+"; width: 30px; border: none; display: inline-block;"
     document.getElementById("nombre_tinta").value = valorlch[0].toFixed(0)+"_"+valorlch[1].toFixed(0)+"_"+valorlch[2].toFixed(0)+"-"+nombre_color_actual
  
  
   setTimeout(function(){document.getElementById("div_valoresLAB").style.display = "none";document.getElementById("valor_L").value = "";
                        document.getElementById("valor_A").value = "";document.getElementById("valor_B").value = "" },2000)
            
            
        } else {
      document.getElementById("nombre_tinta").value = nombre_color_actual
      
      
  }
  
        }
   var nombre_color_actual = ""
    function seleciona_pantone(){
        
        var busca_tinta = api.custom_objects.list_with_options("PantoneColor",["nome","equal to",document.getElementById("nombre_tinta").value]).results
        document.getElementById("div_valoresLAB").style.display = "none"
        if (busca_tinta.length > 0){
            
            
             document.getElementById("acor").style = "background-color: "+busca_tinta[0].cor+"; width: 30px; border: none; display: inline-block;"
           
            
        } else {
            document.getElementById("div_valoresLAB").style.display = "inline-block"
            nombre_color_actual = document.getElementById("nombre_tinta").value
        }
    } 
    

  
  
    </script>
 
  	
<script>
  
    
  
</script>
 



<script>

var n_butonsTimeOut = 0;
var workButonsTimeOut
var butonsTimeOut = function ()
{   n_butonsTimeOut++;
    buttonsControls()
    console.log("Opa olha eu aqui ..."+n_butonsTimeOut)
    if (n_butonsTimeOut>300)
    {   //workButonsTimeOut = setTimeout(butonsTimeOut, 5000); // Roda apenas 1x
      clearInterval(workButonsTimeOut)
      //workButonsTimeOut = setInterval(butonsTimeOut, 6000)
    }
}

function buttonsControls(st)
    {  if (st != undefined) 
        { 
        }
        else {st=""}
        success = document.getElementsByClassName("success")
        statuses = document.getElementsByClassName("status")
        console.log(success.length)
        console.log(statuses.length)
        botaoenv = document.getElementById("registerButton")
        botaoup = document.getElementsByClassName("upload_button")
        if ((success.length==2) && (statuses.length>=0))
        { if(success[0].innerText.indexOf("Completed")>=0)
          { botaoenv.style.display = "inline-block"
            botaoup[0].style.display = "inline-block"
          }      
        }   
        if ((success.length<=1) && (statuses.length<0))
        { 
            botaoenv.style.display = "none"
            botaoup[0].style.display = "inline-block"
            botaoup[0].style.background = "none"  
        } 
    }
    
//document.getElementById("hora_email").max = dateFormat(new Date(),"yyyy-mm-dd")

</script>
<script>

    function adiciona_indicacion(){
       if (document.getElementById("depto_indicaciones").value != "undefined" &&
            document.getElementById("indicacion").value != ""){ 
        var data = {}
        data["fecha_creacion"] = new Date()
        data["creado_por"] = usuario.fullname
        data["depto"] = document.getElementById("depto_indicaciones").value
        data["indicacion"] = document.getElementById("indicacion").value 
        data["verificada"] = false
        indicaciones.push(data)
            } else {
                if (document.getElementById("depto_indicaciones").value == "undefined"){
                    document.getElementById("depto_indicaciones").style.borderColor = "red"
                }
            }
            
        document.getElementById("depto_indicaciones").value = "undefined"
        document.getElementById("indicacion").value = ""
        preenche_indicaciones()
    }
    
    var ind_soporte = 0
    var ind_prenprensa = 0
    var ind_programacion = 0
    var ind_grabacion = 0
    var ind_facturacion = 0
    
     function preenche_indicaciones(){
        
       
        clearTable(document.getElementById("tabela_indicaciones"))
          
          
         var table = document.getElementById("tabela_indicaciones")
        var qtasrow = table.rows.length
      
            
            for (i=0;i<indicaciones.length;i++){
          
            var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
            
            var cell6 = row.insertCell(5);
            
            var cell7 = row.insertCell(6);
            
           
           
           cell1.style.textAlign = "left"
          
           cell1.innerHTML = '<div style="font-size:1em;">'+dateFormat(new Date(indicaciones[i].fecha_creacion),"dd/mm/yyyy HH:MM")+'hs</div>'
           cell2.innerHTML = '<div style="font-size:1em;">'+indicaciones[i].creado_por+'</div>'
           cell3.innerHTML = '<div style="font-size:1em;">'+indicaciones[i].depto+'</div>'
         if (indicaciones[i].verificada === false){
           cell4.innerHTML = '<div style="font-size:1em; cursor: pointer"><textarea  id="indicacion_'+i+'" class="form-control" rows="2" readonly>'+indicaciones[i].indicacion+'</textarea></div>'
         } else {
            if (indicaciones[i].status == "Realizada"){
               cell4.innerHTML = '<div style="font-size:1em; cursor: pointer"><textarea  id="indicacion_'+i+'" class="form-control" rows="2" style="background-color: #b5d9b4" readonly>'+indicaciones[i].indicacion+'</textarea></div>'
        
            } else {
                  cell4.innerHTML = '<div style="font-size:1em; cursor: pointer"><textarea  id="indicacion_'+i+'" class="form-control" rows="2" style="background-color: #d9b4b4" readonly>'+indicaciones[i].indicacion+'</textarea></div>'
                
            }
         }
        
          
        if (indicaciones[i].verificada === false){
         
         if (usuario.username != "admin"){
             console.log(indicaciones[i].depto)
             console.log(usuario.scope_name[0])
          if (indicaciones[i].depto == usuario.scope_name[0]){
         
           cell5.innerHTML = '<div><img id="indicacionapoagar_'+i+'" src="Icons/like_vazio.png" height="35px" onclick="realizarIndicacion()" style="cursor: pointer;"></div>'
           cell6.innerHTML = '<div><img id="indicacioneditar_'+i+'" src="Icons/unlike_vazio.png" height="35px" onclick="realizarIndicacion()" style="cursor: pointer;"></div>'
          
              
          } else {
              if (indicaciones[i].creado_por == usuario.fullname){
                 cell5.innerHTML = '<div><img id="indicacionapoagar_'+i+'" src="Icons/edit.png" height="20px" onclick="editarIndicacion()" style="cursor: pointer;"></div>'
                    cell6.innerHTML = '<div><img id="indicacioneditar_'+i+'" src="Icons/delete.png" height="20px" onclick="apagarIndicacion()" style="cursor: pointer;"></div>'
          
              } else {
              cell5.innerHTML = '<div><img id="indicacionapoagar_'+i+'" src="Icons/noedit.png" height="20px"  style="cursor: pointer;"></div>'
              cell6.innerHTML = '<div><img id="indicacioneditar_'+i+'" src="Icons/nodelete.png" height="20px"  style="cursor: pointer;"></div>'
              }
          }
          } else {
                     cell5.innerHTML = '<div><img id="indicacionapoagar_'+i+'" src="Icons/edit.png" height="20px" onclick="editarIndicacion()" style="cursor: pointer;"></div>'
                    cell6.innerHTML = '<div><img id="indicacioneditar_'+i+'" src="Icons/delete.png" height="20px" onclick="apagarIndicacion()" style="cursor: pointer;"></div>'
         
            
          
          
           
        } 
         
        } else {
            if (indicaciones[i].status == "Realizada"){
                 cell5.innerHTML = '<div><img id="indicacionapoagar_'+i+'" src="Icons/like_verde.png" height="35px" onclick="realizarIndicacion()" style="cursor: pointer;"></div>'
           cell6.innerHTML = '<div><img id="indicacioneditar_'+i+'" src="Icons/unlike_vazio.png" height="35px" onclick="realizarIndicacion()" style="cursor: pointer;"></div>'
          
            } else {
                 cell5.innerHTML = '<div><img id="indicacionapoagar_'+i+'" src="Icons/like_vazio.png" height="35px" onclick="realizarIndicacion()" style="cursor: pointer;"></div>'
           cell6.innerHTML = '<div><img id="indicacioneditar_'+i+'" src="Icons/unlike_vermelho.png" height="35px" onclick="realizarIndicacion()" style="cursor: pointer;"></div>'
          
            }
        }
        
        qtasrow = qtasrow +1
      
         
                
            
            
            }
        
   
    }
         function apagarIndicacion(){
        var linha = event.srcElement.id
        var linha_array = parseInt(linha.split("_")[1])
        var tira = indicaciones.splice(linha_array,1)
        preenche_indicaciones()
     }
    
    function editarIndicacion(){
     var linha = event.srcElement.id
    console.log(linha)
    var linha_array = linha.split("_")
    var div_lineatura = "indicacion_"+linha_array[1]
   
    
    if (document.getElementById(div_lineatura).readOnly === true){
        document.getElementById(div_lineatura).readOnly = false
       
       
    } else {
         document.getElementById(div_lineatura).readOnly = true
       
        
        var cual_tinta = parseInt(linha_array[1])
        indicaciones[cual_tinta]["indicacion"] = document.getElementById(div_lineatura).value
        
        
    }
    
    }
</script>


<script>
  	    
  	    function adiciona_fotocelula(){
  	         var linha = event.srcElement.id
  	         console.log(linha)
  	        var existe = false
  	        for (i=0;i<fotocelulas.length;i++){
  	            if (fotocelulas[i] == linha){
  	                existe = true
  	            }
  	        }
  	        
  	        console.log(existe)
  	        if (existe === false){
  	            var objeto = document.getElementById(linha)
                 objeto.style.background = "black"
                 fotocelulas.push(linha)
  	        } else {
  	            for (i=0;i<fotocelulas.length;i++){
  	                if (fotocelulas[i] == linha){
  	                    var tira = fotocelulas.splice(i,1)
  	                    var objeto = document.getElementById(linha)
                 objeto.style.background = "lightgray"
  	                    
  	                }
  	            }
  	        }
  	        
  	        
  	        
  	    }
</script>
   

 <script>
     function verifica_facturable(){
      var que_cliente = api.custom_objects.list_with_options("AR-BOSISIO_clientes",["DENOMINACION","equal to",document.getElementById("facturable_a").value],[],["lista_precios"]).results   
      console.log(que_cliente.length)
      
      if (que_cliente.length > 0){
      
      $("#lista_precios").find('option').not(':first').remove()
      
      var nombres_lista = []
      
      for (i=0;i<que_cliente[0].lista_precios.length;i++){
          nombres_lista.push(que_cliente[0].lista_precios[i].NombreLP)
      }
      var lista_unicos = nombres_lista.filter(onlyUnique)
      
      var selectListaPrecio = document.getElementById("lista_precios")
   
   for (i=0;i<lista_unicos.length;i++){
      var opt = document.createElement('option');
        opt.value = lista_unicos[i];
        opt.innerHTML = lista_unicos[i];
        selectListaPrecio.appendChild(opt);
   }
      }
         
     }
 </script> 	
  
<script>
    function existe_pieimprenta(){
        if (document.getElementById("pie_imprenta_si").checked === true){
            document.getElementById("div_pie_imprenta").style.display = "inline-block"
        } else {
            document.getElementById("div_pie_imprenta").style.display = "none"
        }
    }
    
    function liberar_preprensa(){
        if (document.getElementById("liberado_preprensa").value === "Si"){
            document.getElementById("liberado_preprensa").value = "No"
            document.getElementById("liberado_preprensa").style.backgroundColor = "red"
        } else {
            document.getElementById("liberado_preprensa").value = "Si"
            document.getElementById("liberado_preprensa").style.backgroundColor = "green"
        }
    }
    
    
    
      function existe_linearefile(){
        if (document.getElementById("linea_refile_si").checked === true){
            document.getElementById("div_anchopie").style.display = "inline-block"
            document.getElementById("div_ubicacionpie").style.display = "inline-block"
        } else {
            document.getElementById("div_anchopie").style.display = "none"
            document.getElementById("div_ubicacionpie").style.display = "none"
            document.getElementById("ancho_linearefile").value = ""
            document.getElementById("posicion_linearefile").value = ""
        }
    }
    
    
    
      function existe_codigobarras(){
        if (document.getElementById("codigo_barras_si").checked === true){
            document.getElementById("div_numerocodigo").style.display = "inline-block"
            document.getElementById("div_magcodigo").style.display = "inline-block"
            document.getElementById("div_bwrcodigo").style.display = "inline-block"
            document.getElementById("div_caladocodigo").style.display = "inline-block"
            
        } else {
            document.getElementById("div_numerocodigo").style.display = "none"
            document.getElementById("div_magcodigo").style.display = "none"
            document.getElementById("div_bwrcodigo").style.display = "none"
            document.getElementById("div_caladocodigo").style.display = "none"
        }
    }
    
    function existe_textolegal(){
       if (document.getElementById("textolegal_si").checked === true){
            document.getElementById("div_textoslegales").style.display = "inline-block"
        } else {
            document.getElementById("div_textoslegales").style.display = "none"
        } 
        
        
    }
  
    function cambia_tipo_trabajo(){
        if (document.getElementById("tipo_trabajo").value == "CAMBIOS" || document.getElementById("tipo_trabajo").value == "REPOSICIÓN POR RECLAMO" || document.getElementById("tipo_trabajo").value == "REPOSICIÓN SIN CAMBIOS"){
            document.getElementById("div_ordenanterior").style.display = "inline-block"
             document.getElementById("div_codigoanterior").style.display = "inline-block"
        } else {
            document.getElementById("div_ordenanterior").style.display = "none"
             document.getElementById("div_codigoanterior").style.display = "none"
        }
    }
</script>

<script>
    function muda_tipoordem(){
        if (document.getElementById("tipo_ordem").value == "Huecograbado"){
            document.getElementById("div_colores_hueco").style.display = "inline-block"
            document.getElementById("div_colores_flexo").style.display = "none"
        } else {
            document.getElementById("div_colores_hueco").style.display = "none"
            document.getElementById("div_colores_flexo").style.display = "inline-block"
        }
        
    }
    

   
    function es_gamaexpandida(){
        $("#informacion_impresion").find('option').not(':first').remove();
       selectPerfiles = []
        
         document.getElementById("nombre_perfil").value = ""
               // document.getElementById("nombre_perfil").style.color = "white"
            //    document.getElementById("nombre_perfil").style.backgroundColor = "green"
                document.getElementById("material").value = ""
                document.getElementById("sentido").value =""
                document.getElementById("maquina").value = ""
                document.getElementById("lineatura").value = ""
                document.getElementById("fabricante_polimero").value = ""
                document.getElementById("espesor_polimero").value = ""
                document.getElementById("fabricante_polimeroblanco").value = ""
                document.getElementById("fabricante_polimerobarniz").value = ""
                theveryoneprofile= ""
        
        
       if (document.getElementById("gamaexpandida_si").checked === false){
           document.getElementById("color_gamaexpandida").value = "undefined"
           document.getElementById('div_gamaexpandida').style.display = "none"
           for (i=0;i<perfiles.length;i++){
               if (apenasCMYK.test(perfiles[i].TINTASDOCUMENTO_N) === true){
                var theprofilename = perfiles[i].CODIGO
                var thearrayprofile = theprofilename.split("_")
                var nombre_perfil = ""
                for (j=0;j<thearrayprofile.length-1;j++){
                  nombre_perfil=nombre_perfil+  thearrayprofile[j]+"_"
                    
                    
                }
                nombre_perfil = nombre_perfil.substring(0,nombre_perfil.length-1)
                   selectPerfiles.push(nombre_perfil)
               }
               
               
           }
           
           
       } else {
            document.getElementById("color_gamaexpandida").value = "undefined"
          document.getElementById("informacion_impresion").value = "undefined"
           document.getElementById('div_gamaexpandida').style.display = "inline-block"
           
           
           
           for (i=0;i<perfiles.length;i++){
               if (perfiles[i].TINTASDOCUMENTO_N.length > 4 && apenasCMYKOVG.test(perfiles[i].TINTASDOCUMENTO_N) === true){
                var theprofilename = perfiles[i].CODIGO
                var thearrayprofile = theprofilename.split("_")
                var nombre_perfil = ""
                for (j=0;j<thearrayprofile.length-1;j++){
                  nombre_perfil=nombre_perfil+  thearrayprofile[j]+"_"
                    
                    
                }
                nombre_perfil = nombre_perfil.substring(0,nombre_perfil.length-1)
                   selectPerfiles.push(nombre_perfil)
               }
               
               
           }
       }
       var thecleanprofiles = selectPerfiles.filter(onlyUnique)
        
        var theselectPerfiles = document.getElementById("informacion_impresion")
       thecleanprofiles.sort() 
for (var i = 0; i<thecleanprofiles.length; i++){
        var opt = document.createElement('option');
        opt.value = thecleanprofiles[i];
        opt.innerHTML = thecleanprofiles[i];
        theselectPerfiles.appendChild(opt);
    }
    
    }
    
   
   
   
 //   var perfiles = []
    
    function llena_perfiles(){
        if (document.getElementById("cliente").value != ''){
            
            var busca_cliente = api.custom_objects.list_with_options("AR-BOSISIO_clientes",["DENOMINACION","equal to",document.getElementById("cliente").value]).results
            
            if (busca_cliente.length > 0){
                   perfiles = busca_cliente[0].datos_tecnicos
                 
                
            }
            
             var thecliente = document.getElementById("cliente").value
        
            var numeros_orden_antigos = api.custom_objects.list_with_options("AR-BOSISIO_calypso",["cliente","equal to",thecliente],[],["numero_op"]).results
            
            var selectOrdenes = document.getElementById("orden_anterior")
            
            for (var i = 0; i<numeros_orden_antigos.length; i++){
                    var opt = document.createElement('option');
                    opt.value = numeros_orden_antigos[i].numero_op;
                    opt.innerHTML = numeros_orden_antigos[i].numero_op;
                    selectOrdenes.appendChild(opt);
                }
                
                
         
        }
        
    }
    
    var theveryoneprofile = buscaOT.datos_tecnicos
    
    function llena_nombre(que_hacer){
        
     
       
        
        
        
        if (document.getElementById("informacion_impresion").value != "undefined"){
        var nombre = document.getElementById("informacion_impresion").value
        var extension_color = document.getElementById("color_gamaexpandida").value
        if (extension_color != "undefined"){
            nombre = nombre+"_"+extension_color
        } else {
            nombre = nombre+"_CMYK"
        }
        
        for (i=0;i<perfiles.length;i++){
            if (perfiles[i].CODIGO == nombre){
                
                
                
                theveryoneprofile = perfiles[i]
                document.getElementById("nombre_perfil").value = theveryoneprofile.CODIGO
                document.getElementById("nombre_perfil").style.color = "white"
                document.getElementById("nombre_perfil").style.backgroundColor = "green"
                if (theveryoneprofile.MATERIAL_N.indexOf(" - ") > -1){
                    var material_array = theveryoneprofile.MATERIAL_N.split(" - ")
                    document.getElementById("material").value = material_array[1]
                } else {
                document.getElementById("material").value = theveryoneprofile.MATERIAL_N
                }
                if (theveryoneprofile.SENTIDOIMPRESION_N.indexOf(' - ') > -1){
                    var sentido_array = theveryoneprofile.SENTIDOIMPRESION_N.split(' - ')
                    document.getElementById("sentido").value = sentido_array[1]
                } else {
                document.getElementById("sentido").value = theveryoneprofile.SENTIDOIMPRESION_N
                }
                document.getElementById("maquina").value = theveryoneprofile.MAQUINAIMPRESORA
                if (theveryoneprofile.LINEATURA_N.indexOf(" - ") > -1){
                    var lineatura_array = theveryoneprofile.LINEATURA_N.split(" - ")
                    document.getElementById("lineatura").value = lineatura_array[1]
                    var thecurrentlinescreen = lineatura_array[1]
                    
                } else {
                document.getElementById("lineatura").value = theveryoneprofile.LINEATURA_N
                    thecurrentlinescreen = theveryoneprofile.LINEATURA_N
                }
                if (theveryoneprofile.FABRICANTEPOLIMERO_N.indexOf(" - ") > -1){
                    var fabricante_array = theveryoneprofile.FABRICANTEPOLIMERO_N.split(" - ")
                    document.getElementById("fabricante_polimero").value = fabricante_array[1]
                } else {
                document.getElementById("fabricante_polimero").value = theveryoneprofile.FABRICANTEPOLIMERO_N
                }
                document.getElementById("espesor_polimero").value = theveryoneprofile.ESPESORPOLIMERO_N
                if (theveryoneprofile.FABRICANTEPOLIMEROBLA.indexOf(' - ') > -1){
                    var blanco_array = theveryoneprofile.FABRICANTEPOLIMEROBLA.split(" - ")
                    document.getElementById("fabricante_polimeroblanco").value = blanco_array[1]
                } else {
                document.getElementById("fabricante_polimeroblanco").value = theveryoneprofile.FABRICANTEPOLIMEROBLA
                }
                if (theveryoneprofile.FABRICANTEPOLIMEROBAR.indexOf(" - ") > -1){
                    var barniz_array = theveryoneprofile.FABRICANTEPOLIMEROBAR.split(" - ") 
                    document.getElementById("fabricante_polimerobarniz").value = barniz_array[1]
                } else {
                document.getElementById("fabricante_polimerobarniz").value = theveryoneprofile.FABRICANTEPOLIMEROBAR
                }
                document.getElementById("lineatura_flexo").value = thecurrentlinescreen
                
                
            }
        }
        }
        
        
        if (que_hacer != undefined){
            preenche_tabela_receita()    
    
        }
    }
    
</script>
<script>
       function mostra_fotocelula(){
        if (document.getElementById("fotocelula_segunplano").checked === true){
            document.getElementById("mostra_fotocelula1").style.display = "none"
            document.getElementById("mostra_fotocelula2").style.display = "none"
            document.getElementById("mostra_fotocelula3").style.display = "none"
        } else {
            if (document.getElementById("fotocelula_seaplica").checked === false){
          document.getElementById("mostra_fotocelula1").style.display = "inline-block"
            document.getElementById("mostra_fotocelula2").style.display = "inline-block"
            document.getElementById("mostra_fotocelula3").style.display = "inline-block" 
            }
        }
        
    }
    
    function mostra_aplica(){
       if (document.getElementById("fotocelula_seaplica").checked === true){
           document.getElementById("fotocelula_segunplano").checked = false
           document.getElementById("fotocelula_segunplano").disabled = true
           document.getElementById("div_dimensoes_taco").style.display = "none"
           document.getElementById("mostra_fotocelula1").style.display = "none"
            document.getElementById("mostra_fotocelula2").style.display = "none"
            document.getElementById("mostra_fotocelula3").style.display = "none"
       } else {
           document.getElementById("fotocelula_segunplano").disabled = false
         document.getElementById("div_dimensoes_taco").style.display = "inline-block"  
         if (document.getElementById("fotocelula_segunplano").checked === false){
           document.getElementById("mostra_fotocelula1").style.display = "inline-block"
            document.getElementById("mostra_fotocelula2").style.display = "inline-block"
            document.getElementById("mostra_fotocelula3").style.display = "inline-block"   
         }
       }
        
    }
</script>


<script>
    function mostra_info_tinta(){
        if (document.getElementById("masinfotinta").style.display == "none"){
            document.getElementById("masinfotinta").style.display = "inline-block"
            document.getElementById("btn-masinfotinta").style.display = "none"
            document.getElementById("btn-menosinfotinta").style.display = "inline-block"
        } else {
            document.getElementById("masinfotinta").style.display = "none"
            document.getElementById("btn-masinfotinta").style.display = "inline-block"
            document.getElementById("btn-menosinfotinta").style.display = "none"
        }
    }
</script>
<script>
    function existe_trama_solidos(){
        if (document.getElementById("hay_tramasolidos").checked === true){
            document.getElementById("tramasolidos").style.display = "inline-block"
        } else {
            
            document.getElementById("tramasolidos").style.display = "none"
        }
    }
</script>
<script>

    function llena_datos_orden(){
        document.getElementById("codigo_anterior").value = ""
        if (document.getElementById("orden_anterior").value != "undefined"){
            var busca_orden = api.custom_objects.list_with_options("AR-BOSISIO_calypso",["numero_op","equal to",document.getElementById("orden_anterior").value]).results
            document.getElementById("cliente").value = busca_orden[0].cliente
         //   document.getElementById("facturable_a").value = busca_orden[0].info_facturacion.facturable_a
            document.getElementById("tipo_ordem").value = busca_orden[0].tipo_ordem
            //document.getElementById("tipo_trabajo").value = busca_orden[0].tipo_trabajo
            document.getElementById("nombre_producto").value = busca_orden[0].nombre_producto
            document.getElementById("codigo_producto").value = busca_orden[0].codigo_producto
            for (i=0;i<perfiles.length;i++){
              if (perfiles[i].NOMBRE == busca_orden[0].datos_tecnicos.informacion_impresion){
                
                
                theveryoneprofile = perfiles[i]
                document.getElementById("nombre_perfil").value = theveryoneprofile.CODIGO
                document.getElementById("nombre_perfil").style.color = "white"
                document.getElementById("nombre_perfil").style.backgroundColor = "green"
                if (theveryoneprofile.MATERIAL_N.indexOf(" - ") > -1){
                    var material_array = theveryoneprofile.MATERIAL_N.split(" - ")
                    document.getElementById("material").value = material_array[1]
                } else {
                document.getElementById("material").value = theveryoneprofile.MATERIAL_N
                }
                if (theveryoneprofile.SENTIDOIMPRESION_N.indexOf(' - ') > -1){
                    var sentido_array = theveryoneprofile.SENTIDOIMPRESION_N.split(' - ')
                    document.getElementById("sentido").value = sentido_array[1]
                } else {
                document.getElementById("sentido").value = theveryoneprofile.SENTIDOIMPRESION_N
                }
                document.getElementById("maquina").value = theveryoneprofile.MAQUINAIMPRESORA
                if (theveryoneprofile.LINEATURA_N.indexOf(" - ") > -1){
                    var lineatura_array = theveryoneprofile.LINEATURA_N.split(" - ")
                    document.getElementById("lineatura").value = lineatura_array[1]
                    var thecurrentlinescreen = lineatura_array[1]
                    
                } else {
                document.getElementById("lineatura").value = theveryoneprofile.LINEATURA_N
                    thecurrentlinescreen = theveryoneprofile.LINEATURA_N
                }
                if (theveryoneprofile.FABRICANTEPOLIMERO_N.indexOf(" - ") > -1){
                    var fabricante_array = theveryoneprofile.FABRICANTEPOLIMERO_N.split(" - ")
                    document.getElementById("fabricante_polimero").value = fabricante_array[1]
                } else {
                document.getElementById("fabricante_polimero").value = theveryoneprofile.FABRICANTEPOLIMERO_N
                }
                document.getElementById("espesor_polimero").value = theveryoneprofile.ESPESORPOLIMERO_N
                if (theveryoneprofile.FABRICANTEPOLIMEROBLA.indexOf(' - ') > -1){
                    var blanco_array = theveryoneprofile.FABRICANTEPOLIMEROBLA.split(" - ")
                    document.getElementById("fabricante_polimeroblanco").value = blanco_array[1]
                } else {
                document.getElementById("fabricante_polimeroblanco").value = theveryoneprofile.FABRICANTEPOLIMEROBLA
                }
                if (theveryoneprofile.FABRICANTEPOLIMEROBAR.indexOf(" - ") > -1){
                    var barniz_array = theveryoneprofile.FABRICANTEPOLIMEROBAR.split(" - ") 
                    document.getElementById("fabricante_polimerobarniz").value = barniz_array[1]
                } else {
                document.getElementById("fabricante_polimerobarniz").value = theveryoneprofile.FABRICANTEPOLIMEROBAR
                }
                document.getElementById("lineatura_flexo").value = thecurrentlinescreen
                
              }
              
            }
                
                if (busca_orden[0].corte.medida_corte != undefined){
                   document.getElementById("medida_corte").value = busca_orden[0].corte.medida_corte
                }
                if (busca_orden[0].corte.repeticion_corte != undefined){
                   document.getElementById("repeticion_corte").value = busca_orden[0].corte.repeticion_corte
                }
                if (busca_orden[0].corte.total_corte != undefined){
                   document.getElementById("total_corte").value = busca_orden[0].corte.total_corte
                }
                if (busca_orden[0].corte.deformacionmedida_corte != undefined){
                   document.getElementById("deformacionmedida_corte").value = busca_orden[0].corte.deformacionmedida_corte
                }
                if (busca_orden[0].corte.deformacionfactor_corte != undefined){
                   document.getElementById("deformacionfactor_corte").value = busca_orden[0].corte.deformacionfactor_corte
                }
              
                 if (busca_orden[0].desarollo.medida_desarollo != undefined){
                     
                   document.getElementById("medida_desarollo").value = busca_orden[0].desarollo.medida_desarollo
                }
                
                if (busca_orden[0].desarollo.repeticion_desarollo != undefined){
                   document.getElementById("repeticion_desarollo").value = busca_orden[0].desarollo.repeticion_desarollo
                }
                if (busca_orden[0].desarollo.total_desarollo != undefined){
                   document.getElementById("total_desarollo").value = busca_orden[0].desarollo.total_desarollo
                }
                if (busca_orden[0].desarollo.deformacionmedida_desarollo != undefined){
                   document.getElementById("deformacionmedida_desarollo").value = busca_orden[0].desarollo.deformacionmedida_desarollo
                }
                if (busca_orden[0].desarollo.deformacionfactor_desarollo != undefined){
                   document.getElementById("deformacionfactor_desarollo").value = busca_orden[0].desarollo.deformacionfactor_desarollo
                }
                
                if (busca_orden[0].info_fotocelula.ancho != undefined){
                   document.getElementById("ancho_fotocelula").value = busca_orden[0].info_fotocelula.ancho
                }
                if (busca_orden[0].info_fotocelula.alto != undefined){
                   document.getElementById("alto_fotocelula").value = busca_orden[0].info_fotocelula.alto
                   document.getElementById("fotocelula_seaplica").checked = false
                    document.getElementById("fotocelula_segunplano").disabled = false
                  document.getElementById("mostra_fotocelula1").style.display = "inline-block"
                 document.getElementById("mostra_fotocelula2").style.display = "inline-block"
                  document.getElementById("mostra_fotocelula3").style.display = "inline-block"
                }
                
                if (busca_orden[0].info_pieimprenta.posicion_pie != undefined){
                    if (busca_orden[0].info_pieimprenta.posicion_pie != "" &&  busca_orden[0].info_pieimprenta.posicion_pie != "SIN"){
                     document.getElementById("div_pie_imprenta").style.display = "inline-block"
                     if (busca_orden[0].info_pieimprenta.posicion_pie != undefined){
                     document.getElementById("posicion_pie").value = busca_orden[0].info_pieimprenta.posicion_pie
                     }
                     if (busca_orden[0].info_pieimprenta.texto_pie != undefined){
                     document.getElementById("texto_pie").value = busca_orden[0].info_pieimprenta.texto_pie
                     }
                     
                    }
                }
                  
                 if (busca_orden[0].codigos_barra.length > 0){
                     
                     document.getElementById("numero_codigobarras").value = busca_orden[0].codigos_barra[0].codigo
                     document.getElementById("magnificacion_codigobarras").value = busca_orden[0].codigos_barra[0].magnificacion
                     
                     
                     
                 }
                 
                 if (busca_orden[0].tintas != undefined){
                 var tintas_flexo = []
                 }
                 
                 for (i=0;i<busca_orden[0].tintas.length;i++){
                     var info_tinta = {}
                info_tinta["nombre_tinta"] = busca_orden[0].tintas[i].nombre
                info_tinta["lineatura_flexo"] = busca_orden[0].tintas[i].lineatura
                info_tinta["trama_flexo"] = "undefined"
                info_tinta["angulo_flexo"] = ""
                info_tinta["trama_solidos_flexo"] = ""
                info_tinta["codigo_facturacion"] = ""
                info_tinta["fotocelula"] = false
                info_tinta["linea_refile"] = false
                info_tinta["pie_imprenta"] = false
                info_tinta["codigo_barras"] = false
                info_tinta["hex"] = "#FFFFFF"
                info_tinta["producir"] = busca_orden[0].tintas[i].producir
                info_tinta["armado"] = "undefined"
                if (busca_orden[0].tintas[i].producir == true){
                info_tinta["cantidad_planchas"] = "1"
                 } else {
                info_tinta["cantidad_planchas"] = "0"     
                 }
                info_tinta["herramental"] = ""
                info_tinta["lineatura_2"] =  busca_orden[0].tintas[i].lineatura2
                info_tinta["trama_2"] = "undefined"
                info_tinta["tipo_corte"] = "undefined"
                info_tinta["desplazado"] = false
                info_tinta["corte_especial"] = ""
                info_tinta["desarollo_especial"] = "" 
                info_tinta["secuencia"] = parseInt(busca_orden[0].tintas[i].secuencia)
                     
                 tintas_flexo.push(info_tinta)    
                     
                 console.log(tintas_flexo.length)    
                     
                 }
                 
                tintas_flexo = tintas_flexo.sort((a, b) => {
                  if (a.secuencia < b.secuencia) {
                    return -1;
                  }
                });
                
              
                
            
          preenche_tabela_receita()
                     
        }
            
        }
    
    
    function busca_codigo_anterior(){
        document.getElementById("orden_anterior").value = "undefined"
        if (document.getElementById("codigo_anterior").value  != ""){
            var busca_orden = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["codigo_item","contains text like",document.getElementById("codigo_anterior").value]).results
            if (busca_orden.length > 0){
             document.getElementById("cliente").value = busca_orden[0].cliente
             document.getElementById("facturable_a").value = busca_orden[0].info_facturacion.facturable_a
            document.getElementById("tipo_ordem").value = busca_orden[0].tipo_ordem
            document.getElementById("nombre_producto").value = busca_orden[0].nombre_producto
            document.getElementById("codigo_producto").value = busca_orden[0].codigo_producto
            
            } else {
              busca_orden = api.custom_objects.list_with_options("AR-BOSISIO_calypso",["codigo_item","contains text like",document.getElementById("codigo_anterior").value]).results
              if (busca_orden.length > 0){
             document.getElementById("cliente").value = busca_orden[0].cliente
             document.getElementById("facturable_a").value = busca_orden[0].info_facturacion.facturable_a
            document.getElementById("tipo_ordem").value = busca_orden[0].tipo_ordem
            document.getElementById("nombre_producto").value = busca_orden[0].nombre_producto
            document.getElementById("codigo_producto").value = busca_orden[0].codigo_producto
        
            } else {
                document.getElementById("error_codigo_anterior").innerText = "No fue possible encontrar este código"
                document.getElementById("codigo_anterior").style.borderColor = "red"
                setTimeout(function(){document.getElementById("error_codigo_anterior").innerText= "";
                                       document.getElementById("codigo_anterior").style.borderColor = "#236423" 
                },5000)
            }
            }
            
            
        }
    }
</script>

<script>
    function verifica_campos(){
        
        var info_programacion = {}
        info_programacion["nombre_operador"] = document.getElementById("cliente").value
        info_programacion["fecha_envio"] = new Date(document.getElementById("fecha_envio").value)
        info_programacion["fecha_entrega"] = new Date(document.getElementById("fecha_entrega").value)
        info_programacion["programado_por"] = usuario.fullname
        buscaOT["form_programacion"] = info_programacion
        
        buscaOT["cliente"] = document.getElementById("cliente").value
        buscaOT["tipo_orden"] = document.getElementById("tipo_ordem").value
        if (document.getElementById("liberado_preprensa").value == "Si"){
        buscaOT["liberado_preprensa"] = true
        } else {
         buscaOT["liberado_preprensa"] = false     
        }
       
        buscaOT["tipo_trabajo"] = document.getElementById("tipo_trabajo").value
        buscaOT["orden_anterior"] = document.getElementById("orden_anterior").value
        
        var informacion_trabajo = {}
        informacion_trabajo["nombre_producto"] = document.getElementById("nombre_producto").value
        informacion_trabajo["codigo_producto"] = document.getElementById("codigo_producto").value
        informacion_trabajo["prioridad"] = document.getElementById("prioridad").value
        var info = document.getElementsByClassName("multi-select-button")
        var string_enviarcon = info[0].innerHTML
        informacion_trabajo["enviar_polimeroscon"] = string_enviarcon.split(",")
        var string_producto = info[1].innerHTML
        informacion_trabajo["producto"] = string_producto.split(",")
        informacion_trabajo["enviar_polimeroscon"] = string_enviarcon.split(",")
        var string_requiere = info[2].innerHTML
        informacion_trabajo["requiere"] = string_requiere.split(",")
        buscaOT["informacion_trabajo"] = informacion_trabajo
        
        buscaOT["datos_tecnicos"] = theveryoneprofile
        
        var informacion_arte = {}
        informacion_arte["medida_corte"] = document.getElementById("medida_corte").value
        informacion_arte["repeticion_corte"] = document.getElementById("repeticion_corte").value
        informacion_arte["total_corte"] = document.getElementById("total_corte").value
        informacion_arte["deformacionmedida_corte"] = document.getElementById("deformacionmedida_corte").value
        informacion_arte["deformacionfactor_corte"] = document.getElementById("deformacionfactor_corte").value
        
        informacion_arte["medida_desarollo"] = document.getElementById("medida_desarollo").value
        informacion_arte["repeticion_desarollo"] = document.getElementById("repeticion_desarollo").value
        informacion_arte["total_desarollo"] = document.getElementById("total_desarollo").value
        informacion_arte["deformacionmedida_desarollo"] = document.getElementById("deformacionmedida_desarollo").value
        informacion_arte["deformacionfactor_desarollo"] = document.getElementById("deformacionfactor_desarollo").value
       
        informacion_arte["fotocelula_ubicacion"] = fotocelulas
        informacion_arte["ancho_fotocelula"] = document.getElementById("ancho_fotocelula").value
        informacion_arte["alto_fotocelula"] = document.getElementById("alto_fotocelula").value
        informacion_arte["fotocelula_caladotintas"] = document.getElementById("fotocelula_caladotintas").checked
        informacion_arte["fotocelula_caladobarniz"] = document.getElementById("fotocelula_caladobarniz").checked
        
        informacion_arte["pie_imprenta_si"] = document.getElementById("pie_imprenta_si").checked
        informacion_arte["pie_imprenta_no"] = document.getElementById("pie_imprenta_no").checked
        informacion_arte["ancho_pie"] = document.getElementById("ancho_pie").value
        informacion_arte["alto_pie"] = document.getElementById("alto_pie").value
        informacion_arte["pie_caladotintas"] = document.getElementById("pie_caladotintas").checked
        informacion_arte["posicion_pie"] = document.getElementById("posicion_pie").value
        informacion_arte["texto_pie"] = document.getElementById("texto_pie").value
        
        informacion_arte["ancho_linearefile"] = document.getElementById("ancho_linearefile").value
        informacion_arte["posicion_linearefile"] = document.getElementById("posicion_linearefile").value
        
        
        informacion_arte["numero_codigobarras"] = document.getElementById("numero_codigobarras").value
        informacion_arte["magnificacion_codigobarras"] = document.getElementById("magnificacion_codigobarras").value
        informacion_arte["bwr_codigobarras"] = document.getElementById("bwr_codigobarras").value
        informacion_arte["codigobarras_caladotintas"] = document.getElementById("codigobarras_caladotintas").checked
        informacion_arte["codigobarras_caladobarniz"] = document.getElementById("codigobarras_caladobarniz").checked
        
        informacion_arte["codigo_plano"] = document.getElementById("codigo_plano").value
        
        informacion_arte["textolegal_si"] = document.getElementById("textolegal_si").checked
        informacion_arte["textolegal_no"] = document.getElementById("textolegal_no").checked
        informacion_arte["senasa"] = document.getElementById("senasa").value
        informacion_arte["rne"] = document.getElementById("rne").value
        informacion_arte["rnpa"] = document.getElementById("rnpa").value
        informacion_arte["rin"] = document.getElementById("rin").value
        informacion_arte["pams"] = document.getElementById("pams").value
        
        buscaOT["informacion_arte"] = informacion_arte
        buscaOT["indicaciones"] = indicaciones
        
        if (buscaOT.tipo_orden === "Flexografia"){
            
        buscaOT["tintas"] = tintas_flexo
        }
        
        
        
        //buscaOT["fecha_ingreso"] = new Date()
    ///    buscaOT["ingresado_por"] = usuario
        
        var tiempos_actuales = buscaOT.tiempos_proceso
        if (buscaOT.liberado_preprensa === true){
  
        for (i=0;i<tiempos_actuales.length;i++){
            if (tiempos_actuales[i].etapa == "Programación"){
                tiempos_actuales[i].tiempos[tiempos_actuales[i].tiempos.length-1]["termino"] = new Date()
                tiempos_actuales[i].tiempos[tiempos_actuales[i].tiempos.length-1]["finalizado_por"] = usuario.fullname
            }
        }
        
        
                var tempo_etapa = new Date()
                var proximas_etapas = []
                var o_tempo = {}
                var os_tempos = []
                
                var proxima_etapa = {} 
                proxima_etapa["forms"] = "preprensa.html"
                proxima_etapa["nomes"] = "preprensa"
                proximas_etapas.push(proxima_etapa)
                
                
                var tempo_processo = {}
                var the_time = []
                var os_tempos = {}
                os_tempos["inicio"] = new Date()
                
                tempo_processo["etapa"] = "Preprensa"
                tempo_processo["creado_por"] = usuario.fullname
                tempo_processo["ejecutado_por"] = ""
                the_time.push(os_tempos)
                tempo_processo["tiempos"] = the_time
                tiempos_actuales.push(tempo_processo)
                
                
                
        buscaOT["tiempos_proceso"] = tiempos_actuales
                
        buscaOT["proxima_etapa"] = proximas_etapas
                
                
        
        
       
        
        api.hub.start_from_whitepaper_with_variables("[INGRESO]","entrada",{"datos":buscaOT})
        document.getElementById("msg_ot").innerText = "Tarea Finalizada con êxito!"
        setTimeout(function(){window.open("ordenes_dash.html","_self")},4000)
    } else {
        alert("NO LIBERADO A PREPRENSA")
    }
        
       
        
    }
</script>
<script>
    function calcula_total_corte(){
        
        if (document.getElementById("medida_corte").value != "" && document.getElementById("repeticion_corte").value != ""){
            document.getElementById("total_corte").value = (parseFloat(document.getElementById("medida_corte").value.replace(",","."))*parseInt(document.getElementById("repeticion_corte").value)).toFixed(2)
        }
    }
    
     function calcula_total_desarollo(){
        
        if (document.getElementById("medida_desarollo").value != "" && document.getElementById("repeticion_desarollo").value != ""){
            document.getElementById("total_desarollo").value = (parseFloat(document.getElementById("medida_desarollo").value.replace(",","."))*parseInt(document.getElementById("repeticion_desarollo").value)).toFixed(2)
        }
    }
</script>
<script>
    if (buscaOT.tintas != undefined){
    var tintas_flexo = buscaOT.tintas
    }
    
  //  document.getElementsByClassName("toggle-on")[0].style = ""
</script>

<script>
    // preenche chat 
    
    function preenche_chat(){
    
    var linha = event.srcElement.id
    var linha_array = linha.split("_")
    console.log(linha_array)
    
      document.getElementById("mostra_nome").style.display = "inline-block"
      
      var divrecipiet = "idrecipiente_"+linha_array[1]
      console.log(divrecipiet)
      var therecipient = document.getElementById(divrecipiet).innerText
      console.log(therecipient)
      
      document.getElementById("nome_recipiente").innerText = therecipient
      
      var busca_chat = api.custom_objects.list("DEMO_chatCF",["pedido","equal to",buscaOT.numero_op,"and","usuarios","contains",usuario.fullname,"and","usuarios","contains",therecipient]).results
      if (busca_chat.length > 0){
       var info_chat = ""
      for (i=0;i<busca_chat[0].chats.length;i++){
       
        console.log(busca_chat[0].chats[i].de != usuario.fullname)
        if (busca_chat[0].chats[i].de != usuario.fullname){
        info_chat = info_chat+'<li class="clearfix">'
        info_chat = info_chat+'<div class="message-data text-right">'
        info_chat = info_chat+'<span class="message-data-time">'+dateFormat(new Date(busca_chat[0].chats[i].data_envio),"dd/mm/yyyy - HH:MM")+'hs</span>'
        info_chat = info_chat+'<img src="./Icons/cliente.png">'
        info_chat = info_chat+'</div>'
        info_chat = info_chat+'<div class="message other-message float-right">'+busca_chat[0].chats[i].mensagem+'</div>'
        info_chat = info_chat+'</li>'
        console.log("fiz esse")
        }
        else {
        info_chat = info_chat+'<li class="clearfix">'
        info_chat = info_chat+'<div class="message-data">'
        info_chat = info_chat+'<span class="message-data-time">'+dateFormat(new Date(busca_chat[0].chats[i].data_envio),"dd/mm/yyyy - HH:MM")+'hs</span>'
        info_chat = info_chat+'</div>'
        info_chat = info_chat+'<div class="message my-message">'+busca_chat[0].chats[i].mensagem+'</div>'                                    
        info_chat = info_chat+'</li>' 
        console.log("fiz esse outro")
        }
        
      }
      document.getElementById("mensagens").innerHTML = info_chat
      }
    }  
    
    function send_message(){
        var para_quem = document.getElementById("nome_recipiente").innerText
        var busca_chat = api.custom_objects.list("DEMO_chatCF",["pedido","equal to",buscaOT.numero_op,"and","usuarios.1","equal to",para_quem]).results
        if (busca_chat.length === 0){
            var thecurrentchats = []
        } else {
            thecurrentchats = busca_chat[0].chats
        }
        
       
        console.log(para_quem)
        var chats = []
        var data = {}
        data["data_envio"] = new Date()
        data["mensagem"] = document.getElementById('msg_chat').value
        data["de"] = usuario.fullname
        data["para"] = para_quem
        
        thecurrentchats.push(data)
        
        if (busca_chat.length === 0){
        var usuarios = []
        usuarios.push(usuario.fullname)
        usuarios.push(para_quem)
        } else {
            var usuarios = busca_chat[0].usuarios
        }
       
        var info_base = {}
        info_base["usuarios"] = usuarios
        info_base["chats"] = thecurrentchats
        info_base["pedido"] = buscaOT.numero_op
        
       if (busca_chat.length === 0){
       console.log(info_base) 
        api.custom_objects.create("DEMO_chatCF",info_base)
        } else {
        
            info_base["_id"] = busca_chat[0]._id
        console.log(info_base)
           api.custom_objects.update("DEMO_chatCF",info_base)    
       }
        
        document.getElementById('msg_chat').value = ""
        setTimeout(preenche_chat(),2000)
        
    }
    
    function preenche_chats_existentes(){
          var busca_chat = api.custom_objects.list("DEMO_chatCF",["pedido","equal to",buscaOT.numero_op,"and","usuarios","contains",usuario.fullname]).results
    
    
    $("#newuser_chat").find('option').not(':first').remove();

    
  

   
   var qual_mandei = []
   
    if (busca_chat.length > 0){
        var info_chat = ""
    
      for (i=0;i<busca_chat.length;i++){
                        
         var usuario_atual = busca_chat[i].usuarios
         
         var tira = usuario_atual.splice(usuario_atual.indexOf(usuario.fullname),1)
                            
        qual_mandei.push(usuario_atual[0])                                                                
      
        info_chat = info_chat+'<li id="qualchat_'+i+'" style="cursor:pointer" onclick="preenche_chat()" class="clearfix">'
        info_chat = info_chat+'<img src="./Icons/cliente.png">'
        info_chat = info_chat+'<div class="about">'
        info_chat = info_chat+'<div id="idrecipiente_'+i+'" class="name">'+usuario_atual[0]+'</div>'
        info_chat = info_chat+'</div>'
        info_chat = info_chat+'<div style="display: none" class="status"> <i class="fa fa-circle offline"></i></div>'
        info_chat = info_chat+'</li>'
       
        
      }
      document.getElementById("chats_existentes").innerHTML = info_chat
      }
      
        var all_users = api.users.list_users()
    
        
         var selectChat = document.getElementById("newuser_chat")
  
   var nomes_doselect = []
   
   for (i=0;i<all_users.length;i++){
       nomes_doselect.push(all_users[i].fullname)
       
   }
   
   
   for (i=0;i<qual_mandei.length;i++){
   if (nomes_doselect.indexOf(qual_mandei[i]) > -1){
       var tira = nomes_doselect.splice(i,1)
   }
   
   }
   
   nomes_doselect.sort()
   
   for (i=0;i<nomes_doselect.length;i++){
      var opt = document.createElement('option');
        opt.value = nomes_doselect[i];
        opt.innerHTML = nomes_doselect[i];
        selectChat.appendChild(opt);
   }
          
    }
    
    
    function send_message2(){
        var para_quem = document.getElementById("newuser_chat").value
        var busca_chat = api.custom_objects.list("DEMO_chatCF",["pedido","equal to",buscaOT.numero_op,"and","usuarios","contains",para_quem,"and","usuarios","contains",usuario.fullname]).results
        if (busca_chat.length === 0){
            var thecurrentchats = []
        } else {
            thecurrentchats = busca_chat[0].chats
        }
        
       
        console.log(para_quem)
        var chats = []
        var data = {}
        data["data_envio"] = new Date()
        data["mensagem"] = document.getElementById('new_chat').value
        data["de"] = usuario.fullname
        data["para"] = para_quem
        
        thecurrentchats.push(data)
        
        if (busca_chat.length === 0){
        var usuarios = []
        usuarios.push(usuario.fullname)
        usuarios.push(para_quem)
        } else {
            var usuarios = busca_chat[0].usuarios
        }
       
        var info_base = {}
        info_base["usuarios"] = usuarios
        info_base["chats"] = thecurrentchats
        info_base["pedido"] = buscaOT.numero_op
        
       if (busca_chat.length === 0){
       console.log(info_base) 
        api.custom_objects.create("DEMO_chatCF",info_base)
        } else {
        
            info_base["_id"] = busca_chat[0]._id
        console.log(info_base)
           api.custom_objects.update("DEMO_chatCF",info_base)    
       }
       
       document.getElementById('new_chat').value = ""
        
        setTimeout(preenche_chat2(para_quem),2000)
        
    }
    
      function preenche_chat2(paraquem){
    
    
      document.getElementById("mostra_nome").style.display = "none"
      
      var quantosestou = api.custom_objects.count("DEMO_chatCF",["pedido","equal to",buscaOT.numero_op,"and","usuarios","contains",usuario.fullname]).count+1
      
      var info_chat = document.getElementById("chats_existentes").innerHTML
      
      
        info_chat = info_chat+'<li id="qualchat_'+quantosestou+'" style="cursor:pointer" onclick="preenche_chat()" class="clearfix">'
        info_chat = info_chat+'<img src="./Icons/cliente.png">'
        info_chat = info_chat+'<div class="about">'
        info_chat = info_chat+'<div id="idrecipiente_'+quantosestou+'" class="name">'+paraquem+'</div>'
        info_chat = info_chat+'</div>'
        info_chat = info_chat+'<div style="display: none" class="status"> <i class="fa fa-circle offline"></i></div>'
        info_chat = info_chat+'</li>'
        document.getElementById("chats_existentes").innerHTML = info_chat
      
    }  
  
</script>

<script>
var busca_folders = []
     
     function llena_carpetasproduccion(){
         
         clearTable(document.getElementById("tabela_pastas"))
         clearTable(document.getElementById("tabela_subpastas"))
       
        var pasta_original = "cloudflow://"+buscaOT.arte_producao.path[0]+"/"+buscaOT.arte_producao.path[1]+"/"+encodeURI(buscaOT.arte_producao.path[2])+"/"+encodeURI(buscaOT.arte_producao.path[3])+"/"
       
        
        busca_folders = api.folder.list_with_options(["cloudflow.enclosing_folder","equal to",pasta_original],[],["name","subfolders","cloudflow"]).results
      
         
  	    
  	    
  	    
  	    
         var table = document.getElementById("tabela_pastas")
        var qtasrow = table.rows.length
      
            
            for (i=0;i<busca_folders.length;i++){
            var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
           
           
            
            cell1.innerHTML = '<img id="'+busca_folders[i]._id+'_'+i+'" onclick="abre_pasta()" src="./Icons/folder_off.png" width="40px">'
            cell2.innerHTML = '<div style="font-size:1em; text-align: left;">'+busca_folders[i].name+'</div>'
            
           qtasrow = qtasrow +1
      
      
         
        
        
    }
    
     }  
  	    

  	
  	function abre_pasta(){
  	    
  	    var linha = event.srcElement.id
  	    var numerolin = linha.split("_")
  	    var numero_linarray = parseInt(numerolin[1])
  	    console.log("NUMERO LIN")
  	    console.log(numero_linarray)
  	    var numerolintab = parseInt(numerolin[1])+1
  	    var imagem_or = event.srcElement.src
  	    //console.log(linha)
  	    //console.log(imagem_or)
  	    var is_on = new RegExp(".*_off.*")
  	    if (is_on.test(imagem_or) === true){
  	    document.getElementById(linha).src="./Icons/folder_on.png"
  	    var tabela = document.getElementById("tabela_pastas")
  	    var linhas_tabela = tabela.rows
  	    //console.log("numero da linha é "+numerolintab)
  	    for (i=1;i<linhas_tabela.length;i++){
  	        if (i != numerolintab){
  	        if (linhas_tabela[i].childNodes[0].childNodes[0].src == "http://vpn3.bosisio.com.ar:9090/portal.cgi/PP_FILE_STORE/Sistema/Icons/folder_on.png"){
  	            linhas_tabela[i].childNodes[0].childNodes[0].src = "./Icons/folder_off.png"
  	        }
  	        }
  	    }
  	    var subfolders = []
  	    if (busca_folders[numero_linarray].subfolders != undefined){
  	        
  	        subfolders = busca_folders[numero_linarray].subfolders
  	    }
  	    preenche_subfolders(busca_folders[numero_linarray].cloudflow.folder,numero_linarray)
  	    
  	    } else {
  	 clearTable(document.getElementById("tabela_subpastas"))
  	    document.getElementById(linha).src="./Icons/folder_off.png"
  	    }
  	    
  	}
  	
  	
  	  function preenche_subfolders(folderID,qualsub){
  	     
  	     console.log(qualsub)
  	     console.log(folderID)

  	     clearTable(document.getElementById("tabela_subpastas"))
  	     
  	     
         var table = document.getElementById("tabela_subpastas")
        var qtasrow = table.rows.length
      
           var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            cell1.innerHTML = '<img id="'+folderID+'_'+199+'" onclick="volta_anterior()" src="./Icons/folder_off.png" width="40px">'
            cell2.innerHTML = '<div style="font-size:1em; text-align: left;">..</div>'
            cell3.innerHTML = '<div></div>'
             
             qtasrow = qtasrow +1
           
           
           
            if (busca_folders[qualsub].subfolders != undefined){ 
            var thebuscakeys = Object.keys(busca_folders[qualsub].subfolders)
           
            for (i=0;i<thebuscakeys.length;i++){
            var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
           
           
           
            
            cell1.innerHTML = '<img id="'+thebuscakeys[i]+'" onclick="abre_subpasta()" src="./Icons/folder_off.png" width="40px" style="cursor:pointer">'
            cell2.innerHTML = '<div style="font-size:1em; text-align: left;">'+busca_folders[qualsub].subfolders[thebuscakeys[i]]+'</div>'
            cell3.innerHTML = '<div></div>'
           qtasrow = qtasrow +1
            }
      
      
         
        
        
    }
    
    var busca_files = api.asset.list_with_options(["cloudflow.enclosing_folder","equal to",folderID,"and","total_pagecount","equal to",undefined],[],["file_name","file_extension","metadata","cloudflow.file","modification"]).results
    
    for (i=0;i<busca_files.length;i++){
        var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            
            var icone_file = "./Icons/unknown_file.png"
            if (busca_files[i].file_extension == ".ai"){
                icone_file = "./Icons/ai_file.png"
            }
            if (busca_files[i].file_extension == ".pdf"){
                icone_file = "./Icons/pdf_file.png"
            }
            if (busca_files[i].file_extension == ".psd" || busca_files[i].file_extension == ".tif" || busca_files[i].file_extension == ".jpg"){
                icone_file = "./Icons/psd_file.png"
            }
            
            
             var filelocation = busca_files[i].cloudflow.file
             var filelocation_encoded = encodeURIComponent(filelocation)
            
            
            if (busca_files[i].file_extension == ".ai" || busca_files[i].file_extension == ".pdf" || busca_files[i].file_extension == ".psd" || busca_files[i].file_extension == ".tif"){
            
             var theviewlink = "http://vpn3.bosisio.com.ar:9090/portal.cgi?proofscope&url="+filelocation_encoded+"&topbar=false"
            
              cell1.innerHTML = '<a href="'+theviewlink+'" target="_Blank"><img style="cursor:pointer" src="'+icone_file+'" width="40px"></a>'
                
            
            } else {
              cell1.innerHTML = '<img src="'+icone_file+'" width="40px">'
              
            }
            cell2.innerHTML = '<div style="text-align: left">'+busca_files[i].file_name+'</div>'
           if (busca_files[i].file_extension == ".ai" || busca_files[i].file_extension == ".pdf"){
           if (busca_files[i]._id == buscaOT.arte_producao._id){
            row.style.backgroundColor = "lightgreen"
            cell3.innerHTML = '<div style="text-align: left"><img src="./Icons/prioriza_on.png" width="30px" id="arte_'+busca_files[i]._id+'" onclick="enviar_a_flujo()"></div>'   
               
           } else {
            cell3.innerHTML = '<div style="text-align: left"><img src="./Icons/prioriza_off.png" width="30px" id="arte_'+busca_files[i]._id+'" onclick="enviar_a_flujo()"></div>'   
            
           }
            } else {
            cell3.innerHTML = '<div></div>'
            }
           qtasrow = qtasrow +1
            
        
        
    }
    
    
  	    }
  	    
  	 function abre_subpasta(){
  	  var linha = event.srcElement.id
  	  console.log(linha)
  	  var subpaste = api.folder.list_with_options(["_id","equal to",linha],[],["cloudflow","name","subfolders"]).results[0]  
  	  
  	   clearTable(document.getElementById("tabela_subpastas"))
  	     
  	     
         var table = document.getElementById("tabela_subpastas")
        var qtasrow = table.rows.length
      
  	   var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
            cell1.innerHTML = '<img id="'+subpaste.cloudflow.enclosing_folder+'" onclick="volta_anterior()" src="./Icons/folder_off.png" width="40px" style="cursor:pointer">'
            cell2.innerHTML = '<div style="font-size:1em; text-align: left;">. . . '+subpaste.name+'</div>'
            cell3.innerHTML = '<div></div>'
            cell4.innerHTML = '<div></div>'
             cell5.innerHTML = '<div></div>'
             qtasrow = qtasrow +1
             
        if (subpaste.subfolders != undefined){ 
            var thebuscakeys = Object.keys(subpaste.subfolders)
           
            for (i=0;i<thebuscakeys.length;i++){
            var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
           
           
           
            
            cell1.innerHTML = '<img id="'+thebuscakeys[i]+'" onclick="abre_subpasta()" src="./Icons/folder_off.png" width="40px">'
            cell2.innerHTML = '<div style="font-size:1em; text-align: left;">'+subpaste.subfolders[thebuscakeys[i]]+'</div>'
            cell3.innerHTML = '<div></div>'
            cell4.innerHTML = '<div></div>'
             cell5.innerHTML = '<div></div>'
           qtasrow = qtasrow +1
            }
        }
        
         var busca_files = api.asset.list_with_options(["cloudflow.enclosing_folder","equal to",subpaste.cloudflow.folder,"and","total_pagecount","equal to",undefined],[],["file_name","file_extension","metadata","cloudflow.file","modification"]).results
   
         for (i=0;i<busca_files.length;i++){
        var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
            
            var icone_file = "./Icons/unknown_file.png"
            if (busca_files[i].file_extension == ".ai"){
                icone_file = "./Icons/ai_file.png"
            }
            if (busca_files[i].file_extension == ".pdf"){
                icone_file = "./Icons/pdf_file.png"
            }
            if (busca_files[i].file_extension == ".psd" || busca_files[i].file_extension == ".tif" || busca_files[i].file_extension == ".jpg"){
                icone_file = "./Icons/psd_file.png"
            }
            
            
             var filelocation = busca_files[i].cloudflow.file
             var filelocation_encoded = encodeURIComponent(filelocation)
            
            
            if (busca_files[i].file_extension == ".ai" || busca_files[i].file_extension == ".pdf" || busca_files[i].file_extension == ".psd" || busca_files[i].file_extension == ".tif"){
             var theviewlink = "http://vpn3.bosisio.com.ar:9090/portal.cgi?proofscope&url="+filelocation_encoded+"&topbar=false"
             cell1.innerHTML = '<a href="'+theviewlink+'" target="_Blank"><img style="cursor:pointer" src="'+icone_file+'" width="40px"></a>'
            } else {
              cell1.innerHTML = '<img src="'+icone_file+'" width="40px">'
              
            }
            cell2.innerHTML = '<div style="text-align: left">'+busca_files[i].file_name+'</div>'
          if (busca_files[i].file_extension == ".ai" || busca_files[i].file_extension == ".pdf"){
            cell3.innerHTML = '<div style="text-align: left"><img src="./Icons/prioriza_off.png" width="30px" id="arte_'+busca_files[i]._id+'" onclick="adiciona_arte()"></div>'   
            cell4.innerHTML = '<div style="text-align: left"><img src="./Icons/prioriza_off.png" width="30px" id="planta_'+busca_files[i]._id+'" onclick="adiciona_arte()"></div>'   
            cell5.innerHTML = '<div style="text-align: left"><img src="./Icons/prioriza_off.png" width="30px" id="pedido_'+busca_files[i]._id+'" onclick="adiciona_arte()"></div>' 
            } else {
            cell3.innerHTML = '<div></div>'
            cell4.innerHTML = '<div></div>'  
            cell5.innerHTML = '<div></div>'  
            }
            qtasrow = qtasrow +1
            
        
        
    }
  	     
  	 }
  	
  	
  	function volta_anterior(){
  	   
  	   var linha = event.srcElement.id
  	  
  	  console.log(linha)
  	  var subpaste = api.folder.list_with_options(["cloudflow.folder","equal to",linha],[],["cloudflow","name","subfolders"]).results[0]  
  	   clearTable(document.getElementById("tabela_subpastas"))
  	     
  	     
         var table = document.getElementById("tabela_subpastas")
        var qtasrow = table.rows.length
      
  	   var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
            cell1.innerHTML = '<img id="'+subpaste.cloudflow.enclosing_folder+'" onclick="volta_anterior()" src="./Icons/folder_off.png" width="40px">'
            cell2.innerHTML = '<div style="font-size:1em; text-align: left;">..</div>'
            cell3.innerHTML = '<div></div>'
            cell4.innerHTML = '<div></div>'
             cell5.innerHTML = '<div></div>'
             qtasrow = qtasrow +1
             
        if (subpaste.subfolders != undefined){ 
            var thebuscakeys = Object.keys(subpaste.subfolders)
           
            for (i=0;i<thebuscakeys.length;i++){
            var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
           
           
           
            
            cell1.innerHTML = '<img id="'+thebuscakeys[i]+'" onclick="abre_subpasta()" src="./Icons/folder_off.png" width="40px">'
            cell2.innerHTML = '<div style="font-size:1em; text-align: left;">'+subpaste.subfolders[thebuscakeys[i]]+'</div>'
            cell3.innerHTML = '<div></div>'
            cell4.innerHTML = '<div></div>'
             cell5.innerHTML = '<div></div>'
           qtasrow = qtasrow +1
            }
        }
        
         var busca_files = api.asset.list_with_options(["cloudflow.enclosing_folder","equal to",subpaste.cloudflow.folder,"and","total_pagecount","equal to",undefined],[],["file_name","file_extension","metadata","cloudflow.file","modification"]).results
   
         for (i=0;i<busca_files.length;i++){
        var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
            
            var icone_file = "./Icons/unknown_file.png"
            if (busca_files[i].file_extension == ".ai"){
                icone_file = "./Icons/ai_file.png"
            }
            if (busca_files[i].file_extension == ".pdf"){
                icone_file = "./Icons/pdf_file.png"
            }
            if (busca_files[i].file_extension == ".psd" || busca_files[i].file_extension == ".tif" || busca_files[i].file_extension == ".jpg"){
                icone_file = "./Icons/psd_file.png"
            }
            
            
             var filelocation = busca_files[i].cloudflow.file
             var filelocation_encoded = encodeURIComponent(filelocation)
            
            
            if (busca_files[i].file_extension == ".ai" || busca_files[i].file_extension == ".pdf" || busca_files[i].file_extension == ".psd" || busca_files[i].file_extension == ".tif"){
             var theviewlink = "http://vpn3.bosisio.com.ar:9090/portal.cgi?proofscope&url="+filelocation_encoded+"&topbar=false"
             cell1.innerHTML = '<a href="'+theviewlink+'" target="_Blank"><img style="cursor:pointer" src="'+icone_file+'" width="40px"></a>'
            } else {
              cell1.innerHTML = '<img src="'+icone_file+'" width="40px">'
              
            }
            cell2.innerHTML = '<div style="text-align: left">'+busca_files[i].file_name+'</div>'
            
            if (busca_files[i].file_extension == ".ai" || busca_files[i].file_extension == ".pdf"){
            cell3.innerHTML = '<div style="text-align: left"><img src="./Icons/prioriza_off.png" width="30px" id="arte_'+busca_files[i]._id+'" onclick="adiciona_arte()"></div>'   
            cell4.innerHTML = '<div style="text-align: left"><img src="./Icons/prioriza_off.png" width="30px" id="planta_'+busca_files[i]._id+'" onclick="adiciona_arte()"></div>'   
            cell5.innerHTML = '<div style="text-align: left"><img src="./Icons/prioriza_off.png" width="30px" id="pedido_'+busca_files[i]._id+'" onclick="adiciona_arte()"></div>' 
            } else {
            cell3.innerHTML = '<div></div>'
            cell4.innerHTML = '<div></div>'  
            cell5.innerHTML = '<div></div>'  
            }
            qtasrow = qtasrow +1
            
        
        
    }
  	    
  	}
  	    
  
</script>
<script>
    function adiciona_arte(){
        var linha = event.srcElement.id
        var opcoes = ["arte","planta","pedido"]
        var linha_array = linha.split("_")
        var imagem = event.srcElement.src
      //  console.log(imagem)
        var imagem_array = imagem.split("_")
    //    console.log(imagem_array)
        
         for (i=0;i<opcoes.length;i++){
            if (opcoes[i] == linha_array[0]){
                var tira = opcoes.splice(i,1)
            }
        }
        
        if (arteselec.indexOf(linha_array[1]) === -1 &&
            plantaselec.indexOf(linha_array[1]) === -1 &&
            pedidoselec.indexOf(linha_array[1]) === -1) {
              var jatemessa = false  
            } else {
              var jatemessa = true
            }
       
        console.log("ja tem essa "+jatemessa)
       
        if (imagem_array[3] == "off.png"){
       
        document.getElementById(linha).src = "./Icons/prioriza_on.png"
       
        for (i=0;i<opcoes.length;i++){
            var divoutra = opcoes[i]+"_"+linha_array[1]
            document.getElementById(divoutra).src = "./Icons/prioriza_off.png"
        }
        
       
        if (linha_array[0] === "arte"){
        if (arteselec.length > 0){
            var divapagar = "arte_"+arteselec[0]
            document.getElementById(divapagar).src = "./Icons/prioriza_off.png"
            arteselec = []
             if (plantaselec.indexOf(linha_array[1]) > -1){
                plantaselec = []
            }
            if (pedidoselec.indexOf(linha_array[1]) > -1){
                pedidoselec = []
            }
            
            arteselec.push(linha_array[1])
            }
         else {
            if (pedidoselec.indexOf(linha_array[1]) > -1){
                arteselec = []
            }
            if (plantaselec.indexOf(linha_array[1]) > -1){
                plantaselec = []
            }
                arteselec.push(linha_array[1])
            
        }
        }
        
         if (linha_array[0] === "planta"){
        if (plantaselec.length > 0){
            var divapagar = "planta_"+plantaselec[0]
            document.getElementById(divapagar).src = "./Icons/prioriza_off.png"
            plantaselec = []
            if (arteselec.indexOf(linha_array[1]) > -1){
                arteselec = []
            }
            if (pedidoselec.indexOf(linha_array[1]) > -1){
                pedidoselec = []
            }
            
            plantaselec.push(linha_array[1])
            
            
        } else {
            if (arteselec.indexOf(linha_array[1]) > -1){
                arteselec = []
            }
            if (plantaselec.indexOf(linha_array[1]) > -1){
                pedidoselec = []
            }
            
                plantaselec.push(linha_array[1])
            
        }
        }
        
         if (linha_array[0] === "pedido"){
        if (pedidoselec.length > 0){
            var divapagar = "pedido_"+pedidoselec[0]
            document.getElementById(divapagar).src = "./Icons/prioriza_off.png"
            pedidoselec = []
            if (arteselec.indexOf(linha_array[1]) > -1){
                arteselec = []
            }
            if (plantaselec.indexOf(linha_array[1]) > -1){
                plantaselec = []
            }
            
            pedidoselec.push(linha_array[1])
            
            
        } else {
            if (arteselec.indexOf(linha_array[1]) > -1){
                arteselec = []
            }
            if (plantaselec.indexOf(linha_array[1]) > -1){
                plantaselec = []
            }
                pedidoselec.push(linha_array[1])
            
        }
        }
        
        
            
        } else {
        document.getElementById(linha).src = "./Icons/prioriza_off.png" 
        if (linha_array[0] == "arte"){
            arteselec = []
        }
        if (linha_array[0] == "pedido"){
            pedidoselec = []
        }
        if (linha_array[0] == "planta"){
            plantaselec = []
        }
        }
        
       
        
    
        preenche_selectedfiles()
        
        
    }
    
    var theart_asset = {}
    var theplanta_asset = {}
    var thepedido_asset = {}
    
    function preenche_selectedfiles(){
        if (arteselec.length === 0){
            document.getElementById("div_arte").style.display = "none"
        } else {
            document.getElementById("div_arte").style.display = "inline-block"
            theart_asset = api.asset.list_with_options(["_id","equal to",arteselec[0]],[],["file_name","thumb","file_extension","cloudflow","path","metadata.output_color_space.colorants"]).results[0]
            if (theart_asset.thumb == undefined){
                document.getElementById("preview_arte").src = "./Icons/pdf_file.png"
                
            } else {
                document.getElementById("preview_arte").src = theart_asset.thumb
            }
            document.getElementById("div_filename").innerText = theart_asset.file_name
        }
        
        if (plantaselec.length === 0){
            document.getElementById("div_plano").style.display = "none"
        } else {
            document.getElementById("div_plano").style.display = "inline-block"
            theplanta_asset = api.asset.list_with_options(["_id","equal to",plantaselec[0]],[],["file_name","thumb","file_extension","cloudflow","path","metadata.output_color_space.colorants"]).results[0]
            if (theplanta_asset.thumb == undefined){
                document.getElementById("preview_plano").src = "./Icons/pdf_file.png"
                
            } else {
              document.getElementById("preview_plano").src = theplanta_asset.thumb  
            }
            document.getElementById("div_filename2").innerText = theplanta_asset.file_name
        }
        
        if (pedidoselec.length === 0){
            document.getElementById("div_pedido").style.display = "none"
        } else {
            document.getElementById("div_pedido").style.display = "inline-block"
            thepedido_asset = api.asset.list_with_options(["_id","equal to",pedidoselec[0]],[],["file_name","thumb","file_extension","cloudflow","path","metadata.output_color_space.colorants"]).results[0]
            if (thepedido_asset.thumb == undefined){
                document.getElementById("preview_pedido").src = "./Icons/pdf_file.png"
                
            } else {
              document.getElementById("preview_pedido").src = thepedido_asset.thumb  
            }
            document.getElementById("div_filename3").innerText = thepedido_asset.file_name
        }
    }
</script>

 <script>
      function cambiaimg_sentido(){
          
          var ladoimpreso = document.getElementById("sentido_impresion").value
          
          if (ladoimpreso === "Arriba"){
              document.getElementById("img_sentido").style.transform = "rotate(180deg)"
          }
          if (ladoimpreso === "Abajo"){
              
              document.getElementById("img_sentido").style.transform = "rotate(0deg)"
          }
          if (ladoimpreso === "Izquierda"){
              document.getElementById("img_sentido").style.transform = "rotate(90deg)"
          }
          if (ladoimpreso === "Derecha"){
              document.getElementById("img_sentido").style.transform = "rotate(-90deg)"
          }
      }
  </script>	
  <script>
      function devolver_a_soporte(){
          document.getElementById("mostra_botao_salvar").style.display = "none"
            document.getElementById("mostra_botao_devolver").style.display = "none"
            document.getElementById("div_motivo").style.display = "inline-block"
          
      }
      
      function realizarIndicacion(){
         var linha = event.srcElement.id
         var linha_array = linha.split("_")
         var numero_indicacion = parseInt(linha_array[1])
         console.log("fiz")
         var div_like = "indicacionapoagar_"+numero_indicacion
         var div_unlike = "indicacioneditar_"+numero_indicacion
         var img_like = document.getElementById(div_like).src
         img_like = img_like.split("_")
         img_like = img_like[img_like.length-1]
         var img_unlike = document.getElementById(div_unlike).src
         img_unlike = img_unlike.split("_")
         img_unlike = img_unlike[img_unlike.length-1]
         
         if (linha_array[0] == "indicacionapoagar"){
         if (img_like === "vazio.png"){
          document.getElementById(div_like).src= "./Icons/like_verde.png"
          document.getElementById(div_unlike).src = "./Icons/unlike_vazio.png"
          indicaciones[numero_indicacion]["verificada"] = true
          indicaciones[numero_indicacion]["verificada_por"] = usuario.fullname
          indicaciones[numero_indicacion]["fecha_verificacion"] = new Date()
          indicaciones[numero_indicacion]["status"] = "Realizada"
          
          
          
          
         } else {
             document.getElementById(div_like).src= "./Icons/like_vazio.png"
             indicaciones[numero_indicacion]["verificada"] = false
             delete indicaciones[numero_indicacion]["verificada_por"]
             delete indicaciones[numero_indicacion]["fecha_verificacion"]
             delete indicaciones[numero_indicacion]["status"]
         }
         
         }
            else {
        if (img_unlike === "vazio.png"){
          document.getElementById(div_unlike).src= "./Icons/unlike_vermelho.png"
          document.getElementById(div_like).src = "./Icons/like_vazio.png"
          indicaciones[numero_indicacion]["verificada"] = true
          indicaciones[numero_indicacion]["verificada_por"] = usuario.fullname
          indicaciones[numero_indicacion]["fecha_verificacion"] = new Date()
          indicaciones[numero_indicacion]["status"] = "Rechazada"
         } else {
             document.getElementById(div_unlike).src= "./Icons/unlike_vazio.png"
             indicaciones[numero_indicacion]["verificada"] = false
             delete indicaciones[numero_indicacion]["verificada_por"]
             delete indicaciones[numero_indicacion]["fecha_verificacion"]
             delete indicaciones[numero_indicacion]["status"]
         }  
      }
      
      
      preenche_indicaciones()
          
      }
  </script>
  	

  <script type="text/javascript">
    window.onload = function () { 

        document.getElementsByClassName("toggle-off")[0].style.lineHeight= null; 
        document.getElementsByClassName("toggle-on")[0].style.lineHeight = null
    }
</script>
<script>
        if (buscaOT.devoluciones == undefined){
        var devoluciones = []
        }  else {
        var devoluciones = buscaOT.devoluciones    
        }
        
        
    function retornar(){
        if (document.getElementById("motivo_devolucion").value != ""){
        document.getElementById("msg_ot").style.color = "green"
        document.getElementById("msg_ot").innerText = "OT devuelta con êxito."
        
        buscaOT["informacion_arte"]["fotocelula_ubicacion"] = fotocelulas

        
       var info_devolucion = {}
        info_devolucion["de"] = "Programación"
        info_devolucion["para"] = "Soporte"
        info_devolucion["devolvida_em"] = new Date()
        info_devolucion["devolvida_por"] = usuario.fullname
        devoluciones.push(info_devolucion)
       
       
       buscaOT["devoluciones"] = devoluciones
       
       
       
        var data = {}
        data["fecha_creacion"] = new Date()
        data["creado_por"] = usuario.fullname
        data["depto"] = "Soporte"
        data["indicacion"] = document.getElementById("motivo_devolucion").value 
        data["verificada"] = false
        indicaciones.push(data)
        
        buscaOT["indicaciones"] = indicaciones
       
        var tiempos_actuales = buscaOT.tiempos_proceso
      
        for (i=0;i<tiempos_actuales.length;i++){
            if (tiempos_actuales[i].etapa == "Programación"){
                tiempos_actuales[i].tiempos[tiempos_actuales[i].tiempos.length-1]["termino"] = new Date()
                tiempos_actuales[i].tiempos[tiempos_actuales[i].tiempos.length-1]["finalizado_por"] = usuario.fullname
            }
            
        }
        
            var tempo_processo = {}
                var the_time = []
                var os_tempos = {}
                os_tempos["inicio"] = new Date()
                
                tempo_processo["etapa"] = "Ingreso"
                tempo_processo["creado_por"] = usuario.fullname
                tempo_processo["ejecutado_por"] = ""
                the_time.push(os_tempos)
                tempo_processo["tiempos"] = the_time
                tiempos_actuales.push(tempo_processo)
            
        
        
                var tempo_etapa = new Date()
                var proximas_etapas = []
                var o_tempo = {}
                var os_tempos = []
                
                var proxima_etapa = {} 
                proxima_etapa["forms"] = "ingreso.html"
                proxima_etapa["nomes"] = "soporte"
                proximas_etapas.push(proxima_etapa)
                
                
               
                
                
                
        buscaOT["tiempos_proceso"] = tiempos_actuales
                
        buscaOT["proxima_etapa"] = proximas_etapas
        
        api.custom_objects.update("AR-BOSISIO_ordenes",buscaOT)
        
        setTimeout(function(){window.open("ordenes_dash.html","_self")},2000)
        
        
        
        } else {
         document.getElementById("msg_ot").style.color = "red"
        document.getElementById("msg_ot").innerText = "Por favor, especificar el motivo de devolución"
          document.getElementById("motivo_devolucion").style.borderColor = "red" 
            
        }
    }
    
    function cancelar_retorno(){
        document.getElementById("mostra_botao_salvar").style.display = "inline-block"
            document.getElementById("mostra_botao_devolver").style.display = "inline-block"
            document.getElementById("div_motivo").style.display = "none"
    }
</script>
    
<script>
    function enviar_fichatecnica(){
        
        if (document.getElementById("ficha_tecnica").value != "undefined"){
             document.getElementById("msg_flujoficha").style.color = 'green' 
             document.getElementById("msg_flujoficha").innerText = "Flujo iniciado con êxito!!"
             
             if (buscaOT.preprensa === undefined){
                 var flujos_preprensa = []
             } else {
                 var flujos_preprensa = buscaOT.preprensa.flujos
             }
             
             var data = {}
             data["flujo"] = "Ficha Técnica"
             data["enviado_por"] = usuario.fullname
             data["fecha_envio"] = new Date()
             flujos_preprensa.push(data)
             var preprensa = {}
             preprensa["flujos"] = flujos_preprensa
             api.custom_objects.set_keys("AR-BOSISIO_ordenes",ordem,{"preprensa":preprensa})
             
             
            setTimeout(envia_flujoFT(),3000)
            
        } else {
            document.getElementById("msg_flujoficha").style.color = 'red' 
    
            document.getElementById("msg_flujoficha").innerText = "Seleccionar un flujo!!"
               }
        
    }
    
    function envia_flujoFT(){
        
            var cria = api.hub.start_from_whitepaper_with_files_and_variables("FichaTecnica","fichatecnica",[buscaOT.arte_producao.cloudflow.file],{"tipo":document.getElementById("ficha_tecnica").value,"id1":buscaOT.numero_op,"usuario":usuario.username,"operador_preprensa":usuario.fullname})
            
            var jacketname = "FT-"+buscaOT.numero_op+"-"+document.getElementById("ficha_tecnica").value+"-"+usuario.username
        
            var workableConsoleLog = function ()  // a cada 30s roda isso e atualiza a variavel form...
          {
            var buscajacket = api.jacket.list_with_options(["name","equal to",jacketname]).results
         
         if (buscajacket.length  == 0){
            console.log("Esperando upload")
             
         } else {
             
             document.getElementById("msg_flujoficha").innerText = "Aguarde algunos segundos hasta que el servidor complete la tarea!"
         
             if (buscajacket[0].done === true){
             console.log(buscajacket)
         document.getElementById("msg_flujoficha").innerText = "Flujo Terminado! Actualizando los archivos!"
                  myStopFunction();
             } 
              }
        }
	   var workflowTimeout = setInterval(workableConsoleLog, 1000);
        function myStopFunction() {
             document.getElementById("msg_flujoficha").innerText = ""
            
                    clearInterval(workflowTimeout);
                    
                    setTimeout(llena_carpetasproduccion(),3000)
                    }
        
        
    }
</script>
<script>
    // bloqueo de campos
    
     $('input').attr('readonly', true)
     
</script>

    </body>

</html>