<!doctype html>
<html>
    <head>
      <title>Pendencias Artes Gráficas - Biovet</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

      <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">

      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
      <link rel="stylesheet" href="css/style.css">
      <link rel="stylesheet" href="css/table.css">
        <meta name="viewport" content="width=944">
        <meta name="robots" content="noindex, follow">
	<link rel="Shortcut icon" href="http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/assets/img/icons/favicon.ico" type="image/x-icon">
        <link href="http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/assets/img/icons/apple-touch-icon.png" rel="apple-touch-icon" />
        <link href="http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/assets/img/icons/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" />
        <link href="http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/assets/img/icons/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72" />
        <link href="http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/assets/img/icons/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114" />
        <link href="http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/assets/img/icons/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144" />
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/assets/js/vendor/modernizr-2.6.2.min.js"></script>
      	<script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery-1.8.3.min.js'></script>
    	<script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery-ui-1.9.2.custom.js'></script>
    	<script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery.cookie.js'></script>
    <!-- portal.js -->
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery-linedtextarea.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/codemirror.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/javascript.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery.tmpl.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery-regex.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/sitemapstyler.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/date.format.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery.iframe-transport.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery.fileupload.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery.notify.min.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery.event.drag-2.2.js'></script>
        <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi?api=js'></script>
    	<script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/portal/js/nixps-portal-api.js'></script>
        <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/upload/js/upload.js'></script>
        <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/3rdParty/jquery.i18n.js'></script>
        <script type='text/javascript' src='http://127.0.0.1:9090/portal.cgi/PP_FILE_STORE/Customer_Tests/Pavao/upload/js/upload-controller.js'></script>
        <script src="js/popper.js"></script>
        <script src="js/main.js"></script>
     <style>
        .esconder div #detalhe_draft { display:none;}
        .esconder div #triangulo { cursor: pointer;}
     </style>

    </head>


    <body>

  		<div class="wrapper d-flex align-items-stretch">
  			<nav id="sidebar">
  				<div class="p-4 pt-5">
            <img>
  		  	<img src="./logo/Biovet.jpg" style="width: 70%; margin-bottom: 50px;">
  	        <ul class="list-unstyled components mb-5">
              <li>
                  <a href="solicitacaoArtes.html">Nova Solicitação</a>
                </li>
              <li>
                  <a href="minhasSolicitacoes.html">Minhas Solicitações</a>
                </li>
            <li>
  	            <a href="#homeSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle active">Páginas Individuais</a>
  	            <ul class="collapse list-unstyled" id="homeSubmenu">
                  <li>
                      <a href="Solicitacoes_Regulatorios.html">Assuntos Regulatórios</a>
                  </li>
                  <li class="active">
                      <a href="Solicitacoes_Marketing.html">Marketing</a>
                  </li>
                  <li>
                      <a href="Solicitacoes_Garantia.html">Garantia</a>
                  </li>
                   <li>
                      <a href="Solicitacoes_Supply.html">Supply</a>
                  </li>
                  <li>
                      <a href="Solicitacoes_Arte.html">Artes Gráficas</a>
                  </li>
  	        </ul>

  	        <div class="footer">
  	        	<p style="font-size: 6pt; margin-top:380px">Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0.
  						  Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib.com</a>
  						  Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
  	        </div>
  	      </div>
      	</nav>

          <!-- Page Content  -->
        <div id="content" class="p-4 p-md-5">

          <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">

              <button type="button" id="sidebarCollapse" class="btn btn-primary">
                <i class="fa fa-bars"></i>
                <span class="sr-only">Toggle Menu</span>
              </button>
              <button class="btn btn-dark d-inline-block d-lg-none ml-auto" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <i class="fa fa-bars"></i>
              </button>
              <div id="bemvindo" style="margin-left: 20px;"></div>

              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav ml-auto">
                 <li class="nav-item">
                      <a class="nav-link" href="especificacaoTecnica.html">Nova Especificação</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="listaEspecificacoes.html">Lista Especificações</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="adminPage.html">Criar Usuarios</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
          <div>
        <h2 style="display:inline-block;">Aguardando Aprovação</h2><span class="col-md-4" style="margin-left:50px; color: green; display: inline-block;" id="status_aprova"></span><br>
        <div id="titulo_aguardando" class="col-md-11">
            <div  style="display: inline-block; border-bottom: thin solid #000; width: 20%;">Produto</div>
            <div style="display: inline-block; border-bottom: thin solid #000; width: 8%;">SOL/CM</div>
            <div  style="display: inline-block; border-bottom: thin solid #000; width: 20%;">Titulo de Controle</div>
            <div  style="display: inline-block;border-bottom: thin solid #000; width: 9%;">Editar</div>
            <div  style="display: inline-block;border-bottom: thin solid #000; width: 9%;">Aprovar</div>
            <div  style="display: inline-block;border-bottom: thin solid #000;width: 9%;">Detalhes</div>
        </div>
  		<hr>
  		<br>
  		<h2>Aprovadas</h2><br>
        <div id="titulo_aprovadas" class="col-md-11">
            <div style="display: inline-block; border-bottom: thin solid #000; width: 20%;">Produto</div>
            <div style="display: inline-block; border-bottom: thin solid #000; width: 8%;">SOL/CM</div>
            <div style="display: inline-block; border-bottom: thin solid #000; width: 20%">Titulo de Contole</div>
            <div style="display: inline-block; border-bottom: thin solid #000; width: 14%;">Aprovado por</div>
            <div style="display: inline-block; border-bottom: thin solid #000; width: 20%;">Data Aprovação</div>
            <div style="display: inline-block; border-bottom: thin solid #000; width: 9%;">Detalhes</div>
        </div>

        <hr>
  		<br>
  	




      <script>
      var usuario = api.auth.get_current_user()
      var nome_user = "Bem vindo, "+usuario.fullname
      document.getElementById("bemvindo").innerText = nome_user
      </script>
      <script>
      //Preenche lista de Drafts

          var buscatudo = api.custom_objects.list_with_options("BR-BIOVE_artes",["estagio","equal to","marketing"]).results
          for (i=0;i<buscatudo.length;i++){
            if (buscatudo[i].infoSolicitacao.infoAprovacoesSolicita[1][1] == "pendente"){
              var addDIV = '<div class="col-md-11 esconder" style="margin-top: 10px;"><div style="display: inline-block; width: 20%;">'+buscatudo[i].infoProduto.nome+'</div><div id="valor_sol'+i+'" style="display: inline-block; width: 8%;">'+buscatudo[i].sol_cm+'</div><div  style="display: inline-block; width: 20%;">'+buscatudo[i].tituloMudanca+'</div><div  style="display: inline-block; width: 9%;"><a href="editaSolicita_artes.html?data='+buscatudo[i].sol_cm+'" target="_blank"><img onclick="reply_click2()"  src="./assets/img/edit.png" height="25px" style="/* position: relative; */margin-left: auto;margin-right: auto;display: block;"></a></div><div style="display: inline-block; width: 9%; margin-left: 4%;"><img id="imagem_'+i+'" onclick="reply_click()" src="./assets/img/accept.png" height="25px" style="/* position: relative;display: block;" ></div><div id="triangulo" style="width: 0;  height: 0;border-top: 8px solid transparent;border-left: 16px solid #FF0303;border-bottom: 8px solid transparent; display:inline-block;"></div>'
              var addDIV2 = '<div class="col-md-11" id="detalhe_draft" style="display:none;"><div class="col-md-11" style="font-weight: bold; margin-top: 10px;">Motivo da Mudança: <span id="motivo_mudanca" style="font-weight: normal;">'+buscatudo[i].motivoMudanca+'</span></div><div class="col-md-5" style="font-weight: bold; margin-top: 10px; display: inline-block;">Situação atual: <span id="situacao_atual" style="font-weight: normal;">'+buscatudo[i].situacaoAtual+'</span></div><div class="col-md-5" style="font-weight: bold; margin-top: 10px; display: inline-block;">Situação Proposta: <span id="linha" style="font-weight: normal;">'+buscatudo[i].situacaoProposta+'</span></div></div></div>'
        $('#titulo_aguardando').after(addDIV);
        $('#triangulo').after(addDIV2);

          }
        }
          $('.esconder #triangulo').click(function() { $(this).next().toggle();});

      //Preenche lista da Criação
     var buscatudo2 = api.custom_objects.list_with_options("BR-BIOVE_artes",["infoSolicitacao.infoAprovacoesSolicita.1.1","equal to","aprovada"]).results
     for (i=0;i<buscatudo2.length;i++){
        
        if (buscatudo2[i].infoSolicitacao.infoAprovacoesSolicita[0][1] == "aprovada"){ 
        var aprovado_em = new Date(buscatudo2[i].infoSolicitacao.infoAprovacoesSolicita[1][2])
        //console.log(aprovado_em)
        var dia = aprovado_em.toDateString()
        var hora = aprovado_em.toTimeString()
        var hora2 = hora.split(" ")
        var hora3 = hora2[0]
        var ahoraAprova = dia+" - "+hora3 
        var cor_aprova = "green"
        var as_alteracoes = buscatudo2[i].alteracoes
        console.log("As Alteracoes "+as_alteracoes)
          if (as_alteracoes.length > 0){
            cor_aprova = "orange"
          }
        if (as_alteracoes.length === 0){  
        var addDIV3 = '<div class="col-md-11 esconder" style="margin-top: 10px;"><span style="margin-top:5px;margin-right:1%;height:20px;width:20px;background-color:'+cor_aprova+';border-radius:50%;display:inline-block"></span><div style="display: inline-block; width: 20%;">'+buscatudo2[i].infoProduto.nome+'</div><div id="valor_sol2'+i+'" style="display: inline-block; width: 8%;">'+buscatudo2[i].sol_cm+'</div><div style="display: inline-block; width: 20%;">'+buscatudo2[i].tituloMudanca+'</div><div  style="display: inline-block; width: 14%;">'+buscatudo2[i].infoSolicitacao.user_aprovacao_arte+'</div><div style="display: inline-block; width: 20%; margin-right: 1%;">'+ahoraAprova+'</div><div id="triangulo3" style="width: 0;  height: 0;border-top: 5px solid transparent;border-left: 10px solid #FF0303;border-bottom: 5px solid transparent; display:inline-block; margin-left: 3%;"></div>'
        }
        
        if (as_alteracoes.length > 0){
        for (k=0;k<as_alteracoes.length;k++){
          
          var cada_altera = as_alteracoes[k]
          console.log("Quantidade de Alterações "+as_alteracoes.length)
          for (j=0;j<cada_altera.length;j++){
            console.log("Cada Alteração "+cada_altera[j].de)
            var data_revisao = new Date (cada_altera[j].data)
            var dia = data_revisao.toDateString()
            var hora = data_revisao.toTimeString()
            var hora2 = hora.split(" ")
            var hora3 = hora2[0]
            var hora_revisao = dia+" - "+hora3
            var addDIV3 = '<div class="col-md-11 esconder" style="margin-top: 10px;"><span style="margin-top:5px;margin-right:1%;height:20px;width:20px;background-color:'+cor_aprova+';border-radius:50%;display:inline-block"></span><div style="display: inline-block; width: 20%;">'+buscatudo2[i].infoProduto.nome+'</div><div id="valor_sol2'+i+'" style="display: inline-block; width: 8%;">'+buscatudo2[i].sol_cm+'</div><div style="display: inline-block; width: 20%;">'+buscatudo2[i].tituloMudanca+'</div><div  style="display: inline-block; width: 14%;">'+buscatudo2[i].infoSolicitacao.user_aprovacao_arte+'</div><div style="display: inline-block; width: 20%; margin-right: 1%;">'+ahoraAprova+'</div><div id="triangulo2" style="width: 0;  height: 0;border-top: 5px solid transparent;border-left: 10px solid #FF0303;border-bottom: 5px solid transparent; display:inline-block; margin-left: 3%;"></div>' 
            if (j==0){
              console.log("Estou no J igual a ZERO")
            var addDIV5 = '<div style="display:none;"><div class="col-md-2" style="font-weight: bold; margin-top: 10px; display: inline-block;">Revisao: <span id="revisao" style="font-weight: normal;">'+cada_altera[j].revisao+'</span></div><div class="col-md-4" style="font-weight: bold; margin-top: 10px; display: inline-block;">Data: <span id="situacao_atual" style="font-weight: normal;">'+hora_revisao+'</span></div><div class="col-md-2" style="font-weight: bold; margin-top: 10px; display: inline-block;">Setor: <span id="linha" style="font-weight: normal; display:inline-block;">'+cada_altera[j].setor+'</span></div><div class="col-md-4" style="font-weight: bold; margin-top: 10px; display: inline-block;">Responsável: <span id="linha" style="font-weight: normal; display:inline-block;">'+cada_altera[j].user+'</span></div><div class="col-md-9" style="font-weight: bold; margin-top: 10px; display: inline-block;">Mudança: <span id="linha" style="font-weight: normal; display:inline-block;">'+cada_altera[j].campo+'</span></div><div class="col-md-5" style="font-weight: bold; margin-top: 10px; display: inline-block;">De: <span id="linha" style="font-weight: normal; display:inline-block;">'+cada_altera[j].de+'</span></div><div class="col-md-5" style="font-weight: bold; margin-top: 10px; display: inline-block;">Para: <span id="linha" style="font-weight: normal; display:inline-block;">'+cada_altera[j].para+'</span></div><hr style="border-top: 1px solid red">'
            }
            if (j>0){
            console.log("Estou no J maior a ZERO")
            addDIV5 = addDIV5+'<div style="display:inline-block;"><div class="col-md-2" style="font-weight: bold; margin-top: 10px; display: inline-block;">Revisao: <span id="revisao" style="font-weight: normal;">'+cada_altera[j].revisao+'</span></div><div class="col-md-4" style="font-weight: bold; margin-top: 10px; display: inline-block;">Data: <span id="situacao_atual" style="font-weight: normal;">'+hora_revisao+'</span></div><div class="col-md-2" style="font-weight: bold; margin-top: 10px; display: inline-block;">Setor: <span id="linha" style="font-weight: normal; display:inline-block;">'+cada_altera[j].setor+'</span></div><div class="col-md-4" style="font-weight: bold; margin-top: 10px; display: inline-block;">Responsável: <span id="linha" style="font-weight: normal; display:inline-block;">'+cada_altera[j].user+'</span></div><div class="col-md-9" style="font-weight: bold; margin-top: 10px; display: inline-block;">Mudança: <span id="linha" style="font-weight: normal; display:inline-block;">'+cada_altera[j].campo+'</span></div><div class="col-md-5" style="font-weight: bold; margin-top: 10px; display: inline-block;">De: <span id="linha" style="font-weight: normal; display:inline-block;">'+cada_altera[j].de+'</span></div><div class="col-md-5" style="font-weight: bold; margin-top: 10px; display: inline-block;">Para: <span id="linha" style="font-weight: normal; display:inline-block;">'+cada_altera[j].para+'</span></div><hr style="border-top: 1px solid red">'
            }
            console.log("a div numero "+i+"------"+addDIV5)
          }
          
        }
      }
      
      $('#titulo_aprovadas').after(addDIV3);
      $('#triangulo2').after(addDIV5);
        
       
        
        //$(depoisde).after(addDIV5)
   }
  
         $('.esconder #triangulo2').click(function() { $(this).next().toggle();});
    }
     


      </script>
      <script>
      function reply_click(){
      //alert(event.srcElement.id);
      var linha = event.srcElement.id
      //console.log(linha)
      var linha_2 = linha.split("_")
      var qualSolBuscar = "valor_sol"+linha_2[1]

      var selecionaSol = document.getElementById(qualSolBuscar).innerText

      var buscasol_naBase = api.custom_objects.list_with_options("BR-BIOVE_artes",["sol_cm","equal to",selecionaSol]).results[0]
      var infoSolicita2 = buscasol_naBase.infoSolicitacao
      infoSolicita2["infoAprovacoesSolicita"][1][1] = "aprovada"
      infoSolicita2["infoAprovacoesSolicita"][1][2] = new Date()
      infoSolicita2["user_aprovacao_arte"] = usuario.fullname
      
      api.custom_objects.set_keys("BR-BIOVE_artes",buscasol_naBase._id,{estagio:"garantia",infoSolicitacao:infoSolicita2})

      $('#status_aprova').text('A solicitação '+selecionaSol+' está sendo aprovada')
      setTimeout(() => {  $('#status_aprova').text(); location.reload() }, 5000);
  }
      </script>
      

    </body>

</html>