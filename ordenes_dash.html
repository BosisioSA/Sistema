<!doctype html>
<html>
    <head>
      <title>Prepress Dashboard</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      
      <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">

      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
      <link rel="stylesheet" href="css/style.css">
      <link rel="stylesheet" href="css/table.css">
        <meta name="viewport" content="width=944">
        <meta name="robots" content="noindex, follow">
	<link rel="Shortcut icon" href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/favicon.ico" type="image/x-icon">
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon.png" rel="apple-touch-icon" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144" />
        <link rel="stylesheet" href="fonts/fontawesome-all.min.css">
        <link rel="stylesheet" href="fonts/font-awesome.min.css">
        <link rel="stylesheet" href="fonts/fontawesome5-overrides.min.css">
        <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
          <script src="js/jscolor.js"></script>
    
        <script src="/portal.cgi/PP_FILE_STORE/Sistema/assets/js/vendor/modernizr-2.6.2.min.js"></script>
      	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-1.8.3.min.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-ui-1.9.2.custom.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.cookie.js'></script>
    	<script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.4.2/chroma.min.js'></script>
    <!-- portal.js -->
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-linedtextarea.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/codemirror.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/javascript.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.tmpl.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-regex.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/sitemapstyler.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/date.format.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.iframe-transport.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.fileupload.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.notify.min.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.event.drag-2.2.js'></script>
        <script type='text/javascript' src='/portal.cgi?api=js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/portal/js/nixps-portal-api.js'></script>
        <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.i18n.js'></script>
         <script src="js/bootstrap4-toggle.js"></script>
      <script>
           function logout () {
        	$.cookie('user_id','', { expires: -1, path: '/' });
        	$.cookie('user_hash','', { expires: -1, path: '/' });
        	$.cookie('expiration_date','', { expires: -1, path: '/' });
        	$.cookie('customer_id','', { expires: -1, path: '/' });
        	$.cookie('customer_name', '', { expires: -1 , path: '/' });
       		$.cookie('username', '', { expires: -1 , path: '/' });
        	$.cookie('scope', '', { expires: -1 , path: '/' });
        	window.location = 'http://vpn3.bosisio.com.ar:9090/portal.cgi/PP_FILE_STORE/Public/Login/login.html';
    	  }
		

      </script>
       
       
   

    </head>


    <body>

  		<div class="wrapper d-flex align-items-stretch">
  			<nav id="sidebar">
  				<div class="p-4 pt-5">
            <img>
  		  	<img src="./logo//logo_bosisio.png" style="width: 90%; margin-bottom: 50px;">
                 <ul class="active components mb-5">
              <li class="active" style="list-style-type: none">
               <a href="ordenes_dash.html"><img src="./Icons/ticket_dg.png" width="30px" style="margin-right: 5px;">Dashboard OTs</a>
              </li>
             
               <li id="div_nuevaOT" style="list-style-type: none">
               <a href="Nueva_OT.html"><img src="./Icons/entrada_ticket.png" width="30px" style="margin-right: 5px;">Nueva OT</a>
              </li>
             
               <!--    <li  style="list-style-type: none">
               <a href="reuniao_dg_mg4.html"><img src="./Icons/liberado_reuniao.png" width="20px" style="margin-right: 5px;">Reunião DG</a>
              </li> --> 
                    </ul>
                    
                
                 
       <div  class="form-group" style="display:inline-block; width: 16%; margin-left: 1%;">
                 <input type="checkbox" checked data-toggle="toggle" id="que_ots" data-on="Mis OTs" data-off="Todas OTs" onchange="cambia_filtro()" data-onstyle="success" data-offstyle="secondary" data-width="150" data-height="30">
                </div> 
   
  	        <div class="footer">
  	        	<p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0.
  						  Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib.com</a>
  						   Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
  	        </div>
  	      </div>
      	</nav>

          <!-- Page Content  -->
        <div id="content" class="p-4 p-md-5">

          <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">

              <button type="button" id="sidebarCollapse" class="btn btn-primary">
                <i class="fa fa-bars"></i>
                <span class="sr-only">Toggle Menu</span>
              </button>
              <button class="btn btn-dark d-inline-block d-lg-none ml-auto" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <i class="fa fa-bars"></i>
              </button>
              <div id="bemvindo" style="margin-left: 20px;"></div>

              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav ml-auto">
                      <li class="nav-item">
                  <div class="input-icons">
                     <i class="fa fa-search icon"></i>
                    <input id="filtrarTabela" class="input-field form-control" onkeyup="filtro_tabela()"  style="width: 400px;border-top-left-radius: 40px; border-top-right-radius: 40px; border-bottom-left-radius: 40px; border-bottom-right-radius: 40px;display: inline-block" type="text"> 
                    </div>
                    </li>
                 
                  <li class="nav-item">
                      <a class="nav-link" href="cambiar_pwd.html" target="_Blank">Cambiar Contraseña</a>
                  </li>
                  <li class="nav-item">
                      <div class="nav-link" onclick="logout()" style="cursor: pointer;">Logout</div>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
          <div>
     <div  class="form-group" style="display:inline-block; width: 100%">         
     <div class="form-group" style="display:inline-block; width:9%;margin-right: 0.5%">   
        <div class="card">
            <div style="text-align: center; font-size: 0.8em; margin-bottom: 10px;">Global</div>
                <div style="width: 100%; margin: auto; height: 40px;">
                    <img onclick="select_etapa()" src="./Icons/global_on.png" id="img_global" style="height: 100%; margin-left: auto; margin-right: auto; display: flex;">
                </div>
            <div class="container">
                <div style="text-align: center; font-size: 2.5em;"><strong id="strong_global">0</strong></div>
            </div>
        </div>
    </div>
    <div class="form-group" style="display:inline-block; width:9%;margin-right: 0.5%;">   
        <div class="card">
            <div  style="text-align: center; font-size: 0.8em; margin-bottom: 10px;">Soporte</div>
                <div  style="width: 100%; margin: auto;height: 40px;">
                    <img onclick="select_etapa()" id="img_bureau" src="./Icons/jpgpdf_off.png" style="height: 100%; margin-left: auto; margin-right: auto; display: flex; cursor: pointer;">
                </div>
            <div    class="container">
                <div style="text-align: center; font-size: 2.5em;"><strong id="strong_jpgpdf">0</strong></div>
            </div>
        </div>
    </div>
    
    <div class="form-group" style="display:inline-block; width:9%;margin-right: 0.5%">   
        <div class="card">
            <div style="text-align: center; font-size: 0.8em; margin-bottom: 10px;">Gerencia</div>
                <div style="width: 100%; margin: auto;height: 40px;">
                    <img onclick="select_etapa()" src="./Icons/prepress_off.png" id="img_prepress" style="height: 100%; margin-left: auto; margin-right: auto; display: flex;cursor: pointer;">
                </div>
            <div class="container">
                <div style="text-align: center; font-size: 2.5em;"><strong id="strong_prepress">0</strong></div>
            </div>
        </div>
    </div>
    <div class="form-group" style="display:inline-block; width:9%;margin-right: 0.5%">   
        <div class="card">
            <div style="text-align: center; font-size: 0.8em; margin-bottom: 10px;">Programación</div>
                <div style="width: 100%; margin: auto;height: 40px;">
                    <img onclick="select_etapa()" src="./Icons/provaprint_off.png" id="img_provaprint" style="height: 100%; margin-left: auto; margin-right: auto; display: flex;cursor: pointer;">
                </div>
            <div class="container">
                <div style="text-align: center; font-size: 2.5em;"><strong id="strong_provaprint">0</strong></div>
            </div>
        </div>
    </div>
    <div class="form-group" style="display:inline-block; width:9%;margin-right: 0.5%">   
        <div class="card">
            <div style="text-align: center; font-size: 0.8em; margin-bottom: 10px;">Preprensa</div>
                <div style="width: 100%; margin: auto;height: 40px;">
                    <img onclick="select_etapa()" src="./Icons/fotopolimero_off.png" id="img_fotopolimero" style="height: 100%; margin-left: auto; margin-right: auto; display: flex;cursor: pointer;">
                </div>
            <div class="container">
                <div style="text-align: center; font-size: 2.5em;"><strong id="strong_fotopolimero">0</strong></div>
            </div>
        </div>
    </div>
     <div class="form-group" style="display:none; width:9%;margin-right: 0.5%">   
        <div class="card">
            <div style="text-align: center; font-size: 0.8em; margin-bottom: 10px;">Aprobación</div>
                <div style="width: 100%; margin: auto;height: 40px;">
                    <img onclick="select_etapa()" src="./Icons/revisaspec_off.png" id="img_aprovacao" style="height: 100%; margin-left: auto; margin-right: auto; display: flex;cursor: pointer;">
                </div>
            <div class="container">
                <div style="text-align: center; font-size: 2.5em;"><strong id="strong_pregravacao">0</strong></div>
            </div>
        </div>
    </div>
    <div class="form-group" style="display:inline-block; width:9%;margin-right: 0.5%">   
        <div class="card">
            <div style="text-align: center; font-size: 0.8em; margin-bottom: 10px;">Calidad</div>
                <div style="width: 100%; margin: auto;height: 40px;">
                    <img onclick="select_etapa()" src="./Icons/revisaspec_off.png" id="img_galvano" style="height: 100%; margin-left: auto; margin-right: auto; display: flex; cursor: pointer;">
                </div>
            <div class="container">
                <div style="text-align: center; font-size: 2.5em;"><strong id="strong_galvano">0</strong></div>
            </div>
        </div>
    </div>
   
   
     <div class="form-group" style="display:inline-block; width:9%;margin-right: 0.5%">   
        <div class="card">
            <div style="text-align: center; font-size: 0.8em; margin-bottom: 10px;">Aprobaciones</div>
                <div style="width: 100%; margin: auto;height: 40px;">
                    <img onclick="select_etapa()" src="./Icons/pregravacao_off.png" id="img_pregravacao" style="height: 100%; margin-left: auto; margin-right: auto; display: flex;cursor: pointer;">
                </div>
            <div class="container">
                <div style="text-align: center; font-size: 2.5em;"><strong id="strong_aprobacion">0</strong></div>
            </div>
        </div>
    </div>
    
    
     <div class="form-group" style="display:inline-block; width:9%;margin-right: 0.5%">   
        <div class="card">
            <div style="text-align: center; font-size: 0.8em; margin-bottom: 10px;">Polímeros</div>
                <div style="width: 100%; margin: auto;height: 40px;">
                    <img onclick="select_etapa()" src="./Icons/gravacao_off.png" id="img_gravacao" style="height: 100%; margin-left: auto; margin-right: auto; display: flex;cursor: pointer;">
                </div>
            <div class="container">
                <div style="text-align: center; font-size: 2.5em;"><strong id="strong_gravacao">0</strong></div>
            </div>
        </div>
    </div>
     <div class="form-group" style="display:inline-block; width:9%;margin-right: 0.5%">   
        <div class="card">
            <div style="text-align: center; font-size: 0.8em; margin-bottom: 10px;">Cilindros</div>
                <div style="width: 100%; margin: auto;height: 40px;">
                    <img onclick="select_etapa()" src="./Icons/analise_off.png" id="img_analise" style="height: 100%; margin-left: auto; margin-right: auto; display: flex; cursor: pointer;">
                </div>
            <div class="container">
                <div style="text-align: center; font-size: 2.5em;"><strong id="strong_analise">0</strong></div>
            </div>
        </div>
    </div>
     <div class="form-group" style="display:inline-block; width:9%;">   
        <div class="card">
            <div style="text-align: center; font-size: 0.8em; margin-bottom: 10px;">Logística</div>
                <div style="width: 100%; margin: auto;height: 40px;">
                    <img onclick="select_etapa()" src="./Icons/liberacao_off.png" id="img_liberacao" style="height: 100%; margin-left: auto; margin-right: auto; display: flex; cursor: pointer;">
                </div>
            <div class="container">
                <div style="text-align: center; font-size: 2.5em;"><strong id="strong_liberacao">0</strong></div>
            </div>
        </div>
    </div>
  
 
</div>

<!-- SUBFILTROS -->

<div id="mostrafiltros_fotopolimero" style="display:none; width: 100%">
   
    
    <div class="form-group" onclick="select_subetapa()" id="select_analise" style=" display:inline-block; width:13%;margin-right: 1%; cursor:pointer;">   
        <div class="card">
            <div id="filtro_preprensa" style="text-align: center; font-size: 0.8em; margin-bottom: 10px; margin-top: 10px; display:inline-block;">Módulo<strong id="strong_analiseinicial" style="margin-left: 5px; display:inline-block;">0</strong></div>
            
        </div>
    </div>
     <div class="form-group" onclick="select_subetapa()" id="select_meeting" style=" display:inline-block; width:13%;margin-right: 1%; cursor:pointer;">   
        <div class="card">
            <div id="filtro_armado" style="text-align: center; font-size: 0.8em; margin-bottom: 10px; margin-top: 10px; display:inline-block;">Armado<strong id="strong_meeting" style="margin-left: 5px; display:inline-block;">0</strong></div>
            
        </div>
    </div>
     <div class="form-group" onclick="select_subetapa()" id="select_bureau" style=" display:inline-block; width:13%;margin-right: 1%; cursor:pointer;">   
        <div class="card">
            <div id="filtro_rechazo" style="text-align: center; font-size: 0.8em; margin-bottom: 10px; margin-top: 10px; display:inline-block;">Rechazados<strong id="strong_solicitacaoarte" style="margin-left: 5px; display:inline-block;">0</strong></div>
            
        </div>
    </div>
     
    
</div>

<div id="mostrafiltros_bureau" style="display:none; width: 100%">
   
    
    <div class="form-group" onclick="select_subetapa()" id="select_ingreso" style=" display:inline-block; width:13%;margin-right: 1%; cursor:pointer;">   
        <div class="card">
            <div id="filtro_ingreso" style="text-align: center; font-size: 0.8em; margin-bottom: 10px; margin-top: 10px; display:inline-block;">Ingreso<strong id="strong_analiseinicial" style="margin-left: 5px; display:inline-block;">0</strong></div>
            
        </div>
    </div>
     <div class="form-group" onclick="select_subetapa()" id="select_aprobacionok" style=" display:inline-block; width:13%;margin-right: 1%; cursor:pointer;">   
        <div class="card">
            <div id="filtro_aprobados" style="text-align: center; font-size: 0.8em; margin-bottom: 10px; margin-top: 10px; display:inline-block;">Aprobados<strong id="strong_meeting" style="margin-left: 5px; display:inline-block;">0</strong></div>
            
        </div>
    </div>
     <div class="form-group" onclick="select_subetapa()" id="select_rechazadoaprobacion" style=" display:inline-block; width:13%;margin-right: 1%; cursor:pointer;">   
        <div class="card">
            <div id="filtro_rechazados" style="text-align: center; font-size: 0.8em; margin-bottom: 10px; margin-top: 10px; display:inline-block;">Rechazados<strong id="strong_solicitacaoarte" style="margin-left: 5px; display:inline-block;">0</strong></div>
            
        </div>
    </div>
     
    
</div>





<!-- inicio formulario -->
              
        
         
        
        <table id="tabela_prioridades" class="table custom-table" style="display: inline-block">
          <thead>
            <tr>
             
             
              <th class="th-sm" style="width:2%;vertical-align: top;">
              </th>
              <th class="th-sm" style="width:3%;vertical-align: top;">
              </th>
              <th class="th-sm" style="width:8%;vertical-align: top;">N<sup>o</sup> Orden
              </th>
              <th class="th-sm" style="width:17%;vertical-align: top;">Cliente
              </th>
              <th class="th-sm" style="width:30%;vertical-align: top;">Descripción
              </th>
              <th class="th-sm" style="width:15%;vertical-align: top;">Etapa
              </th>
              <th class="th-sm" style="width:10%;vertical-align: top;">Tipo Trabajo
              </th>
              <th class="th-sm" style="width:3%;vertical-align: top;">Imp
              </th>
              <th class="th-sm" style="width:12%;vertical-align: top;">Fecha Ingreso
              </th>
               
              
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
        
        <br>
        
       
        <br>
        <section class="form-group col-md-10" style="display:inline-block;"></section>
        <button id="botao_priorizar" style="display: none;" class="btn btn-primary" onclick="fazer_priorizacao()">Priorizar</button>
        <table id="tabela_aguardando" class="table custom-table" style="display: none">
          <thead>
            <tr>
             
             
              <th class="th-sm" style="width:3%;vertical-align: top;">
              </th>
              <th class="th-sm" style="width:15%;vertical-align: top;">Cliente
              </th>
              <th class="th-sm" style="width:35%;vertical-align: top;">Descrição
              </th>
              <th class="th-sm" style="width:9%;vertical-align: top;">Tipo
              </th>
              <th class="th-sm" style="width:15%;vertical-align: top;">Comercial
              </th>
              <th class="th-sm" style="width:19%;vertical-align: top;">Data Criação
              </th>
              <th class="th-sm" style="width:3%;vertical-align: top;">Priorizar
              </th>
              
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
        
                 
                 
       
            
             
            
            
            <!-- terminar mostra locais e começa mostra registro -->
            
          
          
           
                <br>
               
              
            </div>
        
       </div>
  	
  	 <script src="js/popper.js"></script>
  <script src="js/main.js"></script>	
  	
  	<script>
  	    // funcoes de apoio
  	    
  	    function padWithZero(num, targetLength) {
  return String(num).padStart(targetLength, '0')
}
  	    
  	    var usuario = api.auth.get_current_user()
  	    
  	    document.getElementById("bemvindo").innerText = "Bienvenido, "+usuario.fullname
  	 //   document.getElementById("data_entrega").value = "02:00"
  	    
      function clearTable(table) {
  var rows = table.rows;
  var i = rows.length;
  while (--i) {
    rows[i].parentNode.removeChild(rows[i]);
    // or
    // table.deleteRow(i);
  }
}

function onlyUnique(value, index, self) {
  return self.indexOf(value) === index;
}

function cmyk2rgb(c, m, y, k, normalized){
    c = (c / 100);
    m = (m / 100);
    y = (y / 100);
    k = (k / 100);
    
    c = c * (1 - k) + k;
    m = m * (1 - k) + k;
    y = y * (1 - k) + k;
    
    var r = 1 - c;
    var g = 1 - m;
    var b = 1 - y;
    
    if(!normalized){
        r = Math.round(255 * r);
        g = Math.round(255 * g);
        b = Math.round(255 * b);
    }
    
    return {
        r: r,
        g: g,
        b: b
    }
}

function rgb2cmyk(r, g, b, normalized){
    var c = 1 - (r / 255);
    var m = 1 - (g / 255);
    var y = 1 - (b / 255);
    var k = Math.min(c, Math.min(m, y));
    
    c = (c - k) / (1 - k);
    m = (m - k) / (1 - k);
    y = (y - k) / (1 - k);
    
    if(!normalized){
        c = Math.round(c * 10000) / 100;
        m = Math.round(m * 10000) / 100;
        y = Math.round(y * 10000) / 100;
        k = Math.round(k * 10000) / 100;
    }
    
    c = isNaN(c) ? 0 : c;
    m = isNaN(m) ? 0 : m;
    y = isNaN(y) ? 0 : y;
    k = isNaN(k) ? 0 : k;
    
    return {
        c: c,
        m: m,
        y: y,
        k: k
    }
}


function componentToHex(c) {
  var hex = c.toString(16);
  return hex.length == 1 ? "0" + hex : hex;
}

function rgbToHex(r, g, b) {
  return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
}

// preenche dados se existe ordem

if (usuario.scope_name != undefined){
    var nome_scope = usuario.scope_name[0]
   
}

//if (usuario.active_scope_name == "prepress_sp1"){
  //  document.getElementById("mostra_upload_menu").style.display = "block"
    

//}


// preenche Selects


// selectAnilox = document.getElementById('o_anilox_flexo');
 //   var tiposTipo = api.custom_objects.list_with_options("BR-VALFI_anilox",["situacao","not equal to","BLOQUEADO"]).results
  //  for (var i = 0; i<tiposTipo.length; i++){
//        var opt = document.createElement('option');
 //       opt.value = tiposTipo[i].numero;
  //      opt.innerHTML = tiposTipo[i].numero;
//        selectAnilox.appendChild(opt);
 //   }
    
  
    
   
   
    
   
    
    // preenche Datalist
    
    
           

         



var hoje = new Date()

if (usuario.username != "admin"){
    if (usuario.scope_name[0] != "Soporte" && usuario.scope_name[0] != "Preprensa"){
       document.getElementById("div_nuevaOT").style.display = "none" 
    }
}

  	</script>
  


<script>
    var lista_prioridades = []
    if (usuario.username != "admin"){
    if (usuario.scope_name[0] != "Programación"){
    var busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["proxima_etapa.quien","contains",usuario.fullname],["fecha_ingreso","ascending"],[]).results
    } else {
      var busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",[],["fecha_ingreso","ascending"],[]).results
      
    }
        
    } else {
     var busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",[],["fecha_ingreso","ascending"],[]).results
        
    }
   document.getElementById("strong_global").innerText = busca_global.length
    
  for (i=0;i<busca_global.length;i++){
  
      lista_prioridades.push(busca_global[i])
    }
    
        function calcula_numeros(){    
        // preenche os numeros dos filtros
       
        if (usuario.username != "admin" && usuario.scope_name[0] != "Programación"){
          
        
        if (document.getElementById('que_ots').checked === true){
         document.getElementById("strong_global").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.quien","contains",usuario.fullname]).count   
        } else {
         document.getElementById("strong_global").innerText = api.custom_objects.count("AR-BOSISIO_ordenes").count
        }
        if (document.getElementById('que_ots').checked === true){
         document.getElementById("strong_jpgpdf").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","ingreso","and","proxima_etapa.quien","contains",usuario.fullname]).count
            
        } else {
         document.getElementById("strong_jpgpdf").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","ingreso"]).count
        }
         if (document.getElementById('que_ots').checked === true){ 
         document.getElementById("strong_provaprint").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","programacion","and","proxima_etapa.quien","contains",usuario.scope_name[0]]).count
         } else {
          document.getElementById("strong_provaprint").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","programacion"]).count
             
         }
          if (document.getElementById('que_ots').checked === true){ 
         document.getElementById("strong_fotopolimero").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","preprensa","and","proxima_etapa.quien","contains",usuario.fullname]).count
              
          } else {
         document.getElementById("strong_fotopolimero").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","preprensa"]).count
          }
         if (document.getElementById('que_ots').checked === true){ 
         document.getElementById("strong_prepress").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","gerencia","and","proxima_etapa.quien","contains",usuario.scope_name[0]]).count
         } else {
           document.getElementById("strong_prepress").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","gerencia"]).count
             
         }
          if (document.getElementById('que_ots').checked === true){ 
         document.getElementById("strong_aprobacion").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","aprobacion","and","proxima_etapa.quien","contains",usuario.scope_name[0]]).count
         } else {
           document.getElementById("strong_aprobacion").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","aprobacion"]).count
             
         }
        } else {
           document.getElementById("strong_global").innerText = api.custom_objects.count("AR-BOSISIO_ordenes").count
            document.getElementById("strong_jpgpdf").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","ingreso"]).count
          document.getElementById("strong_provaprint").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","programacion"]).count
         document.getElementById("strong_fotopolimero").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","preprensa"]).count
          document.getElementById("strong_prepress").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","gerencia"]).count
           document.getElementById("strong_aprobacion").innerText = api.custom_objects.count("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","aprobacion"]).count
       
            
        }
        
         
            pinta_devolvidos()
        }
         

        function cambia_filtro(){
           if (usuario.scope_name[0] != "Programación"){ 
            if (document.getElementById("que_ots").checked === true){
                lista_prioridades = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["proxima_etapa.quien","equal to",usuario.fullname,"or",""],["informacion_trabajo.prioridad","ascending"],[]).results
                
            } else {
                lista_prioridades = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",[],["informacion_trabajo.prioridad","ascending"],[]).results
               
            }
           } else {
              lista_prioridades = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",[],["informacion_trabajo.prioridad","ascending"],[]).results
              document.getElementById("que_ots").checked = false 
           }
         
             preenche_tarefas()   
        }

     function preenche_tarefas(){
         console.log(usuario)
        
  	     clearTable(document.getElementById("tabela_prioridades"))
  	     
  	     
         var table = document.getElementById("tabela_prioridades")
        var qtasrow = table.rows.length
      
            
            for (i=0;i<lista_prioridades.length;i++){
                console.log("Estou fazendo o "+i)
            var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            var cell5 = row.insertCell(4);
            var cell6 = row.insertCell(5);
            var cell7 = row.insertCell(6);
            var cell8 = row.insertCell(7);
            var cell9 = row.insertCell(8);
          
           
          var hoje = new Date()
          
             
            var cor_arte = "gray"
            
            if (lista_prioridades[i].informacion_trabajo.prioridad == "01 - CRÍTICA"){
                cor_arte = "red"
            }
            
            var a_data = dateFormat(new Date(lista_prioridades[i].fecha_ingreso),"dd/mm/yyyy HH:MM")
            
            
            
            
            var icone_imp = "./Icons/maq_flexo.png"
            
            if (lista_prioridades[i].tipo_orden == "Huecograbado"){
                icone_imp = "./Icons/maq_roto.png"
            }
            
            
            var etapas = lista_prioridades[i].tiempos_proceso
            
            var nextstage = etapas[etapas.length-1]["etapa"]
           
           var link_dash = lista_prioridades[i].proxima_etapa[0].forms
           
           if (usuario.username != "admin"){
           
           if (lista_prioridades[i].proxima_etapa[0].quien === usuario.fullname || lista_prioridades[i].proxima_etapa[0].quien === usuario.scope_name[0]){
           
            link_dash = lista_prioridades[i].proxima_etapa[0].forms 
           
           
               
           } else {
            link_dash = "visualizaOT.html"     
           }
           }
          
            
            cell1.innerHTML = '<div style="font-size:1em;"><span style="margin-top:5px;height:15px;width:15px;background-color:'+cor_arte+';border-radius:50%;display:inline-block"></span></div>'
            cell2.innerHTML = '<div style="font-size:1em; cursor: pointer"><img id="'+qtasrow+'" onclick="mostraDisclosure()" src="./Icons/showinfo.png" height="25px" id="'+lista_prioridades[i]._id+'"></div>'
            cell3.innerHTML = '<div style="font-size:1em;"><a href="'+link_dash+'?ordem='+lista_prioridades[i]._id+'">'+lista_prioridades[i].numero_op+'</a></div>'
            cell4.innerHTML = '<div style="font-size:1em;">'+lista_prioridades[i].cliente+'</div>'
            cell5.innerHTML = '<div style="font-size:1em;">'+lista_prioridades[i].informacion_trabajo.nombre_producto+'</div>'
            cell6.innerHTML = '<div style="font-size:1em;">'+nextstage+'</div>'
            cell7.innerHTML = '<div style="font-size:1em;">'+lista_prioridades[i].tipo_trabajo+'</div>'
            cell8.innerHTML = '<div style="font-size:1em;"><img src="'+icone_imp+'" width="30px"></div>'
            cell9.innerHTML = '<div style="font-size:1em;">'+a_data+'hs</div>'
            
           qtasrow = qtasrow +1
            
            var thejpg = ""
            if (lista_prioridades[i].arte_producao._id != undefined){
            if (lista_prioridades[i].arte_producao.thumb != undefined){
                thejpg = lista_prioridades[i].arte_producao.thumb
            }
                
            }
            
            
             var table = document.getElementById("tabela_prioridades")
             var qtasrow = table.rows.length
          
          
            var theproofscopeurl = ""
            
          // genera link preview  
           
           if (lista_prioridades[i].arte_producao._id != undefined){
            var cria_proof = api.proofscope.create_view_file_url("",lista_prioridades[i].arte_producao.cloudflow.file)
            if (cria_proof.result == "ok"){
                var theproofscopeurl =  cria_proof.url
            }
            
            // api.custom_objects.set_keys("AR-BOSISIO_ordenes",ordem,{"arte_producao":arte_produccion})
        }
        
       
          
          // busca el thumb si existe
          
            var preview = "./Icons/aguardando_arquivos.png"
            
            if (lista_prioridades[i].pacote_grafico != undefined){
                preview = lista_prioridades[i].pacote_grafico.preview
                link_proofscope = lista_prioridades[i].pacote_grafico.proofscope
            }
      
            var row2 =  table.insertRow(qtasrow);
            var cell1_2 = row2.insertCell(0);
            cell1_2.colSpan = 10
            cell1_2.style = "background-color: lightgray"
            cell1_2.style = "display: none;"
            var string_div = '<div style="width: 100%; display:inline-block; vertical-align: top; padding-top: 5px;">'
            
            // div icono
           
            string_div = string_div+'<div style="width: 20%; display: inline-block; vertical-align: top">'    
            string_div = string_div+'<a href="'+theproofscopeurl+'" target="_Blank" style="cursor: pointer">'
            string_div = string_div+'<img src="'+thejpg+'" width="100%">'
            string_div = string_div+'</a>'
            string_div = string_div+'</div>'
            
            
            string_div = string_div+'<div style="width: 80%; display: inline-block; vertical-align: top">'    
           
            
            
            string_div = string_div+'<div class="form-group" style="display:inline-block; width: 48%; vertical-align: top; margin-right: 1%">'
            string_div = string_div+'<label for="operador_soporte">Operador Soporte</label>'
            string_div = string_div+'<input type="text" class="form-control" id="operador_soporte"   name="operador_soporte" style="text-align: center" value="'+lista_prioridades[i].ingresado_por.fullname+'" readonly>'
            string_div = string_div+'</div>'
            
           // buscausuarioprepress
            var usuarioprepress = ""
            
            for (k=0;k<lista_prioridades[i].tiempos_proceso.length;k++){
                if (lista_prioridades[i].tiempos_proceso[k].etapa == "Preprensa"){
                    var theprepresstime = lista_prioridades[i].tiempos_proceso[k].tiempos
                    for (p=0;p<theprepresstime.length;p++){
                        if (theprepresstime[p].finalizado_por != undefined){
                            usuarioprepress = theprepresstime[p].finalizado_por
                        }
                    }
                }
            }
           
            if (usuarioprepress === "" && lista_prioridades[i].preprensa != undefined){
                var theflows = lista_prioridades[i].preprensa.flujos
                usuarioprepress = theflows[theflows.length-1].enviado_por
            }
           
            string_div = string_div+'<div class="form-group" style="display:inline-block; width: 48%; vertical-align: top;">'
            string_div = string_div+'<label for="operador_preprensa">Operador Preprensa</label>'
            string_div = string_div+'<input type="text" class="form-control" id="operador_preprensa"   name="operador_preprensa" style="text-align: center" value="'+usuarioprepress+'" readonly>'
            string_div = string_div+'</div>'
            
            
            var theinks = ""
            if (lista_prioridades[i].tintas != undefined){
                for (l=0;l<lista_prioridades[i].tintas.length;l++){
                    theinks = theinks+'<span style="margin-right: 10px;height:20px;width:20px;background-color:'+lista_prioridades[i].tintas[l].hex+';border-radius:50%;display:inline-block"></span>'
                }
            }
            
            string_div = string_div+'<div class="form-group" style="display:inline-block; width: 48%; vertical-align: top; margin-right: 1%">'
            string_div = string_div+'<label for="tintas">Tintas</label>'
            string_div = string_div+'<div  class="form-control" id="tintas"   name="tintas" style="text-align: center" readonly>'
            string_div = string_div+theinks
            string_div = string_div+'</div>'
            string_div = string_div+'</div>'
            
           
            
               
                var icono_complejidad = '<span style="display:inline-block; margin-right: 1%">'
                icono_complejidad = icono_complejidad+'<img src="./Icons/tecnicos.png" width="25px"></span>' 
            
            if (lista_prioridades[i].dificultad > 5){
                 icono_complejidad = icono_complejidad+'<span style="display:inline-block; margin-right: 1%">'
                icono_complejidad = icono_complejidad+'<img src="./Icons/tecnicos.png" width="25px"></span>' 
                
            }
            if (lista_prioridades[i].dificultad > 10){
                 icono_complejidad = icono_complejidad+'<span style="display:inline-block; margin-right: 1%">'
                icono_complejidad = icono_complejidad+'<img src="./Icons/tecnicos.png" width="25px"></span>' 
                
            }
            if (lista_prioridades[i].dificultad > 15){
                 icono_complejidad = icono_complejidad+'<span style="display:inline-block; margin-right: 1%">'
                icono_complejidad = icono_complejidad+'<img src="./Icons/tecnicos.png" width="25px"></span>' 
                
            }
            if (lista_prioridades[i].dificultad > 20){
                 icono_complejidad = icono_complejidad+'<span style="display:inline-block; margin-right: 1%">'
                icono_complejidad = icono_complejidad+'<img src="./Icons/tecnicos.png" width="25px"></span>' 
                
            }
            if (lista_prioridades[i].dificultad > 25){
                 icono_complejidad = icono_complejidad+'<span style="display:inline-block; margin-right: 1%">'
                icono_complejidad = icono_complejidad+'<img src="./Icons/tecnicos.png" width="25px"></span>' 
                
            }
            if (lista_prioridades[i].dificultad > 30){
                 icono_complejidad = icono_complejidad+'<span style="display:inline-block; margin-right: 1%">'
                icono_complejidad = icono_complejidad+'<img src="./Icons/tecnicos.png" width="25px"></span>' 
                
            }
            if (lista_prioridades[i].dificultad > 35){
                 icono_complejidad = icono_complejidad+'<span style="display:inline-block; margin-right: 1%">'
                icono_complejidad = icono_complejidad+'<img src="./Icons/tecnicos.png" width="25px"></span>' 
                
            }
            
            
            string_div = string_div+'<div class="form-group" style="display:inline-block; width: 48%; vertical-align: top; margin-right: 1%">'
            string_div = string_div+'<label for="tintas">Complejidad</label>'
            string_div = string_div+'<div  class="form-control" id="tintas"   name="tintas" style="text-align: center" readonly>'
            string_div = string_div+icono_complejidad
            string_div = string_div+'</div>'
            string_div = string_div+'</div>'
           
            
            string_div = string_div+'</div>'
            
            
             string_div = string_div+'</div>'
                cell1_2.innerHTML = string_div
           
        
            qtasrow = qtasrow +1
            
            
         
        
    }
    
  //  document.getElementById("strong_global").innerText = lista_prioridades.length
    calcula_numeros()
        

  	
  	 }
  	 
  	 function pinta_devolvidos(){
  	     
  	       var table = document.getElementById("tabela_prioridades")
      var numero = 1
      
       for (i=0;i<lista_prioridades.length;i++){
  	    console.log(numero)
  	     if (lista_prioridades[i].devoluciones != undefined){
                var ultimadevol = new Date(lista_prioridades[i].devoluciones[lista_prioridades[i].devoluciones.length-1].devolvida_em)
                var ultimoprocesso = new Date(lista_prioridades[i].tiempos_proceso[lista_prioridades[i].tiempos_proceso.length-1].tiempos[0].inicio)
                if (ultimadevol.getTime() == ultimoprocesso.getTime()){
                    console.log("vou fazer o "+numero)
                    table.rows[numero].style.backgroundColor = "#FAFAD2"
                }
                
            }
             numero = numero+2
       }
      
       
  	 }
  	    
  	  function mostraDisclosure(){
  	 console.log(event.srcElement.id)
        var linha = parseInt(event.srcElement.id)+1
        var table = document.getElementById("tabela_prioridades")
  
        if (table.rows[linha].children[0].style.display == "none"){
            table.rows[linha].children[0].style = "background-color: #EEE;"
            table.rows[linha].children[0].colSpan = 10
        } else {
            table.rows[linha].children[0].style = "display: none;" 
        }
      }
      
      function mostraDisclosure2(){
  	 console.log(event.srcElement.id)
        var linha = parseInt(event.srcElement.id)+1
        var table = document.getElementById("tabela_prioridades")
  
        if (table.rows[linha].children[0].style.display == "none"){
            table.rows[linha].children[0].style = "background-color: #AFDBF5;"
            table.rows[linha].children[0].colSpan = 8
        } else {
            table.rows[linha].children[0].style = "display: none;" 
        }
      }
      
      
 // preenche_aguardando()  
    	    
</script>


<script>
// começam funções copiadas da outra pagina 

 function seleciona_referencia(){
  	        if (document.getElementById("inlineRadio6").checked === true){
  	            document.getElementById("mostrar_item_referencia").style = "display: inline-block;"
  	        } else {
  	           document.getElementById("mostrar_item_referencia").style = "display: none;" 
  	        }
  	        
  	    }
  
    	    function seleciona_tipo_trabalho(){
  	        if (document.getElementById("inlineRadio26").checked === true){
  	            document.getElementById("mostrar_amostra").style = "display: none;"
  	            document.getElementById("mostrar_selecionar_amostra").style = "display: none;"
  	            document.getElementById("mostrar_novos_projetos").style = "display: none;"
  	            document.getElementById("mostrar_cobrar_cilindros").style = "display: none;"
  	            document.getElementById("mostrar_prazo_entrega").style = "display: inline-block;"
  	        } else {
  	           document.getElementById("mostrar_amostra").style = "display: none;"
  	            document.getElementById("mostrar_selecionar_amostra").style = "display: inline-block;"
  	            document.getElementById("mostrar_novos_projetos").style = "display: inline-block; vertical-align: top;"
  	            document.getElementById("mostrar_cobrar_cilindros").style = "display: inline-block; vertical-align: top;"
  	            document.getElementById("mostrar_prazo_entrega").style = "display: inline-block;"
  	            document.getElementById("inlineRadio16").checked = true
  	            document.getElementById("inlineRadio5").checked = true
  	             document.getElementById("inlineRadio9").checked = true
  	        }
  	        
  	    }
  	    
  	     function seleciona_amostra(){
  	        if (document.getElementById("inlineRadio15").checked === true){
  	            document.getElementById("mostrar_amostra").style = "display: inline-block;"
  	        } else {
  	           document.getElementById("mostrar_amostra").style = "display: none;" 
  	        }
  	        
  	    }
  	 
  	    function seleciona_produto_semelhante(){
  	        if (document.getElementById("inlineRadio17").checked === true){
  	            document.getElementById("mostrar_produto_semelhante").style = "display: inline-block;"
  	        } else {
  	           document.getElementById("mostrar_produto_semelhante").style = "display: none;" 
  	        }
  	        
  	    }
  	    
  	     function seleciona_unidade_medida(){
  	        if (document.getElementById("inlineRadio29").checked === true){
  	            document.getElementById("mostrar_outra_unidade").style = "display: inline-block;"
  	        } else {
  	           document.getElementById("mostrar_outra_unidade").style = "display: none;" 
  	        }
  	        
  	    }
  	    
  	    	function verifica_campos(){
  	    
  	var conta = api.custom_objects.count("BR-TECNO_Tickets").count
  	
  	
  	
    var valido = true
    
    var data = {}
    
    if (conta === 0){
        var numero_ticket =  padWithZero(conta,5)
        
    } else {
        var busca_ultimo = api.custom_objects.list_with_options("BR-TECNO_Tickets",[],[],["numero_ticket"]).results[conta-1]
        var o_ticket = parseInt(busca_ultimo.numero_ticket)+1
        var numero_ticket =  padWithZero(o_ticket,5)
        
    }
    data["numero_ticket"] = numero_ticket
    
    var amostra = {}
    var campos_amostra = {}
    campos_amostra["inlineRadio15"] = document.getElementById("inlineRadio15").checked
    campos_amostra["inlineRadio16"] = document.getElementById("inlineRadio16").checked
    amostra["campos"] = campos_amostra
    if (campos_amostra["inlineRadio15"] === true){
        amostra["valor"] = document.getElementById("inlineRadio15").value
    } else {
       amostra["valor"] = document.getElementById("inlineRadio16").value
    }
    data["amostra"] = amostra
    
    if (document.getElementById("cliente").value != ""){
        data["cliente"] = document.getElementById("cliente").value 
    } else {
        valido = false
    }
    var tipo_trabalho = {}
    var campos_tipo_trabalho = {}
    campos_tipo_trabalho["inlineRadio23"] =  document.getElementById("inlineRadio23").checked
    campos_tipo_trabalho["inlineRadio24"] =  document.getElementById("inlineRadio24").checked
    campos_tipo_trabalho["inlineRadio25"] =  document.getElementById("inlineRadio25").checked
    campos_tipo_trabalho["inlineRadio26"] =  document.getElementById("inlineRadio26").checked
    tipo_trabalho["campos"] = campos_tipo_trabalho
    if (campos_tipo_trabalho["inlineRadio23"] === true){
    tipo_trabalho["valor"] = document.getElementById("inlineRadio23").value
    }
    if (campos_tipo_trabalho["inlineRadio24"] === true){
    tipo_trabalho["valor"] = document.getElementById("inlineRadio24").value
    }
    if (campos_tipo_trabalho["inlineRadio25"] === true){
    tipo_trabalho["valor"] = document.getElementById("inlineRadio25").value
    }
    if (campos_tipo_trabalho["inlineRadio26"] === true){
    tipo_trabalho["valor"] = document.getElementById("inlineRadio26").value
    }
    data["tipo_trabalho"] = tipo_trabalho
  	
  	var novos_projetos = {}
  	var campos_novos_projetos = {}
  	campos_novos_projetos["inlineRadio4"] =  document.getElementById("inlineRadio4").checked
    campos_novos_projetos["inlineRadio5"] =  document.getElementById("inlineRadio5").checked
  	novos_projetos["campos"] = campos_novos_projetos
  	if (campos_novos_projetos["inlineRadio4"] === true){
    novos_projetos["valor"] = document.getElementById("inlineRadio4").value
    }
    if (campos_novos_projetos["inlineRadio5"] === true){
    novos_projetos["valor"] = document.getElementById("inlineRadio5").value
    }
    data["novos_projetos"] = novos_projetos
  	
  	var usar_referencia = {}
  	var campos_usar_referencia = {}
  	campos_usar_referencia["inlineRadio6"] =  document.getElementById("inlineRadio6").checked
  	campos_usar_referencia["inlineRadio7"] =  document.getElementById("inlineRadio7").checked
  	usar_referencia["campos"] = campos_usar_referencia
  	if (campos_usar_referencia["inlineRadio6"] === true){
    usar_referencia["valor"] = document.getElementById("inlineRadio6").value
    }
    if (campos_usar_referencia["inlineRadio7"] === true){
    usar_referencia["valor"] = document.getElementById("inlineRadio7").value
    }
    data["usar_referencia"] = usar_referencia
    
    data["descricao"] = document.getElementById("descricao").value
    data["que_referencia"] = document.getElementById("item_referencia").value
    data["observacoes"] = document.getElementById("observacoes").value.trim()
    data["entrada_em"] = new Date()
    data["entrega_em"] = new Date(document.getElementById("data_entrega").value)
    
    var cobrar_cilindros = {}
    var campos_cobrar_cilindros = {}
    campos_cobrar_cilindros["inlineRadio8"] =  document.getElementById("inlineRadio8").checked
    campos_cobrar_cilindros["inlineRadio9"] =  document.getElementById("inlineRadio9").checked
    cobrar_cilindros["campos"] = campos_cobrar_cilindros
    if (campos_cobrar_cilindros["inlineRadio8"] === true){
    cobrar_cilindros["valor"] = document.getElementById("inlineRadio8").value
    }
    if (campos_cobrar_cilindros["inlineRadio9"] === true){
    cobrar_cilindros["valor"] = document.getElementById("inlineRadio9").value
    }
    data["cobrar_cilindros"] = cobrar_cilindros
    
    
    var processo = {}
    var campos_processo = {}
    campos_processo["inlineRadio10"] =  document.getElementById("inlineRadio10").checked
    campos_processo["inlineRadio11"] =  document.getElementById("inlineRadio11").checked
    campos_processo["inlineRadio12"] =  document.getElementById("inlineRadio12").checked
    
    processo["campos"] = campos_processo
    if (campos_processo["inlineRadio10"] === true){
    processo["valor"] = document.getElementById("inlineRadio10").value
    }
    if (campos_processo["inlineRadio11"] === true){
    processo["valor"] = document.getElementById("inlineRadio11").value
    }
    if (campos_processo["inlineRadio12"] === true){
    processo["valor"] = document.getElementById("inlineRadio12").value
    }
    
    data["processo"] = processo
    
    data["versao_arte"] = document.getElementById("versao_arte").value
    
     var logo_valgroup= {}
    var campos_logo_valgroup = {}
    campos_logo_valgroup["inlineRadio13"] =  document.getElementById("inlineRadio13").checked
    campos_logo_valgroup["inlineRadio14"] =  document.getElementById("inlineRadio14").checked
    logo_valgroup["campos"] = campos_logo_valgroup
    if (campos_logo_valgroup["inlineRadio13"] === true){
    logo_valgroup["valor"] = document.getElementById("inlineRadio13").value
    }
    if (campos_logo_valgroup["inlineRadio14"] === true){
    logo_valgroup["valor"] = document.getElementById("inlineRadio14").value
    }
    data["logo_valgroup"] = logo_valgroup
    
    var info_amostra = {}
    var contato_amostra = {}
    contato_amostra["contato"] = document.getElementById("contato_cliente").value
    contato_amostra["email"] = document.getElementById("emailcontato_cliente").value
    contato_amostra["telefone"] = document.getElementById("telcontato_cliente").value
    contato_amostra["setor"] = document.getElementById("setorcontato_cliente").value
    info_amostra["contato"] = contato_amostra
    data["amostra_contato"]
    
     var projeto_semelhante= {}
    var campos_projeto_semelhante = {}
    campos_projeto_semelhante["inlineRadio17"] =  document.getElementById("inlineRadio17").checked
    campos_projeto_semelhante["inlineRadio18"] =  document.getElementById("inlineRadio18").checked
    projeto_semelhante["campos"] = campos_projeto_semelhante
    if (campos_projeto_semelhante["inlineRadio17"] === true){
    projeto_semelhante["valor"] = document.getElementById("inlineRadio17").value
    }
    if (campos_projeto_semelhante["inlineRadio18"] === true){
    projeto_semelhante["valor"] = document.getElementById("inlineRadio18").value
    }
    projeto_semelhante["nome_projeto_semelhante"] = document.getElementById("produto_semelhante").value
    info_amostra["projeto_semelhante"] = projeto_semelhante
    
    var info_estrutura = {}
    info_estrutura["atual"] = document.getElementById("estrutura_atual").value
    info_estrutura["solicitada"] = document.getElementById("estrutura_solicitada").value
    data["amostra_estrutura"] = info_estrutura
    
    
     var unidade = {}
    var campos_unidade = {}
    campos_unidade["inlineRadio27"] =  document.getElementById("inlineRadio27").checked
    campos_unidade["inlineRadio28"] =  document.getElementById("inlineRadio28").checked
    campos_unidade["inlineRadio29"] =  document.getElementById("inlineRadio29").checked
    
    unidade["campos"] = campos_unidade
    if (campos_unidade["inlineRadio27"] === true){
    unidade["valor"] = document.getElementById("inlineRadio27").value
    }
    if (campos_unidade["inlineRadio28"] === true){
    unidade["valor"] = document.getElementById("inlineRadio29").value
    }
    if (campos_unidade["inlineRadio29"] === true){
    unidade["valor"] = document.getElementById("inlineRadio29").value
    }
    unidade["outra_unidade"] = document.getElementById("outra_unidade").value
    data["amostra_unidade"] = unidade
    
    var quantidade = {}
    quantidade["solicitada"] = document.getElementById("quantidade_solicitada").value
    quantidade["volume_previsto"] = document.getElementById("volume_previsto").value
    data["amostra_quantidade"] = quantidade
    
    
     var tipo_produto= {}
    var campos_tipo_produto = {}
    campos_tipo_produto["inlineRadio19"] =  document.getElementById("inlineRadio19").checked
    campos_tipo_produto["inlineRadio20"] =  document.getElementById("inlineRadio20").checked
    campos_tipo_produto["inlineRadio21"] =  document.getElementById("inlineRadio21").checked
    campos_tipo_produto["inlineRadio22"] =  document.getElementById("inlineRadio22").checked
    tipo_produto["campos"] = campos_tipo_produto
    if (campos_tipo_produto["inlineRadio19"] === true){
    tipo_produto["valor"] = document.getElementById("inlineRadio19").value
    }
    if (campos_tipo_produto["inlineRadio20"] === true){
    tipo_produto["valor"] = document.getElementById("inlineRadio20").value
    }
    if (campos_tipo_produto["inlineRadio21"] === true){
    tipo_produto["valor"] = document.getElementById("inlineRadio21").value
    }
    if (campos_tipo_produto["inlineRadio22"] === true){
    tipo_produto["valor"] = document.getElementById("inlineRadio22").value
    }
    data["amostra_tipo_produto"] = tipo_produto
    
    
     var tipo_arte= {}
    var campos_tipo_arte = {}
    campos_tipo_arte["inlineRadio30"] =  document.getElementById("inlineRadio30").checked
    campos_tipo_arte["inlineRadio31"] =  document.getElementById("inlineRadio31").checked
    campos_tipo_arte["inlineRadio32"] =  document.getElementById("inlineRadio32").checked
    tipo_arte["campos"] = campos_tipo_arte
    if (campos_tipo_arte["inlineRadio30"] === true){
    tipo_arte["valor"] = document.getElementById("inlineRadio30").value
    }
    if (campos_tipo_arte["inlineRadio31"] === true){
    tipo_arte["valor"] = document.getElementById("inlineRadio31").value
    }
    if (campos_tipo_arte["inlineRadio32"] === true){
    tipo_arte["valor"] = document.getElementById("inlineRadio32").value
    }
    
    info_amostra["tipo_arte"] = tipo_arte
    data["amostra_tipo_arte"] = info_amostra    
    
    var tempo_etapa = new Date()
    
   if (data.amostra.valor == "Sim" && data.amostra_tipo_arte.tipo_arte.valor == "PB"){
       var proximas_etapas = []
       var proxima_etapa = {} 
        proxima_etapa["forms"] = "DES1"
        proxima_etapa["nomes"] = "Análise de Especificação"
        proxima_etapa["inicio"] = tempo_etapa
        var nova_data1 = tempo_etapa.setDate(tempo_etapa.getDate()+1)
        proxima_etapa["final"] = new Date(nova_data1)
        proximas_etapas.push(proxima_etapa)
        
        var tempos_processo = []
        var tempo_processo = {}
        
        tempo_processo["inicio"] = tempo_etapa
        tempo_processo["etapa"] = "Analise de Especificação"
        tempo_processo["formulario"] = "DES1"
        tempo_processo["criado_por"] = usuario.fullname
        tempos_processo.push(tempo_processo)
        data["proxima_etapa"] = proximas_etapas
        data["tempos_processo"] = tempos_processo
  
   } else {
    
    
    if (data.tipo_trabalho.valor == "Novo"){
        var proximas_etapas = []
        
        var proxima_etapa = {}
        proxima_etapa["forms"] = "ART1"
        proxima_etapa["nomes"] = "Análise Inicial"
        proxima_etapa["inicio"] = tempo_etapa
        var nova_data1 = tempo_etapa.setDate(tempo_etapa.getDate()+1)
        proxima_etapa["final"] = new Date(nova_data1)
        proxima_etapa["dashboard"] = "prepress"
        proximas_etapas.push(proxima_etapa)
        var proxima_etapa = {}
        proxima_etapa["forms"] = "DES1"
        proxima_etapa["nomes"] = "Análise de Especificação"
        proxima_etapa["inicio"] = tempo_etapa
        var nova_data1 = tempo_etapa.setDate(tempo_etapa.getDate()+1)
        proxima_etapa["final"] = new Date(nova_data1)
        proxima_etapa["dashboard"] = "desenvolvimento"
        proximas_etapas.push(proxima_etapa)
        
        
        
        data["proxima_etapa"] = proximas_etapas
        
        
        
        var tempos_processo = []
        var tempo_processo = {}
        tempo_processo["inicio"] = tempo_etapa
        tempo_processo["etapa"] = "Analise Inicial"
        tempo_processo["formulario"] = "ART1"
        tempo_processo["criado_por"] = usuario.fullname
        tempos_processo.push(tempo_processo)
        var tempo_processo = {}
        tempo_processo["inicio"] = tempo_etapa
        tempo_processo["etapa"] = "Analise de Especificação"
        tempo_processo["formulario"] = "DES1"
        tempo_processo["criado_por"] = usuario.fullname
        tempos_processo.push(tempo_processo)
        
        data["tempos_processo"] = tempos_processo
        
    }
    if (data.tipo_trabalho.valor == "Alteração"){
       var proximas_etapas = []
       var proxima_etapa = {}
        proxima_etapa["forms"] = "ART1"
        proxima_etapa["nomes"] = "Análise Inicial"
         proxima_etapa["inicio"] = tempo_etapa
         proxima_etapa["dashboard"] = "prepress"
        var nova_data1 = tempo_etapa.setDate(tempo_etapa.getDate()+1)
        proxima_etapa["final"] = new Date(nova_data1)
        proximas_etapas.push(proxima_etapa)
        
        data["proxima_etapa"] = proximas_etapas  
        
        var tempos_processo = []
        var tempo_processo = {}
        
        tempo_processo["inicio"] = tempo_etapa
        tempo_processo["etapa"] = "Analise Inicial"
        tempo_processo["formulario"] = "ART1"
        tempo_processo["criado_por"] = usuario.fullname
        tempos_processo.push(tempo_processo)
        
        data["tempos_processo"] = tempos_processo
        
        
       
    }
        if (data.tipo_trabalho.valor == "Regravação"){
        var proximas_etapas = []
        var proxima_etapa = {}
       proxima_etapa["forms"] = "FORM6"
        proxima_etapa["nomes"] = "Pré Gravação"
         proxima_etapa["inicio"] = tempo_etapa
         proxima_etapa["dashboard"] = "prepress"
        var nova_data1 = tempo_etapa.setDate(tempo_etapa.getDate()+1)
        proxima_etapa["final"] = new Date(nova_data1)
        proximas_etapas.push(proxima_etapa)
        
        data["proxima_etapa"] = proximas_etapas 
        
        var tempos_processo = []
        var tempo_processo = {}
        
        tempo_processo["inicio"] = tempo_etapa
        tempo_processo["etapa"] = "Pré Gravação"
        tempo_processo["formulario"] = "FORM6"
        tempo_processo["criado_por"] = usuario.fullname
        tempos_processo.push(tempo_processo)
        
        data["tempos_processo"] = tempos_processo
        
        
        
    }
    if (data.tipo_trabalho.valor == "Duplicação"){
        
        
         var tempos_processo = []
        var tempo_processo = {}
        
        tempo_processo["inicio"] = tempo_etapa
        tempo_processo["etapa"] = "Preenchimento e Liberação de Especificações"
        tempo_processo["formulario"] = "ART5"
        tempo_processo["criado_por"] = usuario.fullname
        tempos_processo.push(tempo_processo)
        
        data["tempos_processo"] = tempos_processo
    }
   }
    
    console.log(data)
  if (valido === true){
        salva_ticket(data)
  
    }
  	

  	}
  	
  	  function salva_ticket(dados){
          
            
            
            
           var cria_base = api.custom_objects.create("BR-TECNO_Tickets",dados)
           
           
            document.getElementById("info_ticket").innerText = "Ticket criado com sucesso!"
            
           setTimeout(function(){location.reload()}, 3000);
       }
       
      
     
    function select_etapa(){
     var etapas = ["global","bureau","prepress","provaprint","fotopolimero","pregravacao","galvano","gravacao","analise","liberacao"]
      
         var linha = event.srcElement.id
       console.log(linha)
        var linha_array = linha.split("_")
        var div_img = "img_"+linha_array[1]
         var div_mostra = "mostrafiltros_"+linha_array[1]
        var imagem_atual = document.getElementById(div_img).src
        
        if (imagem_atual.indexOf("_off") > -1){
        var nova_imagem = imagem_atual.replace("_off","_on")
        var ehSoporte = new RegExp (".*ingreso.ht.*")
        var ehProgramacion = new RegExp (".*programacion.ht.*")
        var ehPreprensa = new RegExp (".*preprensa.ht.*")
        var ehGerencia = new RegExp (".*gerencia.ht.*")
          
        var tira = etapas.splice(etapas.indexOf(linha_array[1]),1)
        
        
        for (i=0;i<etapas.length;i++){
                var div_outras = "img_"+etapas[i]
                var imagem_atual2 = document.getElementById(div_outras).src
                var nova_imagem2 = imagem_atual2.replace("_on","_off")
                document.getElementById(div_outras).src = nova_imagem2
            
        }
        
     
         var tabela_filtro = document.getElementById("tabela_prioridades")
     
        var therows = tabela_filtro.rows
       
        if (linha_array[1] == "fotopolimero" ){
        document.getElementById(div_mostra).style = "display: inline-block; width: 100%;"
        document.getElementById("mostrafiltros_bureau").style = "display: none; width: 100%;"
     
    } else {
        document.getElementById("mostrafiltros_fotopolimero").style = "display: none; width: 100%;"
     
       }

       if (linha_array[1] == "bureau" ){
        document.getElementById(div_mostra).style = "display: inline-block; width: 100%;"
        document.getElementById("mostrafiltros_fotopolimero").style = "display: none; width: 100%;"
     
    } else {
        document.getElementById("mostrafiltros_bureau").style = "display: none; width: 100%;"
     
       }


        
          if (linha_array[1] == "global"){
             if (usuario.scope_name[0] != "Programación"){ 
             if (document.getElementById("que_ots").checked === true){
             busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["proxima_etapa.quien","equal to",usuario.fullname],["fecha_ingreso","ascending"],[]).results
             } else {
             busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",[],["fecha_ingreso","ascending"],[]).results
             }
             } else {
                busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",[],["fecha_ingreso","ascending"],[]).results
              
             }
          }
     
    //    document.getElementById(div_mostra).style = "display: inline-block; width: 100%;"
  
       
       
      
        if (linha_array[1] === "provaprint"){ 
            
            if (usuario.scope_name[0] != "Programación"){ 
             if (document.getElementById("que_ots").checked === true){
             busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["proxima_etapa.quien","equal to",usuario.fullname,"and","proxima_etapa.forms","contains","programacion"],["fecha_ingreso","ascending"],[]).results
             } else {
             busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","programacion"],["fecha_ingreso","ascending"],[]).results
             }
             } else {
             busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","programacion"],["fecha_ingreso","ascending"],[]).results
                 
             } 
           
        
       }
       
        if (linha_array[1] === "bureau"){ 
            
       if (usuario.scope_name[0] != "Programación"){ 
            
        if (document.getElementById("que_ots").checked === true){
             busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["proxima_etapa.quien","equal to",usuario.fullname,"and","proxima_etapa.forms","contains","ingreso"],["fecha_ingreso","ascending"],[]).results
             } else {
             busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","ingreso"],["fecha_ingreso","ascending"],[]).results
             } 
       } else {
          busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","ingreso"],["fecha_ingreso","ascending"],[]).results
              
       }
        }
       
       if (linha_array[1] === "fotopolimero"){ 
            
        if (usuario.scope_name[0] != "Programación"){ 
           
          if (document.getElementById("que_ots").checked === true){
             busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["proxima_etapa.quien","equal to",usuario.fullname,"and","proxima_etapa.forms","contains","preprensa"],["fecha_ingreso","ascending"],[]).results
             } else {
             busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","preprensa"],["fecha_ingreso","ascending"],[]).results
             
        
       } 
       } else {
             busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","preprensa"],["fecha_ingreso","ascending"],[]).results
           
       }
       }
       
       if (linha_array[1] === "prepress"){ 
            
        if (usuario.scope_name[0] != "Programación"){ 
        
        if (document.getElementById("que_ots").checked === true){
             busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["proxima_etapa.quien","equal to",usuario.fullname,"and","proxima_etapa.forms","contains","gerencia"],["fecha_ingreso","ascending"],[]).results
             } else {
             busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","gerencia"],["fecha_ingreso","ascending"],[]).results
             }
        } else {
              busca_global = api.custom_objects.list_with_options("AR-BOSISIO_ordenes",["proxima_etapa.forms","contains","gerencia"],["fecha_ingreso","ascending"],[]).results
          
        }
        
       }
            
       document.getElementById(div_img).src = nova_imagem
         
        lista_prioridades = busca_global
        
        }
        preenche_tarefas()
          
          
        
         
          
        
        
    }

</script>

<script>
   // document.getElementById("data_abertura").value = dateFormat(new Date(hoje),"yyyy-mm-dd")
    preenche_tarefas()
</script>
<script>
    function select_subetapa(){
         var linha = event.srcElement.id
        console.log(linha)
        var linha_array = linha.split("_")
        var busca_filtro = new RegExp(".*"+linha_array[1]+".ht..*")
        var tabela_filtro = document.getElementById("tabela_prioridades")
        var therows = tabela_filtro.rows
         for (i=1;i<therows.length;i++){
                 therows[i].removeAttribute("style") 
            
            i = i+2
        }
        
       if (linha_array[1] != "todos"){ 
        for (i=1;i<therows.length;i++){
            console.log(i)
            if (busca_filtro.test(therows[i].children[2].children[0].children[0].href) === false){
               therows[i].style.display = "none" 
            }
            i = i+2
        }
       } else {
        var ehArt1 = new RegExp (".*art1.ht.*")
        var ehArt2 = new RegExp (".*art2.ht.*") 
        var ehArt3 = new RegExp (".*art3.ht.*") 
         for (i=1;i<therows.length;i++){
            
               therows[i].removeAttribute("style")
            
            i = i+2
        }
       
        for (i=1;i<therows.length;i++){
            console.log(i)
            if (ehArt1.test(therows[i].children[2].children[0].children[0].href) === false && 
                ehArt2.test(therows[i].children[2].children[0].children[0].href) === false && 
                ehArt3.test(therows[i].children[2].children[0].children[0].href) === false){
               therows[i].style.display = "none" 
            }
            i = i+2
        }
       }
    }
</script>
<script>
  function filtro_tabela() {
   //   clearInterval(inicia)
      var input, filter, table, tr, td, td2,td3,td4,td5, i, txtValue;
      input = document.getElementById("filtrarTabela");
      filter = input.value.toUpperCase();
      table = document.getElementById("tabela_prioridades");
      tr = table.getElementsByTagName("tr");
      for (i = 1; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[2];
        td2 = tr[i].getElementsByTagName("td")[3];
        td3 = tr[i].getElementsByTagName("td")[4];
        td4 = tr[i].getElementsByTagName("td")[5];
        td5 = tr[i].getElementsByTagName("td")[6];
        if (td || td2 || td3 || td4 || td5) {
          txtValue = td.textContent || td.innerText;
          txtValue2 = td2.textContent || td2.innerText;
          txtValue3 = td3.textContent || td3.innerText;
          txtValue4 = td4.textContent || td4.innerText;
          txtValue5 = td5.textContent || td5.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1 
                || txtValue2.toUpperCase().indexOf(filter) > -1
                || txtValue3.toUpperCase().indexOf(filter) > -1
                || txtValue4.toUpperCase().indexOf(filter) > -1
                || txtValue5.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
          } else {
           // var outro_numero = i+1
            //if (tr[outro_numero].style.display == ""){
            //tr[outro_numero].style.display = "none"
                
            //}
            tr[i].style.display = "none";
          //  tr[i+1].style.display = "none"
          }
        }
        i=i+1
      }
    }
</script>



    </body>

</html>