<!doctype html>
<html>
    <head>
      <title>BD - Clientes</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      
      <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">

      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
      <link rel="stylesheet" href="css/style.css">
      <link rel="stylesheet" href="css/table.css">
        <meta name="viewport" content="width=944">
        <meta name="robots" content="noindex, follow">
	<link rel="Shortcut icon" href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/favicon.ico" type="image/x-icon">
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon.png" rel="apple-touch-icon" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-72x72-precomposed.png" rel="apple-touch-icon-precomposed" sizes="72x72" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-114x114-precomposed.png" rel="apple-touch-icon-precomposed" sizes="114x114" />
        <link href="/portal.cgi/PP_FILE_STORE/Sistema/assets/img/icons/apple-touch-icon-144x144-precomposed.png" rel="apple-touch-icon-precomposed" sizes="144x144" />
        <link rel="stylesheet" href="fonts/fontawesome-all.min.css">
        <link rel="stylesheet" href="fonts/font-awesome.min.css">
        <link rel="stylesheet" href="fonts/fontawesome5-overrides.min.css">
        <script src="js/popper.js"></script>
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
          <script src="js/jscolor.js"></script>
          <script src="js/chroma.min.js"></script>
        
  
        
        <script src="/portal.cgi/PP_FILE_STORE/Sistema/assets/js/vendor/modernizr-2.6.2.min.js"></script>
      	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-1.8.3.min.js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-ui-1.9.2.custom.js'></script>
    	
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.cookie.js'></script>
    <!-- portal.js -->
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-linedtextarea.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/codemirror.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/javascript.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.tmpl.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery-regex.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/sitemapstyler.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/date.format.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.iframe-transport.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.fileupload.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.notify.min.js'></script>
    <!-- portal.js --> <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.event.drag-2.2.js'></script>
        <script type='text/javascript' src='/portal.cgi?api=js'></script>
    	<script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/portal/js/nixps-portal-api.js'></script>
        <script type='text/javascript' src='/portal.cgi/PP_FILE_STORE/Sistema/3rdParty/jquery.i18n.js'></script>
        <script type='text/javascript' src='./Charts/Chart.min.js'></script>
        <script type='text/javascript' src='./Charts/utils.js'></script>
       <style>
		#canvas-holder {
			width: 100%;
			margin-top: 50px;
			text-align: center;
		}
		#chartjs-tooltip {
			opacity: 1;
			position: absolute;
			background: rgba(0, 0, 0, .7);
			color: white;
			border-radius: 3px;
			-webkit-transition: all .1s ease;
			transition: all .1s ease;
			pointer-events: none;
			-webkit-transform: translate(-50%, 0);
			transform: translate(-50%, 0);
		}

		.chartjs-tooltip-key {
			display: inline-block;
			width: 10px;
			height: 10px;
			margin-right: 10px;
		}
	</style>

       
    

    </head>


    <body>

  		<div class="wrapper d-flex align-items-stretch">
  			<nav id="sidebar">
  				<div class="p-4 pt-5">
            <img>
  		  		<img src="./logo/logo_bosisio.png" style="width: 90%; margin-bottom: 50px;">
         	   <ul class="active components mb-5">
           
          <li  style="list-style-type: none">
               <a class="active" href="basedatos_clientes.html"><img src="./Icons/clientes.png" width="30px" style="margin-right: 10px">Clientes</a>
              </li>
          <li>
        <!--<a href="#homeSubmenu2" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><img src="./Icons/fornecedores.png" width="30px" style="margin-right: 10px">Fornecedores</a>
           <li class="active" style="list-style-type: none">
               <ul class="collapse list-unstyled" id="homeSubmenu2">
               <li style="list-style-type: none">
               <a href="cadastros_fornecedores_flexo.html"><img src="./Icons/flexo.png" width="20px" style="margin-right: 10px">Flexo</a>
          </li>
          <li  style="list-style-type: none">
               <a href="cadastros_fornecedores_roto.html"><img src="./Icons/roto.png" width="20px" style="margin-right: 10px">Roto</a>
          </li>
          <li  style="list-style-type: none">
               <a href="cadastros_fornecedores_anilox.html"><img src="./Icons/anilox.png" width="20px" style="margin-right: 10px">Anilox</a>
          </li>
          <li  style="list-style-type: none">
               <a href="cadastros_fornecedores_pc.html"><img src="./Icons/porta_cliche.png" width="20px" style="margin-right: 10px">Cilindro Porta Clichê</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_fornecedores_prepress.html"><img src="./Icons/prepress.png" width="20px" style="margin-right: 10px">Prepress</a>
          </li>
          <li style="list-style-type: none">
               <a href="cadastros_fornecedores_materiaprima.html"><img src="./Icons/material.png" width="20px" style="margin-right: 10px">Matéria Prima</a>
          </li>
          </ul>
          -->
          <li >
              <a  href="#homeSubmenu3" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><img src="./Icons/tecnicos.png" width="30px" style="margin-right: 10px">Base de Datos</a>
           <li  style="list-style-type: none">
               <ul class="collapse list-unstyled" id="homeSubmenu3">
              
          <!--<li style="list-style-type: none">
               <a href="cadastros_tecnicos_unidades.html"><img src="./Icons/unidades.png" width="20px" style="margin-right: 10px">Unidades</a>
          </li>-->
         
          <li style="list-style-type: none">
               <a href="basedatos_comercial_listadePrecios.html"><img src="./Icons/segmentos.png" width="20px" style="margin-right: 10px">Lista de Precios</a>
          </li>
          
          </ul>
          
              
            <!--    <li>
              <a href="#homeSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><img src="./Icons/sequencia.png" width="30px" style="margin-right: 10px">Sequência Padrão</a>
              <ul class="collapse list-unstyled" id="homeSubmenu">
              <li class="active" style="list-style-type: none">
               <a href="receita_tintas.html"><img src="./Icons/contagotas.png" width="20px" style="margin-right: 10px">Criar Sequência</a>
              </li>
              <li  style="list-style-type: none">
               <a href="lista_receitas.html"><img src="./Icons/listasequencia.png" width="20px" style="margin-right: 10px">Lista Sequências</a>
              </li>
              <li style="list-style-type: none">
               <a href="cadastros_tintas.html"><img src="./Icons/novasequencia.png" width="20px" style="margin-right: 10px">Lista de Cores</a>
              </li>
              </ul>
          </li>-->
              </ul>
          
   
  	        <div class="footer">
  	        	<p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0.
  						  Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib.com</a>
  						   Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></p>
  	        </div>
  	      </div>
      	</nav>

          <!-- Page Content  -->
        <div id="content" class="p-4 p-md-5">

          <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container-fluid">

              <button type="button" id="sidebarCollapse" class="btn btn-primary">
                <i class="fa fa-bars"></i>
                <span class="sr-only">Toggle Menu</span>
              </button>
              <button class="btn btn-dark d-inline-block d-lg-none ml-auto" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                  <i class="fa fa-bars"></i>
              </button>
              <div id="bemvindo" style="margin-left: 20px;"></div>

              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="nav navbar-nav ml-auto">
              
                  <li class="nav-item">
                      <a class="nav-link" href= "javascript:window.history.go(-1)" style="cursor:pointer;"><img src="./Icons/voltar.png" width="20px" style="margin-right: 5px;">Volver</a>
                  </li>  
                 <li class="nav-item">
                      <a class="nav-link" href="cadastros_clientes.html">Base de Datos</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="solicitacao_desenho.html">Ordenes</a>
                  </li>
                  <li class="nav-item">
                      <a class="nav-link" href="alterar_senha.html" target="_Blank">Cambiar Contraseña</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav>

          <div>
      
        
        <div  class="form-group col-md-11" style="display:inline-block;">
       
            <div id="id_tipotrabajo" style="display:none"></div>
           
        <h4 id="que_estou_fazendo"></h4>
        <div id="nome_tabela" style="display: none"></div>
            
    
       
          
         <h5 id="a_div_portacliche"><i id="tipoTrabajoArrow" class="fas fa-plus-square" onclick="mostraTipotrabajo()" style="margin-right: 5px; cursor:pointer;"></i>Cliente</h5>
                <p><i></i></p>
                
                 <div id="info_tipoTrabajo" class="form-group" style="display: none">
                
               
               <div  class="form-group " style="display:inline-block;  width: 20%;vertical-align: top; margin-right: 1%;">
                <label for="importancia">Importancia</label>
                   <select class="form-control" id="importancia"     name="importancia">
                       <option value="undefined">Seleccionar...</option>
                       <option>A</option>
                       <option>B</option>
                       <option>C</option>
                     </select>
                   <span class="error" id="error_importancia"></span>
                 </div>
               
               
                 <div  class="form-group " style="display:inline-block;  width: 30%;vertical-align: top; margin-right: 1%;">
                <label for="cliente">Nombre Cliente<sup>*</sup></label>
                   <input type="text" class="form-control" id="cliente"  onkeyup="this.value=this.value.toUpperCase()"   name="cliente">
                   <span class="error" id="error_cliente"></span>
                 </div>
                
                
                
                  <div  class="form-group " style="display:inline-block;  width: 20%;vertical-align: top; margin-right: 1%;">
                <label for="cuit">CUIT<sup>*</sup></label>
                   <input type="text" class="form-control" id="cuit"    name="cuit">
                   <span class="error" id="error_cuit"></span>
                 </div>
                 
                 <div  class="form-group " style="display:inline-block;  width: 15%;vertical-align: top; ">
                <label for="status">Status</label>
                   <input type="text" class="form-control" id="status"  onclick="muda_status()"  style="cursor: pointer; background-color: green; color: white; text-align: center;" name="status" value="ACTIVO" readonly>
                   <span class="error" id="error_status"></span>
                 </div>
                  <div  class="form-group " style="display:inline-block;  width: 20%;vertical-align: top;">
                <label for="markup">Markup (%)</label>
                   <input type="text" class="form-control" id="markup"  name="markup" onkeyup="apenas_virgula()" onfocusout="calcula_tablas()"  value="0,0" placeholder="0,0">
                   <span class="error" id="error_markup"></span>
                 </div>
                  
                  <div  class="form-group " style="display:inline-block;  width: 40%;vertical-align: baseline; margin-left: 1%;">
                      <label>Tipo de Cliente</label><br>
                 <div class="form-check form-check-inline">
                  <input class="form-check-input" type="checkbox"  id="Flexografia" value="Flexografia">
                  <label class="form-check-label" for="Flexografia">Flexo</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" style="margin-left: 15px;" type="checkbox"   id="Huecograbado" value="Huecograbado">
                  <label class="form-check-label" for="Huecograbado">Hueco</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" style="margin-left: 15px;" type="checkbox"   id="Brand Owner" value="Brand Owner">
                  <label class="form-check-label" for="Brand Owner">B.O.</label>
                </div>
                 </div>
                 
               <hr>
               <div id="productos" style="width: 100%">
                   <div style="width: 49%; margin-right: 1%; display: inline-block; vertical-align: top">
                    <table id="tabla_1" class="table custom-table"  style="display: inline-block; min-width: 300px;">
                        <thead>
                            <tr>
                                <th class="col" style="width:5%;vertical-align: top;"><input type="checkbox" class="form-group" id="check-tabla_1" onchange="selecciona_todo()">
                                </th>
                                <th class="col" style="width:15%;vertical-align: top;">Código
                                </th>
                                <th class="col" style="width:55%;vertical-align: top;">Descripción
                                </th>
                                <th class="col" style="width:25%;vertical-align: top;">Valor
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
                <div style="width: 49%; display: inline-block; vertical-align: top;">
                    <table id="tabla_2" class="table custom-table"  style="display: inline-block; min-width: 300px;">
                        <thead>
                            <tr>
                                <th class="col" style="width:5%;vertical-align: top;"><input type="checkbox" class="form-group" id="check-tabla_2" onchange="selecciona_todo()">
                                </th>
                                <th class="col" style="width:15%;vertical-align: top;">Código
                                </th>
                                <th class="col" style="width:55%;vertical-align: top;">Descripción
                                </th>
                                <th class="col" style="width:25%;vertical-align: top;">Valor
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
                   
               </div>
                 
               
                  
                 
                
             
             
           
                             
               
                 
                <br>
                 <div  class="form-group col-md-11" style="display:inline-block; margin-top: 10px;">
                  <button class="btn btn-primary" onclick="grabar_trabajo()" style="cursor: pointer">Grabar</button>
                 <button class="btn btn-secondary" onclick="cancelar_trabajo()" style="cursor: pointer">Cancelar</button>
                 </div>
                
                 
             </div>
         
            
            
            
            
           
           
            
            <table id="tabla_tipotrabajo" class="table custom-table"  style="display: inline-block; min-width: 900px;">
          <thead>
            <tr>
             
             <th class="col" style="width:80%; vertical-align: top;">Cliente<br><input class="form-control" id="filtro_cliente" onkeyup="filtro_clientes()"></th>
             
              <th class="col" style="width:10%;vertical-align: top;">Editar</th>
             
              <th class="col" style="width:10%;vertical-align: top;">Borrar</th>
              
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
     
           
        <hr>
      
       
       
        
        
  </div>
        
       
            
             
          
            
            <!-- terminar mostra locais e começa mostra registro -->
            
          
          
           
                <br>
                  <div id="info_update" style="color: green"></div>
              
            </div>
        
       </div>
  	 <script src="js/popper.js"></script>
  <script src="js/main.js"></script>
  		
  		
  	
  	<script>
  	    // funcoes de apoio
  	    
      function clearTable(table) {
  var rows = table.rows;
  var i = rows.length;
  while (--i) {
    rows[i].parentNode.removeChild(rows[i]);
    // or
    // table.deleteRow(i);
  }
}

function onlyUnique(value, index, self) {
  return self.indexOf(value) === index;
}



function cmyk2rgb(c, m, y, k, normalized){
    c = (c / 100);
    m = (m / 100);
    y = (y / 100);
    k = (k / 100);
    
    c = c * (1 - k) + k;
    m = m * (1 - k) + k;
    y = y * (1 - k) + k;
    
    var r = 1 - c;
    var g = 1 - m;
    var b = 1 - y;
    
    if(!normalized){
        r = Math.round(255 * r);
        g = Math.round(255 * g);
        b = Math.round(255 * b);
    }
    
    return {
        r: r,
        g: g,
        b: b
    }
}

function rgb2cmyk(r, g, b, normalized){
    var c = 1 - (r / 255);
    var m = 1 - (g / 255);
    var y = 1 - (b / 255);
    var k = Math.min(c, Math.min(m, y));
    
    c = (c - k) / (1 - k);
    m = (m - k) / (1 - k);
    y = (y - k) / (1 - k);
    
    if(!normalized){
        c = Math.round(c * 10000) / 100;
        m = Math.round(m * 10000) / 100;
        y = Math.round(y * 10000) / 100;
        k = Math.round(k * 10000) / 100;
    }
    
    c = isNaN(c) ? 0 : c;
    m = isNaN(m) ? 0 : m;
    y = isNaN(y) ? 0 : y;
    k = isNaN(k) ? 0 : k;
    
    return {
        c: c,
        m: m,
        y: y,
        k: k
    }
}


   function componentToHex(c) {
  var hex = c.toString(16);
  return hex.length == 1 ? "0" + hex : hex;
}

function rgbToHex(r, g, b) {
  return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
}
          function hexToRgb(hex) {
  var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
  return result ? {
    r: parseInt(result[1], 16),
    g: parseInt(result[2], 16),
    b: parseInt(result[3], 16)
  } : null;
}

var usuario = api.auth.get_current_user()



  	</script>
  	
  	<script>
  	
  // preenche selects
  
 
  
    
    
  
    
    </script>
  	




 
    
    
    <script>
   
    
    </script>

<script>

    
        function mostraTipotrabajo(){
         
        var div_cliente = document.getElementById("info_tipoTrabajo")
        var icone = document.getElementById("tipoTrabajoArrow")
        icone.classList.toggle("fa-minus-square")
        if (div_cliente.style.display === "none") {
            div_cliente.style.display = "inline-block";
            div_cliente.style.width = "100%";
            calcula_tablas()
            } else {
                document.getElementById("id_tipotrabajo").innerText = "";
                document.getElementById("cliente").value="";
                 document.getElementById("cuit").value = "";
                div_cliente.style.display = "none";
            }
     
      }
      
   
      
  </script>
  




<script>
    function grabar_trabajo(){
        var existe_id = document.getElementById("id_tipotrabajo").innerText
        
    
              
              
             
       var data = {}
       data["DENOMINACION"] = document.getElementById("cliente").value
       if (document.getElementById("status").value == "ACTIVO"){
           data["ACTIVESTATUS"] = "Activo"
       }
       if (document.getElementById("status").value == "INACTIVO"){
           data["ACTIVESTATUS"] = "Inactivo"
       }
       data["CUIT"] = document.getElementById("cuit").value
       data["IMPORTANCIA"] = document.getElementById("importancia").value
       data["MARKUP"] = parseFloat(document.getElementById("markup").value.replace(",","."))
       var mercado = {}
       mercado["Flexografia"] = document.getElementById("Flexografia").checked
       mercado["Huecograbado"] = document.getElementById("Huecograbado").checked
       mercado["Brand Owner"] = document.getElementById("Brand Owner").checked
       data["MERCADO"] = mercado
       
       
       data["PRODUCTOS"] = listaprecios
      
        
      if (existe_id == ""){
          var cria_base = api.custom_objects.create("AR-BOSISIO_clientes",data)
          console.log(cria_base)
          api.custom_objects.set_keys("AR-BOSISIO_clientes",cria_base._id,{"ID":cria_base._id})
          data["_id"] = cria_base._id
          os_porta.push(data)
      } else {
          console.log(data)
          data["_id"] = existe_id
          var atualiza = api.custom_objects.update("AR-BOSISIO_clientes",data)
          console.log(atualiza)
          for (i=0;i<os_porta.length;i++){
              if (os_porta[i]._id == existe_id){
                  os_porta[i] = data
              }
          }
      }
        
        
            
        
        
        
        
       
       
       
       setTimeout(function(){document.getElementById("cliente").value="";
                             document.getElementById("cuit").value = "";
                            llena_tipotrabajo();},1000)
                            
        
       
       }
    
    
    let tudo
    tudo = api.custom_objects.list_with_options("AR-BOSISIO_clientes",[],["DENOMINACION","ascending"]).results
    var os_porta = tudo
    
    // preenche select
    
 


 
    
    
    
    
 
  
  //lista_seq.sort(function(a,b){
    //  return parseInt(a) -  parseInt(b); 
  //})
  
  
  
  
 //lista_C.sort(function(a,b){
   //   return parseInt(a.substring(1,a.length)) -  parseInt(b.substring(1,b.length)); 
  //}) 
  
  
  
  
   
    
    
     function llena_tipotrabajo(){
       
       
        clearTable(document.getElementById("tabla_tipotrabajo"))
          
          
         var table = document.getElementById("tabla_tipotrabajo")
        var qtasrow = table.rows.length
      
            
            for (i=0;i<os_porta.length;i++){
            var row =  table.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            
            var color_circulo = "green"
            if (os_porta[i].ACTIVESTATUS === "Inactivo"){
                color_circulo = "red"
            }
              
            cell1.innerHTML = '<div style="font-size: 1em; display: inline-block; text-align: left;"><div style="display:inline-block; margin-left: 3px"><span style="margin-top:5px;height:20px;width:20px;background-color:'+color_circulo+';border-radius:50%;display:inline-block"></span></div><span style="display: inline-block;"></span></div><strong> '+os_porta[i].DENOMINACION+'</strong></div>'
             cell2.innerHTML = '<div><img id="'+tudo[i]._id+'" src="Icons/edit.png" height="20px" onclick="editar_tipoTrabajo()" style="cursor: pointer;"></div>'
            cell3.innerHTML = '<div><img id="'+tudo[i]._id+'" src="Icons/delete.png" height="20px" onclick="borrar_tipoTrabajo()" style="cursor: pointer;"></div>'
          qtasrow = qtasrow +1
      
      cell1.style.textAlign = "left"
     
     
      
    
    }

  
}
 
 

 
    
  
    
    
      
    
     function borrar_tipoTrabajo(){
    if (confirm("Está seguro que quieres borrar este tipo de trabajo?") === true){     
    var linha = event.srcElement.id
    for (i=0;i<os_porta.length;i++){
        if (os_porta[i]._id == linha){
          var tira = os_porta.splice(i,1)  
          api.custom_objects.delete("PantoneColor",linha)
        }
    }
      
     
    
    llena_tipotrabajo() 
    
    
   
      
    }
     }
     
     
       function editar_tipoTrabajo(){
    listaprecios = api.custom_objects.list("AR-BOSISIO_listaPrecios").results
    var linha = event.srcElement.id
    console.log(linha)
    for (i=0;i<os_porta.length;i++){
        
        if (os_porta[i]._id == linha){
            console.log(i)
            console.log(os_porta[i].ACTIVESTATUS)
            document.getElementById("id_tipotrabajo").innerText = linha
            document.getElementById("cliente").value = os_porta[i].DENOMINACION
             document.getElementById("cuit").value = os_porta[i].CUIT
            if (os_porta[i].ACTIVESTATUS == "Activo"){
                console.log("sou ativo")
                document.getElementById("status").value = "ACTIVO"
                document.getElementById("status").style.backgroundColor = "green"
            } else {
                console.log("sou inativo")
                document.getElementById("status").value = "INACTIVO"
                document.getElementById("status").style.backgroundColor = "red"
            }
            if (os_porta[i].IMPORTANCIA != undefined){
                document.getElementById("importancia").value = os_porta[i].IMPORTANCIA
            }
            if (os_porta[i].MARKUP != undefined){
                document.getElementById("markup").value = os_porta[i].MARKUP
            }
            if (os_porta[i].MERCADO != undefined){
            var market_keys = Object.keys(os_porta[i].MERCADO)
            for (j=0;j<market_keys.length;j++){
                document.getElementById(market_keys[j]).checked = os_porta[i].MERCADO[market_keys[j]]
            }
            }
            if (os_porta[i].PRODUCTOS != undefined){
            if (os_porta[i].PRODUCTOS.length > 0){
            listaprecios = os_porta[i].PRODUCTOS
            }
            } 
            
            
        }
    
    
      
}
    
   
    
   
      
    
        mostraTipotrabajo()  
     
       }
    
    
    function cancelar_trabajo(){
    
       document.getElementById("cliente").value = ""
       document.getElementById("id_tipotrabajo").value = ""
      
     setTimeout(function(){mostraTipotrabajo()},1000)
     
    }
    
     function onlyNumberKey(evt) {
          
        // Only ASCII character in that range allowed
        var ASCIICode = (evt.which) ? evt.which : evt.keyCode
        if (ASCIICode > 31 && (ASCIICode < 48 || ASCIICode > 57))
            return false;
        return true;
    }
    
   
    
    
</script>
<script>


</script>
<script>
llena_tipotrabajo()
</script>


<script>
    function muda_status(){
    
     var linha = event.srcElement.id
     if (document.getElementById(linha).value == "ACTIVO"){
         document.getElementById(linha).value = "INACTIVO"
         document.getElementById(linha).style.backgroundColor = "red"
     } else {
         document.getElementById(linha).value = "ACTIVO"
         document.getElementById(linha).style.backgroundColor = "green"
     }
     
     
    }
</script>
<script>
var listaprecios = api.custom_objects.list("AR-BOSISIO_listaPrecios").results
  
  
    function calcula_tablas(){
        var markupprice = 1+(parseFloat(document.getElementById("markup").value.replace(",",".")))/100
        for (i=0;i<listaprecios.length;i++){
            listaprecios[i]["markup_price"] = (listaprecios[i].valor)*markupprice
        }
        llena_tablas()
    }


function llena_tablas(){
    
     clearTable(document.getElementById("tabla_1"))
     clearTable(document.getElementById("tabla_2"))
          
          
         var table1 = document.getElementById("tabla_1")
         if (listaprecios.length%2 == 0){
             var primeras = (listaprecios.length)/2
         } else {
             var primeras = parseInt((listaprecios.length)/2)+1
         }
        var qtasrow = table1.rows.length
      
            
            for (i=0;i<primeras;i++){
            var row =  table1.insertRow(qtasrow);
            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(3);
            
            cell3.style.textAlign = "left"
            if (listaprecios[i].selected == true){
                row.style.backgroundColor = "#7CFC00"
            }  
        if (listaprecios[i].selected == true){
        cell1.innerHTML = '<div style="font-size: 0.8em; display: inline-block; text-align: left;"><input type="checkbox" class="form-group" onchange="selecciona_codigo()" id="codigo_'+qtasrow+'_'+i+'" checked></div>'
        } else {
        cell1.innerHTML = '<div style="font-size: 0.8em; display: inline-block; text-align: left;"><input type="checkbox" class="form-group" onchange="selecciona_codigo()" id="codigo_'+qtasrow+'_'+i+'"></div>'
            
        }
        cell2.innerHTML = '<div style="font-size: 1em; display: inline-block; text-align: left;">'+listaprecios[i].codigo+'</div>'
        cell3.innerHTML = '<div style="font-size: 0.9em; display: inline-block; text-align: left;">'+listaprecios[i].descripcion+'</div>'
        cell4.innerHTML = '<div style="font-size: 0.8em; display: inline-block; text-align: left;"><input id="precio_'+i+'" type="text" class="form-control" value="'+listaprecios[i].markup_price.toLocaleString('us-EN', {style: 'currency', currency: 'USD'})+'" onfocusout="cambiaprecio()"></div>'
        
          qtasrow = qtasrow +1
      
            }
            
              var table2 = document.getElementById("tabla_2")
        var qtasrow2 = table2.rows.length
        
        for (i=primeras;i<listaprecios.length;i++){
            var row2 =  table2.insertRow(qtasrow2);
            var cell1_2 = row2.insertCell(0);
            var cell2_2 = row2.insertCell(1);
            var cell3_2 = row2.insertCell(2);
            var cell4_2 = row2.insertCell(3);
            
            cell3_2.style.textAlign = "left"
            if (listaprecios[i].selected == true){
                row2.style.backgroundColor = "#7CFC00"
            }  
        if (listaprecios[i].selected == true){      
        cell1_2.innerHTML = '<div style="font-size: 0.8em; display: inline-block; text-align: left;"><input type="checkbox" class="form-group" onchange="selecciona_codigo()" id="codigo_'+qtasrow2+'_'+i+'" checked></div>'
        } else {
        cell1_2.innerHTML = '<div style="font-size: 0.8em; display: inline-block; text-align: left;"><input type="checkbox" class="form-group" onchange="selecciona_codigo()" id="codigo_'+qtasrow2+'_'+i+'"></div>'
            
        }
        cell2_2.innerHTML = '<div style="font-size: 1em; display: inline-block; text-align: left;">'+listaprecios[i].codigo+'</div>'
        cell3_2.innerHTML = '<div style="font-size: 0.9em; display: inline-block; text-align: left;">'+listaprecios[i].descripcion+'</div>'
        cell4_2.innerHTML = '<div style="font-size: 0.8em; display: inline-block; text-align: left;"><input id="precio_'+i+'" type="text" class="form-control" value="'+listaprecios[i].markup_price.toLocaleString('us-EN', {style: 'currency', currency: 'USD'})+'" onfocusout="cambiaprecio()"></div>'
        
          qtasrow2 = qtasrow2 +1
        }
            
       
}

function cambiaprecio(){
    var linha = event.srcElement.id
    var valor = document.getElementById(linha).value
    valor = valor.replace("US$","")
    valor = valor.replace(",",".")
    valor = parseInt(valor)
    console.log(valor)
    var linha_array = parseInt(linha.split("_")[1])
    listaprecios[linha_array].valor = valor
  
   calcula_tablas()
    
}

 function apenas_virgula(){
  	      event.srcElement.value=event.srcElement.value.replace(/[^0-9,-]/g, '')
  	  }
  	  
  	  function selecciona_codigo(){
  	   var linha = event.srcElement.id
  	   var linha_array = parseInt(linha.split("_")[1])
  	   var qualnumero = parseInt(linha.split("_")[2])
  	   if (listaprecios.length%2 == 0){
  	   if (qualnumero < listaprecios.length/2){
  	    var whichtable =  document.getElementById("tabla_1")
  	    var inicio = 0
  	    
  	   }  else {
  	       var whichtable =  document.getElementById("tabla_2")
  	       var inicio = listaprecios.length/2
  	    
  	       
  	   } 
  	  }
  	  console.log(whichtable)
  	  console.log(inicio)
  	  console.log(linha_array)
  	  if (document.getElementById(linha).checked === true){
  	  whichtable.rows[linha_array].style.backgroundColor = "#7CFC00"
  	  listaprecios[inicio]["selected"] = true
  	  
  	  } else {
  	  whichtable.rows[linha_array].style.backgroundColor = "#fafafa"
  	  listaprecios[inicio]["selected"] = false
  	  }
  	      
  	   
  	      
  	      
  	  }
  	  
  	function selecciona_todo(){
  	    var linha = event.srcElement.id
  	    console.log(linha)
  	    var linha_array = linha.split("-")[1]
  	    var theone = document.getElementById(linha_array)
  	    var theone_rows = theone.rows
  	    for (i=1;i<theone_rows.length;i++){
  	        if (document.getElementById(linha).checked == true){
  	            theone_rows[i].style.backgroundColor = "#7CFC00"
  	            theone_rows[i].children[0].children[0].children[0].checked = true
  	        } else {
  	             theone_rows[i].style.backgroundColor = "#FAFAFA"
  	            theone_rows[i].children[0].children[0].children[0].checked = false
  	        }
  	    }

  	}
  	

       function filtro_clientes() {
      var input, filter, table, tr, td, i, txtValue;
      input = document.getElementById("filtro_cliente");
      filter = input.value.toUpperCase();
      table = document.getElementById("tabla_tipotrabajo");
      tr = table.getElementsByTagName("tr");
      for (i = 1; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[0];
        if (td) {
          txtValue = td.textContent || td.innerText;
          if (txtValue.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
          } else {
            tr[i].style.display = "none";
          }
        }       
      }
    }

</script>



    </body>

</html>